"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,s){return e&&_defineProperties(t.prototype,e),s&&_defineProperties(t,s),t}$(document).on("click",".product-row__button",function(){$(this).hasClass("animate")||($(this).addClass("animate"),$(this).addClass("button--check"),setTimeout(function(){$(this).removeClass("button--check"),$(this).removeClass("animate")}.bind(this),2e3))}),window.addEventListener("load",function(){$(".hr-sect").length&&$(".hr-pagination__step").click(function(){var t=$(this);if(!t.hasClass("is-active")){t.closest(".hr-sect").find(".hr-pagination__step").removeClass("is-active").removeClass("button"),t.addClass("is-active").addClass("button"),t.attr("data-index");var e=t.closest(".hr-sect").find(".hr-slider-slide");e.removeClass("is-active"),e.each(function(t,e){$(this).attr("data-index")==$(".hr-pagination__step.is-active").attr("data-index")&&$(this).addClass("is-active")})}})}),function(){var t=document.getElementById("menu-button");t.addEventListener("click",function(){t.classList.toggle("opened")}),window.onresize=function(){t.classList.remove("opened")},window.onscroll=function(){t.classList.remove("opened")}}(),function(){var t=function(){function i(t,e,s){if(_classCallCheck(this,i),void 0===t)return!1;this._self=t,this._title=this._self.querySelectorAll("."+e)[0],this._products=this._self.querySelectorAll("."+s)[0]}return _createClass(i,[{key:"_cleanProducts",value:function(){this._products.innerHTML=""}},{key:"_playPreloader",value:function(){}},{key:"_stopPreloader",value:function(){}},{key:"updateTitle",value:function(t){this._title.innerHTML=t}},{key:"updateListProducts",value:function(t){this._products.innerHTML=t}},{key:"addProducts",value:function(t){this._products.insertAdjacentHTML("beforeend",t)}}]),i}(),e=function(){function s(t,e){return _classCallCheck(this,s),void 0!==t&&(void 0!==e&&(this._containerBrands=t,this._brandItem=this._containerBrands.querySelectorAll(".catalog-nav__controls-link"),this._containerFilter=e,this._filterItem=this._containerFilter.querySelectorAll(".catalog-filter__col-btn"),this.searchItem=this._containerFilter.querySelectorAll(".catalog-filter__form")[0],this._activeClass="is-active",this._sortTypeAsc={class:"sort-down",dataSort:"asc"},this._sortTypeDesc={class:"sort-up",dataSort:"desc"},void this.init()))}return _createClass(s,[{key:"_cleanClassFilterAll",value:function(){var s=this;this._filterItem.forEach(function(t){var e=t.closest(".catalog-filter__col");t.classList.remove(s._activeClass),t.classList.remove(s._sortTypeAsc.class),e.removeAttribute("data-sort")})}},{key:"_addClassFilter",value:function(t){var e=t.closest(".catalog-filter__col");t.classList.add(this._activeClass),t.classList.add(this._sortTypeAsc.class),e.setAttribute("data-sort",this._sortTypeAsc.dataSort)}},{key:"_toogleSort",value:function(t){var e=t.closest(".catalog-filter__col");t.classList.contains(this._sortTypeAsc.class)?(t.classList.remove(this._sortTypeAsc.class),t.classList.add(this._sortTypeDesc.class),e.setAttribute("data-sort",this._sortTypeDesc.dataSort)):(t.classList.remove(this._sortTypeDesc.class),t.classList.add(this._sortTypeAsc.class),e.setAttribute("data-sort",this._sortTypeAsc.dataSort))}},{key:"_selectBrand",value:function(t){t.classList.contains("is-active")||(this._brandItem.forEach(function(t){t.classList.remove("is-active")}),t.classList.add("is-active"))}},{key:"_queryFormation",value:function(){var t,s=[],e=this.searchItem.getElementsByTagName("input")[0];this._brandItem.forEach(function(t){t.classList.contains("is-active")&&s.push("brand="+t.getAttribute("data-brand"))}),this._filterItem.forEach(function(t){var e=t.closest(".catalog-filter__col");t.classList.contains("is-active")&&(s.push("sort="+e.getAttribute("data-sort")),s.push("sortType="+e.getAttribute("data-filter")))}),""!==e.value&&s.push("search="+e.value),t="?"+s.join("&"),console.log(t)}},{key:"init",value:function(){var e=this;this._filterItem.forEach(function(t){t.addEventListener("click",function(){t.classList.contains(e._activeClass)?e._toogleSort(this):(e._cleanClassFilterAll(),e._addClassFilter(this)),e._queryFormation()})}),this._brandItem.forEach(function(t){t.addEventListener("click",function(t){t.preventDefault(),this.classList.contains("is-active")||(e._selectBrand(this),e._queryFormation())})}),this.searchItem.getElementsByTagName("input")[0].addEventListener("input",function(){e._queryFormation()})}}]),s}(),s=function(){function s(t,e){_classCallCheck(this,s),this._url=t,this._type=e,this.ajax=new XMLHttpRequest}return _createClass(s,[{key:"_progress",value:function(){}},{key:"_complete",value:function(){var t=JSON.parse(this.response);console.log(t)}},{key:"send",value:function(t){this.ajax.addEventListener("progress",this._progress,!1),this.ajax.addEventListener("load",this._complete,!1),"get"===this._type.toLowerCase()?(this.ajax.open(this._type,this._url),this.ajax.send(),console.log("get")):"post"===this._type.toLowerCase()?console.log("post"):console.log("Error")}}]),s}(),i=(new t(document.querySelectorAll(".catalog")[0],"catalog__title","catalog__container"),new s("test.json","get")),n=new e(document.querySelectorAll(".catalog-nav__controls")[0],document.querySelectorAll(".catalog-filter")[0]);i.send({data:1}),window.filter=n}(),$(".footer__col-title").on("click",function(t){t.preventDefault(),$(this).closest(".footer__col").find(".footer__col-list").slideToggle(300)}),window.addEventListener("load",function(){if($(".catalog-nav__controls").length){var t=function(){i=s.position().left,a=s.position().top,s.innerWidth(),s.innerHeight(),n.css({left:i,top:a,width:0,height:0})},e=$(".catalog-nav__controls-link"),s=($(".catalog-nav__controls-list"),$(".catalog-nav__controls-item"),$(".catalog-nav__controls-link.is-active")),n=$(".catalog-nav__hover"),i=s.position().left,a=s.position().top,o=(s.innerWidth(),s.innerHeight(),!1);e.hover(function(){var t=$(this).position().left,e=$(this).position().top,s=$(this).innerWidth(),i=$(this).innerHeight();n.css({left:t,top:e,width:s,height:i}),o=!1},function(){setTimeout(function(){o&&n.css({left:i,top:a,width:0,height:0})},1e3),o=!0}),$(window).resize(function(){t()}),t()}}),window.addEventListener("load",function(){$(".delivery__form-input").focusout(function(){""!==$(this).val()?$(this).parent().addClass("value"):$(this).parent().removeClass("value")})}),function(){var t=document.getElementById("scene");if(null!=t)new Parallax(t)}(),$(document).on("click",".slide-info__button",function(){$(this).closest(".slide-info").find(".slide-info__button").toggleClass("is-active"),$(this).closest(".slide-info").find(".slide-info__content").slideToggle(300)});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkZFRvQmFza2V0LmpzIiwiYmFza2V0VGFicy5qcyIsImJ1cmdlci5qcyIsImNhdGFsb2dVcGRhdGVDbGFzcy5qcyIsImZvb3Rlck1lbnUuanMiLCJob3ZlclJvbGxlci5qcyIsImxhYmVsRm9ybS5qcyIsInBhcmFsbGF4LmpzIiwic2hvd01vcmUuanMiXSwibmFtZXMiOlsiJCIsImRvY3VtZW50Iiwib24iLCJ0aGlzIiwiaGFzQ2xhc3MiLCJhZGRDbGFzcyIsInNldFRpbWVvdXQiLCJyZW1vdmVDbGFzcyIsImJpbmQiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwibGVuZ3RoIiwiY2xpY2siLCJ0aFN0ZXAiLCJjbG9zZXN0IiwiZmluZCIsImF0dHIiLCJzbGlkZXJTbGlkZXMiLCJlYWNoIiwicGFnaUluZGV4IiwibWVudUJ0biIsImdldEVsZW1lbnRCeUlkIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwib25yZXNpemUiLCJyZW1vdmUiLCJvbnNjcm9sbCIsIkNhdGFsb2ciLCJzZWxmIiwidGl0bGVDbGFzcyIsInByb2R1Y3RzQ29udGFpbmVyQ2xhc3MiLCJfY2xhc3NDYWxsQ2hlY2siLCJ1bmRlZmluZWQiLCJfc2VsZiIsIl90aXRsZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfcHJvZHVjdHMiLCJfY3JlYXRlQ2xhc3MiLCJrZXkiLCJ2YWx1ZSIsImlubmVySFRNTCIsInRpdGxlIiwicHJvZHVjdHMiLCJpbnNlcnRBZGphY2VudEhUTUwiLCJGaWx0ZXIiLCJjb250YWluZXJCcmFuZHMiLCJjb250YWluZXJGaWx0ZXIiLCJfY29udGFpbmVyQnJhbmRzIiwiX2JyYW5kSXRlbSIsIl9jb250YWluZXJGaWx0ZXIiLCJfZmlsdGVySXRlbSIsInNlYXJjaEl0ZW0iLCJfYWN0aXZlQ2xhc3MiLCJfc29ydFR5cGVBc2MiLCJjbGFzcyIsImRhdGFTb3J0IiwiX3NvcnRUeXBlRGVzYyIsImluaXQiLCJmb3JFYWNoIiwiaXRlbSIsInBhcmVudCIsInJlbW92ZUF0dHJpYnV0ZSIsImFkZCIsInNldEF0dHJpYnV0ZSIsImNvbnRhaW5zIiwiZ2V0UXVlcnkiLCJhcnJheVF1ZXJ5IiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJwdXNoIiwiZ2V0QXR0cmlidXRlIiwiam9pbiIsImNvbnNvbGUiLCJsb2ciLCJfdG9vZ2xlU29ydCIsIl9jbGVhbkNsYXNzRmlsdGVyQWxsIiwiX2FkZENsYXNzRmlsdGVyIiwiX3F1ZXJ5Rm9ybWF0aW9uIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsIl9zZWxlY3RCcmFuZCIsIkFqYXhHZXRQcm9kdWN0cyIsInVybCIsInR5cGUiLCJfdXJsIiwiX3R5cGUiLCJhamF4IiwiWE1MSHR0cFJlcXVlc3QiLCJyZXN1bHQiLCJKU09OIiwicGFyc2UiLCJyZXNwb25zZSIsImRhdGEiLCJfcHJvZ3Jlc3MiLCJfY29tcGxldGUiLCJ0b0xvd2VyQ2FzZSIsIm9wZW4iLCJzZW5kIiwiYWpheENvbm5lY3QiLCJmaWx0ZXIiLCJlIiwic2xpZGVUb2dnbGUiLCJyZXNpemVQb3MiLCJhY3RpdmVMaW5rUG9zTGVmdCIsImFjdGl2ZUxpbmsiLCJwb3NpdGlvbiIsImxlZnQiLCJhY3RpdmVMaW5rUG9zVG9wIiwidG9wIiwiaW5uZXJXaWR0aCIsImlubmVySGVpZ2h0IiwiaG92ZXJCb3giLCJjc3MiLCJ3aWR0aCIsImhlaWdodCIsIm1lbnVMaW5rIiwiY2hlY2siLCJob3ZlciIsIm5ld0xpbmtQb3NMZWZ0IiwibmV3TGlua1Bvc1RvcCIsIm5ld0xpbmtXaWR0aCIsIm5ld0xpbmtIZWlnaHQiLCJyZXNpemUiLCJmb2N1c291dCIsInZhbCIsInNjZW5lIiwiUGFyYWxsYXgiLCJ0b2dnbGVDbGFzcyJdLCJtYXBwaW5ncyI6Im1aQUNJQSxFQUFFQyxVQUFVQyxHQUFHLFFBQVMsdUJBQXdCLFdBQ3ZDRixFQUFFRyxNQUFNQyxTQUFTLGFBQ2xCSixFQUFFRyxNQUFNRSxTQUFTLFdBQ2pCTCxFQUFFRyxNQUFNRSxTQUFTLGlCQUNqQkMsV0FBVyxXQUNQTixFQUFFRyxNQUFNSSxZQUFZLGlCQUNwQlAsRUFBRUcsTUFBTUksWUFBWSxZQUN0QkMsS0FBS0wsTUFBTyxRQ050Qk0sT0FBT0MsaUJBQWlCLE9BQVEsV0FFeEJWLEVBQUUsWUFBWVcsUUFFZFgsRUFBRSx3QkFBd0JZLE1BQU0sV0FDNUIsSUFBSUMsRUFBU2IsRUFBRUcsTUFDZixJQUFLVSxFQUFPVCxTQUFTLGFBQWMsQ0FDL0JTLEVBQU9DLFFBQVEsWUFBWUMsS0FBSyx3QkFBd0JSLFlBQVksYUFBYUEsWUFBWSxVQUM3Rk0sRUFBT1IsU0FBUyxhQUFhQSxTQUFTLFVBQ3RCUSxFQUFPRyxLQUFLLGNBQTVCLElBRUlDLEVBQWVKLEVBQU9DLFFBQVEsWUFBWUMsS0FBSyxvQkFDbkRFLEVBQWFWLFlBQVksYUFDekJVLEVBQWFDLEtBQUssU0FBU0MsRUFBV04sR0FDOUJiLEVBQUVHLE1BQU1hLEtBQUssZUFBaUJoQixFQUFFLGtDQUFrQ2dCLEtBQUssZUFDdkVoQixFQUFFRyxNQUFNRSxTQUFTLG9CQ2pCNUMsV0FDRyxJQUFJZSxFQUFVbkIsU0FBU29CLGVBQWUsZUFFdENELEVBQVFWLGlCQUFpQixRQUFTLFdBQzlCVSxFQUFRRSxVQUFVQyxPQUFPLFlBRzdCZCxPQUFPZSxTQUFXLFdBQ2RKLEVBQVFFLFVBQVVHLE9BQU8sV0FFN0JoQixPQUFPaUIsU0FBVyxXQUNkTixFQUFRRSxVQUFVRyxPQUFPLFdBWGhDLEdDQUEsV0FBVyxJQUVGRSxFQUZFLFdBR0osU0FBQUEsRUFBWUMsRUFBTUMsRUFBWUMsR0FDMUIsR0FEaURDLGdCQUFBNUIsS0FBQXdCLFFBQ3BDSyxJQUFUSixFQUNBLE9BQU8sRUFFWHpCLEtBQUs4QixNQUFRTCxFQUNiekIsS0FBSytCLE9BQVMvQixLQUFLOEIsTUFBTUUsaUJBQWlCLElBQU1OLEdBQVksR0FDNUQxQixLQUFLaUMsVUFBWWpDLEtBQUs4QixNQUFNRSxpQkFBaUIsSUFBTUwsR0FBd0IsR0FUM0UsT0FBQU8sYUFBQVYsRUFBQSxDQUFBLENBQUFXLElBQUEsaUJBQUFDLE1BQUEsV0FjQXBDLEtBQUtpQyxVQUFVSSxVQUFZLEtBZDNCLENBQUFGLElBQUEsaUJBQUFDLE1BQUEsY0FBQSxDQUFBRCxJQUFBLGlCQUFBQyxNQUFBLGNBQUEsQ0FBQUQsSUFBQSxjQUFBQyxNQUFBLFNBeUJRRSxHQUNSdEMsS0FBSytCLE9BQU9NLFVBQVlDLElBMUJ4QixDQUFBSCxJQUFBLHFCQUFBQyxNQUFBLFNBNkJlRyxHQUNmdkMsS0FBS2lDLFVBQVVJLFVBQVlFLElBOUIzQixDQUFBSixJQUFBLGNBQUFDLE1BQUEsU0FpQ1FHLEdBQ1J2QyxLQUFLaUMsVUFBVU8sbUJBQW1CLFlBQWFELE9BbEMvQ2YsRUFBQSxHQXNDRmlCLEVBdENFLFdBdUNKLFNBQUFBLEVBQVlDLEVBQWlCQyxHQUN6QixPQUQwQ2YsZ0JBQUE1QixLQUFBeUMsUUFDbEJaLElBQXBCYSxTQUdvQmIsSUFBcEJjLElBSUozQyxLQUFLNEMsaUJBQW1CRixFQUN4QjFDLEtBQUs2QyxXQUFhN0MsS0FBSzRDLGlCQUFpQlosaUJBQWlCLCtCQUV6RGhDLEtBQUs4QyxpQkFBbUJILEVBQ3hCM0MsS0FBSytDLFlBQWMvQyxLQUFLOEMsaUJBQWlCZCxpQkFBaUIsNEJBQzFEaEMsS0FBS2dELFdBQWFoRCxLQUFLOEMsaUJBQWlCZCxpQkFBaUIseUJBQXlCLEdBQ2xGaEMsS0FBS2lELGFBQWUsWUFDcEJqRCxLQUFLa0QsYUFBZSxDQUNoQkMsTUFBTyxZQUNQQyxTQUFVLE9BRWRwRCxLQUFLcUQsY0FBZ0IsQ0FDakJGLE1BQU8sVUFDUEMsU0FBVSxhQUdkcEQsS0FBS3NELFNBL0RMLE9BQUFwQixhQUFBTyxFQUFBLENBQUEsQ0FBQU4sSUFBQSx1QkFBQUMsTUFBQSxXQW1FQSxJQUFJWCxFQUFPekIsS0FFWEEsS0FBSytDLFlBQVlRLFFBQVEsU0FBU0MsR0FDOUIsSUFBSUMsRUFBU0QsRUFBSzdDLFFBQVEsd0JBRXRCNkMsRUFBS3JDLFVBQVVHLE9BQU9HLEVBQUt3QixjQUMzQk8sRUFBS3JDLFVBQVVHLE9BQU9HLEVBQUt5QixhQUFMLE9BQ3RCTyxFQUFPQyxnQkFBZ0IsaUJBMUUvQixDQUFBdkIsSUFBQSxrQkFBQUMsTUFBQSxTQStFWW9CLEdBQ1osSUFBSUMsRUFBU0QsRUFBSzdDLFFBQVEsd0JBRTFCNkMsRUFBS3JDLFVBQVV3QyxJQUFJM0QsS0FBS2lELGNBQ3hCTyxFQUFLckMsVUFBVXdDLElBQUkzRCxLQUFLa0QsYUFBTCxPQUVuQk8sRUFBT0csYUFBYSxZQUFhNUQsS0FBS2tELGFBQWFFLFlBckZuRCxDQUFBakIsSUFBQSxjQUFBQyxNQUFBLFNBd0ZRb0IsR0FDUixJQUFJQyxFQUFTRCxFQUFLN0MsUUFBUSx3QkFFdEI2QyxFQUFLckMsVUFBVTBDLFNBQVM3RCxLQUFLa0QsYUFBTCxRQUN4Qk0sRUFBS3JDLFVBQVVHLE9BQU90QixLQUFLa0QsYUFBTCxPQUN0Qk0sRUFBS3JDLFVBQVV3QyxJQUFJM0QsS0FBS3FELGNBQUwsT0FFbkJJLEVBQU9HLGFBQWEsWUFBYTVELEtBQUtxRCxjQUFjRCxZQUVwREksRUFBS3JDLFVBQVVHLE9BQU90QixLQUFLcUQsY0FBTCxPQUN0QkcsRUFBS3JDLFVBQVV3QyxJQUFJM0QsS0FBS2tELGFBQUwsT0FFbkJPLEVBQU9HLGFBQWEsWUFBYTVELEtBQUtrRCxhQUFhRSxhQXBHdkQsQ0FBQWpCLElBQUEsZUFBQUMsTUFBQSxTQXlHU29CLEdBQ0pBLEVBQUtyQyxVQUFVMEMsU0FBUyxlQUN6QjdELEtBQUs2QyxXQUFXVSxRQUFRLFNBQVNDLEdBQzdCQSxFQUFLckMsVUFBVUcsT0FBTyxlQUUxQmtDLEVBQUtyQyxVQUFVd0MsSUFBSSxnQkE5R3ZCLENBQUF4QixJQUFBLGtCQUFBQyxNQUFBLFdBb0hBLElBRUkwQixFQUZBQyxFQUFhLEdBQ2JmLEVBQWFoRCxLQUFLZ0QsV0FBV2dCLHFCQUFxQixTQUFTLEdBRy9EaEUsS0FBSzZDLFdBQVdVLFFBQVEsU0FBU0MsR0FDekJBLEVBQUtyQyxVQUFVMEMsU0FBUyxjQUN4QkUsRUFBV0UsS0FBSyxTQUFXVCxFQUFLVSxhQUFhLGlCQUlyRGxFLEtBQUsrQyxZQUFZUSxRQUFRLFNBQVNDLEdBQzlCLElBQUlDLEVBQVNELEVBQUs3QyxRQUFRLHdCQUN0QjZDLEVBQUtyQyxVQUFVMEMsU0FBUyxlQUN4QkUsRUFBV0UsS0FBSyxRQUFVUixFQUFPUyxhQUFhLGNBQzlDSCxFQUFXRSxLQUFLLFlBQWNSLEVBQU9TLGFBQWEsbUJBSWpDLEtBQXJCbEIsRUFBV1osT0FDWDJCLEVBQVdFLEtBQUssVUFBWWpCLEVBQVdaLE9BRzNDMEIsRUFBVyxJQUFNQyxFQUFXSSxLQUFLLEtBSWpDQyxRQUFRQyxJQUFJUCxLQTlJWixDQUFBM0IsSUFBQSxPQUFBQyxNQUFBLFdBbUpBLElBQUlYLEVBQU96QixLQUNYQSxLQUFLK0MsWUFBWVEsUUFBUSxTQUFTQyxHQUM5QkEsRUFBS2pELGlCQUFpQixRQUFTLFdBQ3ZCaUQsRUFBS3JDLFVBQVUwQyxTQUFTcEMsRUFBS3dCLGNBQzdCeEIsRUFBSzZDLFlBQVl0RSxPQUlqQnlCLEVBQUs4Qyx1QkFDTDlDLEVBQUsrQyxnQkFBZ0J4RSxPQUhyQnlCLEVBQUtnRCxzQkFVakJ6RSxLQUFLNkMsV0FBV1UsUUFBUSxTQUFTQyxHQUM3QkEsRUFBS2pELGlCQUFpQixRQUFTLFNBQVNtRSxHQUNwQ0EsRUFBTUMsaUJBQ0QzRSxLQUFLbUIsVUFBVTBDLFNBQVMsZUFDekJwQyxFQUFLbUQsYUFBYTVFLE1BRWxCeUIsRUFBS2dELHVCQUtqQnpFLEtBQUtnRCxXQUFXZ0IscUJBQXFCLFNBQVMsR0FBR3pELGlCQUFpQixRQUFTLFdBRXZFa0IsRUFBS2dELHdCQWhMVGhDLEVBQUEsR0FzTEZvQyxFQXRMRSxXQXVMSixTQUFBQSxFQUFZQyxFQUFLQyxHQUFNbkQsZ0JBQUE1QixLQUFBNkUsR0FDbkI3RSxLQUFLZ0YsS0FBT0YsRUFDWjlFLEtBQUtpRixNQUFRRixFQUNiL0UsS0FBS2tGLEtBQU8sSUFBSUMsZUExTGhCLE9BQUFqRCxhQUFBMkMsRUFBQSxDQUFBLENBQUExQyxJQUFBLFlBQUFDLE1BQUEsY0FBQSxDQUFBRCxJQUFBLFlBQUFDLE1BQUEsV0F5TUEsSUFBSWdELEVBQVNDLEtBQUtDLE1BQU10RixLQUFLdUYsVUFDekJuQixRQUFRQyxJQUFJZSxLQTFNaEIsQ0FBQWpELElBQUEsT0FBQUMsTUFBQSxTQThNQ29ELEdBQ0R4RixLQUFLa0YsS0FBSzNFLGlCQUFpQixXQUFZUCxLQUFLeUYsV0FBVyxHQUN2RHpGLEtBQUtrRixLQUFLM0UsaUJBQWlCLE9BQVFQLEtBQUswRixXQUFXLEdBRWxCLFFBQTdCMUYsS0FBS2lGLE1BQU1VLGVBRVgzRixLQUFLa0YsS0FBS1UsS0FBSzVGLEtBQUtpRixNQUFPakYsS0FBS2dGLE1BQ2hDaEYsS0FBS2tGLEtBQUtXLE9BRVZ6QixRQUFRQyxJQUFJLFFBQ3dCLFNBQTdCckUsS0FBS2lGLE1BQU1VLGNBQ2xCdkIsUUFBUUMsSUFBSSxRQUVaRCxRQUFRQyxJQUFJLGFBM05oQlEsRUFBQSxHQWtPSmlCLEdBRGMsSUFBSXRFLEVBQVExQixTQUFTa0MsaUJBQWlCLFlBQVksR0FBSSxpQkFBa0Isc0JBQ3hFLElBQUk2QyxFQUFnQixZQUFhLFFBQy9Da0IsRUFBUyxJQUFJdEQsRUFBTzNDLFNBQVNrQyxpQkFBaUIsMEJBQTBCLEdBQUlsQyxTQUFTa0MsaUJBQWlCLG1CQUFtQixJQUU3SDhELEVBQVlELEtBQUssQ0FBQ0wsS0FBTSxJQUl4QmxGLE9BQU95RixPQUFTQSxFQXpPbkIsR0NDZ0JsRyxFQUFFLHNCQUVSRSxHQUFHLFFBQVMsU0FBU2lHLEdBQ3hCQSxFQUFFckIsaUJBQ0Y5RSxFQUFFRyxNQUFNVyxRQUFRLGdCQUFnQkMsS0FBSyxxQkFBcUJxRixZQUFZLE9DSDFFM0YsT0FBT0MsaUJBQWlCLE9BQVEsV0FFNUIsR0FBSVYsRUFBRSwwQkFBMEJXLE9BQVEsQ0FBQSxJQWlDM0IwRixFQUFULFdBQ0lDLEVBQW9CQyxFQUFXQyxXQUFXQyxLQUMxQ0MsRUFBbUJILEVBQVdDLFdBQVdHLElBQ3ZCSixFQUFXSyxhQUNWTCxFQUFXTSxjQUU5QkMsRUFBU0MsSUFBSSxDQUFDTixLQUFTSCxFQUFtQkssSUFBUUQsRUFBa0JNLE1BQVUsRUFBR0MsT0FBVyxLQXJDNUZDLEVBQVdsSCxFQUFFLCtCQUlidUcsR0FIT3ZHLEVBQUUsK0JBRUVBLEVBQUUsK0JBQ0FBLEVBQUUsMENBQ2Y4RyxFQUFXOUcsRUFBRSx1QkFDYnNHLEVBQW9CQyxFQUFXQyxXQUFXQyxLQUMxQ0MsRUFBbUJILEVBQVdDLFdBQVdHLElBSXpDUSxHQUhrQlosRUFBV0ssYUFDVkwsRUFBV00sZUFFdEIsR0FDWkssRUFBU0UsTUFDUCxXQUNFLElBQUlDLEVBQWlCckgsRUFBRUcsTUFBTXFHLFdBQVdDLEtBQ3BDYSxFQUFnQnRILEVBQUVHLE1BQU1xRyxXQUFXRyxJQUNuQ1ksRUFBZXZILEVBQUVHLE1BQU15RyxhQUN2QlksRUFBZ0J4SCxFQUFFRyxNQUFNMEcsY0FDNUJDLEVBQVNDLElBQUksQ0FBQ04sS0FBU1ksRUFBZ0JWLElBQVFXLEVBQWVOLE1BQVVPLEVBQWNOLE9BQVdPLElBQ2pHTCxHQUFRLEdBRVYsV0FDRTdHLFdBQVcsV0FDTDZHLEdBQ0ZMLEVBQVNDLElBQUksQ0FBQ04sS0FBU0gsRUFBbUJLLElBQVFELEVBQWtCTSxNQUFVLEVBQUdDLE9BQVcsS0FFN0YsS0FDSEUsR0FBUSxJQWFabkgsRUFBRVMsUUFBUWdILE9BQU8sV0FDYnBCLE1BRUpBLE9DL0NSNUYsT0FBT0MsaUJBQWlCLE9BQVEsV0FFNUJWLEVBQUUseUJBQXlCMEgsU0FBUyxXQUNaLEtBQWxCMUgsRUFBRUcsTUFBTXdILE1BQ1YzSCxFQUFFRyxNQUFNeUQsU0FBU3ZELFNBQVMsU0FHMUJMLEVBQUVHLE1BQU15RCxTQUFTckQsWUFBWSxhQ1R4QyxXQUVHLElBQUlxSCxFQUFRM0gsU0FBU29CLGVBQWUsU0FDcEMsR0FBYVcsTUFBVDRGLEVBQ3VCLElBQUlDLFNBQVNELEdBSjNDLEdDQ0c1SCxFQUFFQyxVQUFVQyxHQUFHLFFBQVMsc0JBQXVCLFdBQzNDRixFQUFFRyxNQUFNVyxRQUFRLGVBQWVDLEtBQUssdUJBQXVCK0csWUFBWSxhQUN2RTlILEVBQUVHLE1BQU1XLFFBQVEsZUFBZUMsS0FBSyx3QkFBd0JxRixZQUFZIiwiZmlsZSI6Im1haW4ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiOyhmdW5jdGlvbigpIHtcclxuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcucHJvZHVjdC1yb3dfX2J1dHRvbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICghJCh0aGlzKS5oYXNDbGFzcygnYW5pbWF0ZScpKSB7XHJcbiAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2FuaW1hdGUnKTtcclxuICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcyhcImJ1dHRvbi0tY2hlY2tcIik7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKFwiYnV0dG9uLS1jaGVja1wiKTtcclxuICAgICAgICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ2FuaW1hdGUnKTtcclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpLCAyMDAwKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufSkoKTtcclxuIiwiOyhmdW5jdGlvbigpIHtcclxuXHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICBpZiAoJCgnLmhyLXNlY3QnKS5sZW5ndGgpIHtcclxuXHJcbiAgICAgICAgICAgICQoXCIuaHItcGFnaW5hdGlvbl9fc3RlcFwiKS5jbGljayhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0aFN0ZXAgPSAkKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aFN0ZXAuaGFzQ2xhc3MoXCJpcy1hY3RpdmVcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aFN0ZXAuY2xvc2VzdCgnLmhyLXNlY3QnKS5maW5kKFwiLmhyLXBhZ2luYXRpb25fX3N0ZXBcIikucmVtb3ZlQ2xhc3MoXCJpcy1hY3RpdmVcIikucmVtb3ZlQ2xhc3MoXCJidXR0b25cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhTdGVwLmFkZENsYXNzKFwiaXMtYWN0aXZlXCIpLmFkZENsYXNzKFwiYnV0dG9uXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwYWdpSW5kZXggPSB0aFN0ZXAuYXR0cihcImRhdGEtaW5kZXhcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzbGlkZXJTbGlkZXMgPSB0aFN0ZXAuY2xvc2VzdChcIi5oci1zZWN0XCIpLmZpbmQoXCIuaHItc2xpZGVyLXNsaWRlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNsaWRlclNsaWRlcy5yZW1vdmVDbGFzcyhcImlzLWFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICBzbGlkZXJTbGlkZXMuZWFjaChmdW5jdGlvbihwYWdpSW5kZXgsIHRoU3RlcCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJCh0aGlzKS5hdHRyKFwiZGF0YS1pbmRleFwiKSA9PSAkKFwiLmhyLXBhZ2luYXRpb25fX3N0ZXAuaXMtYWN0aXZlXCIpLmF0dHIoXCJkYXRhLWluZGV4XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKFwiaXMtYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgfSk7XHJcblxyXG59KSgpO1xyXG4iLCI7KGZ1bmN0aW9uKCkge1xyXG4gICAgbGV0IG1lbnVCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWVudS1idXR0b24nKTtcclxuXHJcbiAgICBtZW51QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbWVudUJ0bi5jbGFzc0xpc3QudG9nZ2xlKCdvcGVuZWQnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHdpbmRvdy5vbnJlc2l6ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIG1lbnVCdG4uY2xhc3NMaXN0LnJlbW92ZSgnb3BlbmVkJyk7XHJcbiAgICB9XHJcbiAgICB3aW5kb3cub25zY3JvbGwgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBtZW51QnRuLmNsYXNzTGlzdC5yZW1vdmUoJ29wZW5lZCcpO1xyXG4gICAgfVxyXG59KSgpO1xyXG4iLCI7KGZ1bmN0aW9uKCl7XG5cbiAgICBjbGFzcyBDYXRhbG9nIHtcbiAgICAgICAgY29uc3RydWN0b3Ioc2VsZiwgdGl0bGVDbGFzcywgcHJvZHVjdHNDb250YWluZXJDbGFzcyl7XG4gICAgICAgICAgICBpZiAoc2VsZiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fc2VsZiA9IHNlbGY7XG4gICAgICAgICAgICB0aGlzLl90aXRsZSA9IHRoaXMuX3NlbGYucXVlcnlTZWxlY3RvckFsbChcIi5cIiArIHRpdGxlQ2xhc3MpWzBdO1xuICAgICAgICAgICAgdGhpcy5fcHJvZHVjdHMgPSB0aGlzLl9zZWxmLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuXCIgKyBwcm9kdWN0c0NvbnRhaW5lckNsYXNzKVswXTtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgX2NsZWFuUHJvZHVjdHMoKSB7XG4gICAgICAgICAgICB0aGlzLl9wcm9kdWN0cy5pbm5lckhUTUwgPSBcIlwiO1xuICAgICAgICB9XG5cbiAgICAgICAgX3BsYXlQcmVsb2FkZXIoKSB7XG4gICAgICAgICAgICAvLyDQodC00LXQu9Cw0YLRjCDQt9Cw0L/Rg9GB0Log0L/RgNC10LvQvtGD0LTQtdGA0LBcbiAgICAgICAgfVxuXG4gICAgICAgIF9zdG9wUHJlbG9hZGVyKCkge1xuICAgICAgICAgICAgLy8g0KHQtNC10LvQsNGC0Ywg0L7RgdGC0LDQvdC+0LLQutGDINC/0YDQtdC70L7Rg9C00LXRgNCwXG4gICAgICAgIH1cblxuICAgICAgICB1cGRhdGVUaXRsZSh0aXRsZSkge1xuICAgICAgICAgICAgdGhpcy5fdGl0bGUuaW5uZXJIVE1MID0gdGl0bGU7XG4gICAgICAgIH1cblxuICAgICAgICB1cGRhdGVMaXN0UHJvZHVjdHMocHJvZHVjdHMpIHtcbiAgICAgICAgICAgIHRoaXMuX3Byb2R1Y3RzLmlubmVySFRNTCA9IHByb2R1Y3RzO1xuICAgICAgICB9XG5cbiAgICAgICAgYWRkUHJvZHVjdHMocHJvZHVjdHMpIHtcbiAgICAgICAgICAgIHRoaXMuX3Byb2R1Y3RzLmluc2VydEFkamFjZW50SFRNTChcImJlZm9yZWVuZFwiLCBwcm9kdWN0cyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjbGFzcyBGaWx0ZXIge1xuICAgICAgICBjb25zdHJ1Y3Rvcihjb250YWluZXJCcmFuZHMsIGNvbnRhaW5lckZpbHRlcikge1xuICAgICAgICAgICAgaWYgKGNvbnRhaW5lckJyYW5kcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNvbnRhaW5lckZpbHRlciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9jb250YWluZXJCcmFuZHMgPSBjb250YWluZXJCcmFuZHM7XG4gICAgICAgICAgICB0aGlzLl9icmFuZEl0ZW0gPSB0aGlzLl9jb250YWluZXJCcmFuZHMucXVlcnlTZWxlY3RvckFsbChcIi5jYXRhbG9nLW5hdl9fY29udHJvbHMtbGlua1wiKTtcblxuICAgICAgICAgICAgdGhpcy5fY29udGFpbmVyRmlsdGVyID0gY29udGFpbmVyRmlsdGVyO1xuICAgICAgICAgICAgdGhpcy5fZmlsdGVySXRlbSA9IHRoaXMuX2NvbnRhaW5lckZpbHRlci5xdWVyeVNlbGVjdG9yQWxsKFwiLmNhdGFsb2ctZmlsdGVyX19jb2wtYnRuXCIpO1xuICAgICAgICAgICAgdGhpcy5zZWFyY2hJdGVtID0gdGhpcy5fY29udGFpbmVyRmlsdGVyLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2F0YWxvZy1maWx0ZXJfX2Zvcm1cIilbMF07XG4gICAgICAgICAgICB0aGlzLl9hY3RpdmVDbGFzcyA9IFwiaXMtYWN0aXZlXCI7XG4gICAgICAgICAgICB0aGlzLl9zb3J0VHlwZUFzYyA9IHtcbiAgICAgICAgICAgICAgICBjbGFzczogXCJzb3J0LWRvd25cIixcbiAgICAgICAgICAgICAgICBkYXRhU29ydDogXCJhc2NcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRoaXMuX3NvcnRUeXBlRGVzYyA9IHtcbiAgICAgICAgICAgICAgICBjbGFzczogXCJzb3J0LXVwXCIsXG4gICAgICAgICAgICAgICAgZGF0YVNvcnQ6IFwiZGVzY1wiXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuaW5pdCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgX2NsZWFuQ2xhc3NGaWx0ZXJBbGwoKSB7XG4gICAgICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHRoaXMuX2ZpbHRlckl0ZW0uZm9yRWFjaChmdW5jdGlvbihpdGVtKXtcbiAgICAgICAgICAgICAgICBsZXQgcGFyZW50ID0gaXRlbS5jbG9zZXN0KFwiLmNhdGFsb2ctZmlsdGVyX19jb2xcIik7XG5cbiAgICAgICAgICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKHNlbGYuX2FjdGl2ZUNsYXNzKTtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKHNlbGYuX3NvcnRUeXBlQXNjLmNsYXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50LnJlbW92ZUF0dHJpYnV0ZShcImRhdGEtc29ydFwiKTtcblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBfYWRkQ2xhc3NGaWx0ZXIoaXRlbSkge1xuICAgICAgICAgICAgbGV0IHBhcmVudCA9IGl0ZW0uY2xvc2VzdChcIi5jYXRhbG9nLWZpbHRlcl9fY29sXCIpO1xuXG4gICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQodGhpcy5fYWN0aXZlQ2xhc3MpO1xuICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKHRoaXMuX3NvcnRUeXBlQXNjLmNsYXNzKTtcblxuICAgICAgICAgICAgcGFyZW50LnNldEF0dHJpYnV0ZShcImRhdGEtc29ydFwiLCB0aGlzLl9zb3J0VHlwZUFzYy5kYXRhU29ydCk7XG4gICAgICAgIH1cblxuICAgICAgICBfdG9vZ2xlU29ydChpdGVtKSB7XG4gICAgICAgICAgICBsZXQgcGFyZW50ID0gaXRlbS5jbG9zZXN0KFwiLmNhdGFsb2ctZmlsdGVyX19jb2xcIik7XG5cbiAgICAgICAgICAgIGlmIChpdGVtLmNsYXNzTGlzdC5jb250YWlucyh0aGlzLl9zb3J0VHlwZUFzYy5jbGFzcykpIHtcbiAgICAgICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc29ydFR5cGVBc2MuY2xhc3MpO1xuICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZCh0aGlzLl9zb3J0VHlwZURlc2MuY2xhc3MpO1xuXG4gICAgICAgICAgICAgICAgcGFyZW50LnNldEF0dHJpYnV0ZShcImRhdGEtc29ydFwiLCB0aGlzLl9zb3J0VHlwZURlc2MuZGF0YVNvcnQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc29ydFR5cGVEZXNjLmNsYXNzKTtcbiAgICAgICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQodGhpcy5fc29ydFR5cGVBc2MuY2xhc3MpO1xuXG4gICAgICAgICAgICAgICAgcGFyZW50LnNldEF0dHJpYnV0ZShcImRhdGEtc29ydFwiLCB0aGlzLl9zb3J0VHlwZUFzYy5kYXRhU29ydCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuXG4gICAgICAgIF9zZWxlY3RCcmFuZChpdGVtKSB7XG4gICAgICAgICAgICBpZiAoIWl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKFwiaXMtYWN0aXZlXCIpKXtcbiAgICAgICAgICAgICAgICB0aGlzLl9icmFuZEl0ZW0uZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZShcImlzLWFjdGl2ZVwiKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoXCJpcy1hY3RpdmVcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBfcXVlcnlGb3JtYXRpb24oKSB7XG4gICAgICAgICAgICAvL9Cc0LXRgtC+0LQg0YTQvtGA0LzQuNGA0L7QstCw0L3QuNGPIGdldCDQt9Cw0L/RgNC+0YHQsFxuICAgICAgICAgICAgbGV0IGFycmF5UXVlcnkgPSBbXSxcbiAgICAgICAgICAgICAgICBzZWFyY2hJdGVtID0gdGhpcy5zZWFyY2hJdGVtLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaW5wdXRcIilbMF0sXG4gICAgICAgICAgICAgICAgZ2V0UXVlcnk7XG5cbiAgICAgICAgICAgIHRoaXMuX2JyYW5kSXRlbS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICBpZiAoaXRlbS5jbGFzc0xpc3QuY29udGFpbnMoXCJpcy1hY3RpdmVcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJyYXlRdWVyeS5wdXNoKFwiYnJhbmQ9XCIgKyBpdGVtLmdldEF0dHJpYnV0ZShcImRhdGEtYnJhbmRcIikpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLl9maWx0ZXJJdGVtLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgICAgIGxldCBwYXJlbnQgPSBpdGVtLmNsb3Nlc3QoXCIuY2F0YWxvZy1maWx0ZXJfX2NvbFwiKTtcbiAgICAgICAgICAgICAgICBpZiAoaXRlbS5jbGFzc0xpc3QuY29udGFpbnMoXCJpcy1hY3RpdmVcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJyYXlRdWVyeS5wdXNoKFwic29ydD1cIiArIHBhcmVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXNvcnRcIikpO1xuICAgICAgICAgICAgICAgICAgICBhcnJheVF1ZXJ5LnB1c2goXCJzb3J0VHlwZT1cIiArIHBhcmVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLWZpbHRlclwiKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmIChzZWFyY2hJdGVtLnZhbHVlICE9PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgYXJyYXlRdWVyeS5wdXNoKFwic2VhcmNoPVwiICsgc2VhcmNoSXRlbS52YWx1ZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGdldFF1ZXJ5ID0gXCI/XCIgKyBhcnJheVF1ZXJ5LmpvaW4oXCImXCIpO1xuXG4gICAgICAgICAgICAvL1RvZG86INC30LTQtdGB0Ywg0LTQvtC70LbQtdC9INCy0YvQt9GL0LLQsNGC0YzRgdGPIGFqYXgg0Lgg0L/RgNC40L3QuNC80LDRgtGMIGdldCDRgdGC0YDQvtC60YNcbiAgICAgICAgICAgIC8vVG9kbzog0LfQtNC10YHRjCDQtNC+0LvQttC10L0g0LLRi9C30YvQstCw0YLRjNGB0Y8gaGlzdG9yeUFQSSDQtNC70Y8g0YHQvtGF0YDQsNC90LXQvdC40Y8g0LjRgdGC0L7RgNC40Lgg0YEgZ2V0INC30LDQv9GA0L7RgdCw0LzQuFxuICAgICAgICAgICAgY29uc29sZS5sb2coZ2V0UXVlcnkpO1xuXG4gICAgICAgIH1cblxuICAgICAgICBpbml0KCkge1xuICAgICAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5fZmlsdGVySXRlbS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgICAgICAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS5jbGFzc0xpc3QuY29udGFpbnMoc2VsZi5fYWN0aXZlQ2xhc3MpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl90b29nbGVTb3J0KHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy/QktGL0LfQvtCyINC80LXRgtC+0LTQsCDRhNC+0YDQvNC40YDQvtCy0LDQvdC40Y8gR2V0INC30LDQv9GA0L7RgdCwXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9xdWVyeUZvcm1hdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fY2xlYW5DbGFzc0ZpbHRlckFsbCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fYWRkQ2xhc3NGaWx0ZXIodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL9CS0YvQt9C+0LIg0LzQtdGC0L7QtNCwINGE0L7RgNC80LjRgNC+0LLQsNC90LjRjyBHZXQg0LfQsNC/0YDQvtGB0LBcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3F1ZXJ5Rm9ybWF0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLl9icmFuZEl0ZW0uZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmNsYXNzTGlzdC5jb250YWlucyhcImlzLWFjdGl2ZVwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fc2VsZWN0QnJhbmQodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL9CS0YvQt9C+0LIg0LzQtdGC0L7QtNCwINGE0L7RgNC80LjRgNC+0LLQsNC90LjRjyBHZXQg0LfQsNC/0YDQvtGB0LBcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3F1ZXJ5Rm9ybWF0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgdGhpcy5zZWFyY2hJdGVtLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaW5wdXRcIilbMF0uYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIC8v0JLRi9C30L7QsiDQvNC10YLQvtC00LAg0YTQvtGA0LzQuNGA0L7QstCw0L3QuNGPIEdldCDQt9Cw0L/RgNC+0YHQsFxuICAgICAgICAgICAgICAgIHNlbGYuX3F1ZXJ5Rm9ybWF0aW9uKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxuXG5cbiAgICBjbGFzcyBBamF4R2V0UHJvZHVjdHMge1xuICAgICAgICBjb25zdHJ1Y3Rvcih1cmwsIHR5cGUpIHtcbiAgICAgICAgICAgIHRoaXMuX3VybCA9IHVybDtcbiAgICAgICAgICAgIHRoaXMuX3R5cGUgPSB0eXBlO1xuICAgICAgICAgICAgdGhpcy5hamF4ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBfcHJvZ3Jlc3MoKSB7XG4gICAgICAgICAgICAvLyDQodC00LXQu9Cw0YLRjCDQtNC10LnRgdGC0LLQuNC1INCy0L4g0LLRgNC10LzRjyDQv9GA0L7RhtC10YHRgdCwINC30LDQs9GA0YPQt9C60LhcbiAgICAgICAgfVxuXG4gICAgICAgIF9jb21wbGV0ZSgpIHtcbiAgICAgICAgICAgIC8vIGlmICh0aGlzLnN0YXR1cyAhPSAyMDApIHtcbiAgICAgICAgICAgIC8vICAgLy8g0L7QsdGA0LDQsdC+0YLQsNGC0Ywg0L7RiNC40LHQutGDXG4gICAgICAgICAgICAvLyAgIGNvbnNvbGUubG9nKCB0aGlzLnN0YXR1cyArICc6ICcgKyB0aGlzLnN0YXR1c1RleHQgKTsgLy8g0L/RgNC40LzQtdGAINCy0YvQstC+0LTQsDogNDA0OiBOb3QgRm91bmRcbiAgICAgICAgICAgIC8vIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyAgIC8vINCy0YvQstC10YHRgtC4INGA0LXQt9GD0LvRjNGC0LDRglxuICAgICAgICAgICAgLy8gICBsZXQgb2JqID0gSlNPTi5wYXJzZSh0aGlzLnJlc3BvbnNlKVxuICAgICAgICAgICAgLy8gICBjb25zb2xlLmxvZyggb2JqICk7IC8vIHJlc3BvbnNlVGV4dCAtLSDRgtC10LrRgdGCINC+0YLQstC10YLQsC5cbiAgICAgICAgICAgIGxldCByZXN1bHQgPSBKU09OLnBhcnNlKHRoaXMucmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIHNlbmQoZGF0YSkge1xuICAgICAgICAgICAgdGhpcy5hamF4LmFkZEV2ZW50TGlzdGVuZXIoXCJwcm9ncmVzc1wiLCB0aGlzLl9wcm9ncmVzcywgZmFsc2UpO1xuICAgICAgICAgICAgdGhpcy5hamF4LmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIHRoaXMuX2NvbXBsZXRlLCBmYWxzZSk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl90eXBlLnRvTG93ZXJDYXNlKCkgPT09IFwiZ2V0XCIpIHtcblxuICAgICAgICAgICAgICAgIHRoaXMuYWpheC5vcGVuKHRoaXMuX3R5cGUsIHRoaXMuX3VybCk7XG4gICAgICAgICAgICAgICAgdGhpcy5hamF4LnNlbmQoKTtcblxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZ2V0XCIpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl90eXBlLnRvTG93ZXJDYXNlKCkgPT09IFwicG9zdFwiKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJwb3N0XCIpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG5cbiAgICBsZXQgY2F0YWxvZFRlc3QgPSBuZXcgQ2F0YWxvZyhkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNhdGFsb2dcIilbMF0sIFwiY2F0YWxvZ19fdGl0bGVcIiwgXCJjYXRhbG9nX19jb250YWluZXJcIik7XG4gICAgbGV0IGFqYXhDb25uZWN0ID0gbmV3IEFqYXhHZXRQcm9kdWN0cyhcInRlc3QuanNvblwiLCBcImdldFwiKTtcbiAgICBsZXQgZmlsdGVyID0gbmV3IEZpbHRlcihkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNhdGFsb2ctbmF2X19jb250cm9sc1wiKVswXSwgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jYXRhbG9nLWZpbHRlclwiKVswXSk7XG5cbiAgICBhamF4Q29ubmVjdC5zZW5kKHtkYXRhOiAxfSk7XG5cbiAgICAvL9Ci0LXRgdGCXG4gICAgLy8gd2luZG93LmRpdkFycmF5ID0gZGl2QXJyYXk7XG4gICAgd2luZG93LmZpbHRlciA9IGZpbHRlcjtcbn0pKCk7XG4iLCI7KGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIGJ1dHRvbiA9ICQoJy5mb290ZXJfX2NvbC10aXRsZScpO1xyXG5cclxuICAgIGJ1dHRvbi5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICQodGhpcykuY2xvc2VzdCgnLmZvb3Rlcl9fY29sJykuZmluZCgnLmZvb3Rlcl9fY29sLWxpc3QnKS5zbGlkZVRvZ2dsZSgzMDApO1xyXG4gICAgfSk7XHJcbn0pKCk7XHJcbiIsIjsoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgaWYgKCQoJy5jYXRhbG9nLW5hdl9fY29udHJvbHMnKS5sZW5ndGgpIHtcclxuXHJcbiAgICAgICAgICAgIHZhciBtZW51TGluayA9ICQoJy5jYXRhbG9nLW5hdl9fY29udHJvbHMtbGluaycpLFxyXG4gICAgICAgICAgICAgICAgbWVudSA9ICQoJy5jYXRhbG9nLW5hdl9fY29udHJvbHMtbGlzdCcpO1xyXG5cclxuICAgICAgICAgICAgdmFyIG1lbnVJdGVtID0gJCgnLmNhdGFsb2ctbmF2X19jb250cm9scy1pdGVtJyksXHJcbiAgICAgICAgICAgICAgICBhY3RpdmVMaW5rID0gJCgnLmNhdGFsb2ctbmF2X19jb250cm9scy1saW5rLmlzLWFjdGl2ZScpLFxyXG4gICAgICAgICAgICAgICAgaG92ZXJCb3ggPSAkKCcuY2F0YWxvZy1uYXZfX2hvdmVyJyksXHJcbiAgICAgICAgICAgICAgICBhY3RpdmVMaW5rUG9zTGVmdCA9IGFjdGl2ZUxpbmsucG9zaXRpb24oKS5sZWZ0LFxyXG4gICAgICAgICAgICAgICAgYWN0aXZlTGlua1Bvc1RvcCA9IGFjdGl2ZUxpbmsucG9zaXRpb24oKS50b3AsXHJcbiAgICAgICAgICAgICAgICBhY3RpdmVMaW5rV2lkdGggPSBhY3RpdmVMaW5rLmlubmVyV2lkdGgoKSxcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUxpbmtIZWlnaHQgPSBhY3RpdmVMaW5rLmlubmVySGVpZ2h0KCk7XHJcblxyXG4gICAgICAgICAgICB2YXIgY2hlY2sgPSBmYWxzZTtcclxuICAgICAgICAgICAgbWVudUxpbmsuaG92ZXIoXHJcbiAgICAgICAgICAgICAgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbmV3TGlua1Bvc0xlZnQgPSAkKHRoaXMpLnBvc2l0aW9uKCkubGVmdCxcclxuICAgICAgICAgICAgICAgICAgICBuZXdMaW5rUG9zVG9wID0gJCh0aGlzKS5wb3NpdGlvbigpLnRvcCxcclxuICAgICAgICAgICAgICAgICAgICBuZXdMaW5rV2lkdGggPSAkKHRoaXMpLmlubmVyV2lkdGgoKSxcclxuICAgICAgICAgICAgICAgICAgICBuZXdMaW5rSGVpZ2h0ID0gJCh0aGlzKS5pbm5lckhlaWdodCgpO1xyXG4gICAgICAgICAgICAgICAgaG92ZXJCb3guY3NzKHsnbGVmdCcgOiBuZXdMaW5rUG9zTGVmdCwgJ3RvcCcgOiBuZXdMaW5rUG9zVG9wLCAnd2lkdGgnIDogbmV3TGlua1dpZHRoLCAnaGVpZ2h0JyA6IG5ld0xpbmtIZWlnaHR9KTtcclxuICAgICAgICAgICAgICAgIGNoZWNrID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgIGlmIChjaGVjaykge1xyXG4gICAgICAgICAgICAgICAgICAgIGhvdmVyQm94LmNzcyh7J2xlZnQnIDogYWN0aXZlTGlua1Bvc0xlZnQsICd0b3AnIDogYWN0aXZlTGlua1Bvc1RvcCwgJ3dpZHRoJyA6IDAsICdoZWlnaHQnIDogMH0pO1xyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgICAgICAgICAgIGNoZWNrID0gdHJ1ZTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiByZXNpemVQb3MoKSB7XHJcbiAgICAgICAgICAgICAgICBhY3RpdmVMaW5rUG9zTGVmdCA9IGFjdGl2ZUxpbmsucG9zaXRpb24oKS5sZWZ0LFxyXG4gICAgICAgICAgICAgICAgYWN0aXZlTGlua1Bvc1RvcCA9IGFjdGl2ZUxpbmsucG9zaXRpb24oKS50b3AsXHJcbiAgICAgICAgICAgICAgICBhY3RpdmVMaW5rV2lkdGggPSBhY3RpdmVMaW5rLmlubmVyV2lkdGgoKSxcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUxpbmtIZWlnaHQgPSBhY3RpdmVMaW5rLmlubmVySGVpZ2h0KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaG92ZXJCb3guY3NzKHsnbGVmdCcgOiBhY3RpdmVMaW5rUG9zTGVmdCwgJ3RvcCcgOiBhY3RpdmVMaW5rUG9zVG9wLCAnd2lkdGgnIDogMCwgJ2hlaWdodCcgOiAwfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICQod2luZG93KS5yZXNpemUoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICByZXNpemVQb3MoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJlc2l6ZVBvcygpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuXHJcbn0pKCk7XHJcbiIsIjsoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgJCgnLmRlbGl2ZXJ5X19mb3JtLWlucHV0JykuZm9jdXNvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgIGlmICgkKHRoaXMpLnZhbCgpICE9PSAnJykge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmFkZENsYXNzKCd2YWx1ZScpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkucmVtb3ZlQ2xhc3MoJ3ZhbHVlJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfSk7XHJcblxyXG59KSgpO1xyXG4iLCI7KGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIGxldCBzY2VuZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY2VuZScpO1xyXG4gICAgaWYgKHNjZW5lICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIGxldCBwYXJhbGxheEluc3RhbmNlID0gbmV3IFBhcmFsbGF4KHNjZW5lKTtcclxuICAgIH1cclxuXHJcbn0pKCk7XHJcbiIsIjsoZnVuY3Rpb24oKSB7XHJcbiAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLnNsaWRlLWluZm9fX2J1dHRvbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICQodGhpcykuY2xvc2VzdCgnLnNsaWRlLWluZm8nKS5maW5kKCcuc2xpZGUtaW5mb19fYnV0dG9uJykudG9nZ2xlQ2xhc3MoJ2lzLWFjdGl2ZScpO1xyXG4gICAgICAgICQodGhpcykuY2xvc2VzdCgnLnNsaWRlLWluZm8nKS5maW5kKCcuc2xpZGUtaW5mb19fY29udGVudCcpLnNsaWRlVG9nZ2xlKDMwMCk7XHJcbiAgICB9KTtcclxufSkoKTtcclxuIl19
