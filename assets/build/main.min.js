"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,s){return e&&_defineProperties(t.prototype,e),s&&_defineProperties(t,s),t}$(document).on("click",".button--basket",function(){$(this).hasClass("animate")||($(this).addClass("animate"),$(this).addClass("button--check"),setTimeout(function(){$(this).removeClass("button--check"),$(this).removeClass("animate")}.bind(this),2e3))}),window.addEventListener("load",function(){$(".hr-sect").length&&$(".hr-pagination__step").click(function(){var t=$(this);if(!t.hasClass("is-active")){t.closest(".hr-sect").find(".hr-pagination__step").removeClass("is-active").removeClass("button"),t.addClass("is-active").addClass("button"),t.attr("data-index");var e=t.closest(".hr-sect").find(".hr-slider-slide");e.removeClass("is-active"),e.each(function(t,e){$(this).attr("data-index")==$(".hr-pagination__step.is-active").attr("data-index")&&$(this).addClass("is-active")})}})}),function(){var t=document.getElementById("menu-button");t.addEventListener("click",function(){t.classList.toggle("opened")}),window.onresize=function(){t.classList.remove("opened")},window.onscroll=function(){t.classList.remove("opened")}}(),function(){var t=function(){function a(t,e,s,i){if(_classCallCheck(this,a),void 0===t)return!1;this._self=t,this._title=this._self.querySelectorAll("."+e)[0],this._products=this._self.querySelectorAll("."+s)[0],this.preloader=this._self.querySelectorAll("."+i)[0]}return _createClass(a,[{key:"_cleanProducts",value:function(){this._products.innerHTML=""}},{key:"playPreloader",value:function(){this.preloader.classList.add("preloader--active")}},{key:"stopPreloader",value:function(){this.preloader.classList.remove("preloader--active")}},{key:"updateTitle",value:function(t){this._title.innerHTML=t,this._title.setAttribute("data-name",t)}},{key:"updateListProducts",value:function(t){this._products.innerHTML=t}},{key:"addProducts",value:function(t){this._products.insertAdjacentHTML("beforeend",t)}}]),a}(),e=function(){function i(t,e,s){return _classCallCheck(this,i),void 0!==t&&(void 0!==e&&(void 0!==s&&(this._containerBrands=t,this._brandItem=this._containerBrands.querySelectorAll(".catalog-nav__controls-link"),this._containerFilter=e,this._filterItem=this._containerFilter.querySelectorAll(".catalog-filter__col-btn"),this.searchItem=this._containerFilter.querySelectorAll(".catalog-filter__form")[0],this._activeClass="is-active",this._sortTypeAsc={class:"sort-down",dataSort:"asc"},this._sortTypeDesc={class:"sort-up",dataSort:"desc"},this._containerMore=s,this.timeOutAjax,void this.init())))}return _createClass(i,[{key:"_cleanClassFilterAll",value:function(){var s=this;this._filterItem.forEach(function(t){var e=t.closest(".catalog-filter__col");t.classList.remove(s._activeClass),t.classList.remove(s._sortTypeAsc.class),e.removeAttribute("data-sort")})}},{key:"_addClassFilter",value:function(t){var e=t.closest(".catalog-filter__col");console.log(t),t.classList.add(this._activeClass),t.classList.add(this._sortTypeAsc.class),e.setAttribute("data-sort",this._sortTypeAsc.dataSort)}},{key:"_toogleSort",value:function(t){var e=t.closest(".catalog-filter__col");t.classList.contains(this._sortTypeAsc.class)?(t.classList.remove(this._sortTypeAsc.class),t.classList.add(this._sortTypeDesc.class),e.setAttribute("data-sort",this._sortTypeDesc.dataSort)):(t.classList.remove(this._sortTypeDesc.class),t.classList.add(this._sortTypeAsc.class),e.setAttribute("data-sort",this._sortTypeAsc.dataSort))}},{key:"_selectBrand",value:function(t){t.classList.contains("is-active")||(this._brandItem.forEach(function(t){t.classList.remove("is-active")}),t.classList.add("is-active"))}},{key:"_queryFormation",value:function(t,e){clearTimeout(this.timeOutAjax);var s,i,a=[],o=this.searchItem.getElementsByTagName("input")[0];this._brandItem.forEach(function(t){t.classList.contains("is-active")&&(a.push("brand="+t.getAttribute("data-brand")),s=t.getAttribute("data-brand"))}),this._filterItem.forEach(function(t){var e=t.closest(".catalog-filter__col");t.classList.contains("is-active")&&(a.push("sort="+e.getAttribute("data-sort")),a.push("sortType="+e.getAttribute("data-filter")))}),""!==o.value&&a.push("search="+o.value),i="?"+a.join("&"),i=encodeURI(i),c.setHistory(i,s);var n=new l("test.json","get",t);void 0===e?n.send():(r.playPreloader(),this.timeOutAjax=setTimeout(function(){n.send()},e)),console.log(i)}},{key:"updateStateFilterFromUrl",value:function(e){var s=this;void 0!==e[0]?this._brandItem.forEach(function(t){t.getAttribute("data-brand")===e[0][1]&&s._selectBrand(t)}):this._selectBrand(this._brandItem[0]),void 0!==e[2]?this._filterItem.forEach(function(t){t.closest(".catalog-filter__col").getAttribute("data-filter")===e[2][1]&&(s._cleanClassFilterAll(),s._addClassFilter(t),t.closest(".catalog-filter__col").setAttribute("data-sort",e[1][1]),"asc"===e[1][1]?(t.classList.add(s._sortTypeAsc.class),t.classList.remove(s._sortTypeDesc.class)):(t.classList.remove(s._sortTypeAsc.class),t.classList.add(s._sortTypeDesc.class)))}):this._filterItem.forEach(function(t){"name"===t.closest(".catalog-filter__col").getAttribute("data-filter")&&(s._cleanClassFilterAll(),s._addClassFilter(t))}),void 0!==e[3]?(console.log(e[3][1]),s.searchItem.getElementsByTagName("input")[0].value=e[3][1]):s.searchItem.getElementsByTagName("input")[0].value=""}},{key:"init",value:function(){var e=this;this._filterItem.forEach(function(t){t.addEventListener("click",function(){t.classList.contains(e._activeClass)?e._toogleSort(this):(e._cleanClassFilterAll(),e._addClassFilter(this)),e._queryFormation(!0)})}),this._brandItem.forEach(function(t){t.addEventListener("click",function(t){t.preventDefault(),this.classList.contains("is-active")||(e._selectBrand(this),e._queryFormation(!0))})}),this.searchItem.getElementsByTagName("input")[0].addEventListener("input",function(){e._queryFormation(!0,1e3)}),this._containerMore.querySelectorAll(".catalog__more-button")[0].addEventListener("click",function(t){t.preventDefault(),e._queryFormation(!1)})}}]),i}(),s=function(){function t(){_classCallCheck(this,t),this._url,this._historyObj=window.history,this.init()}return _createClass(t,[{key:"setHistory",value:function(t,e){e===this._historyObj.state?this._historyObj.replaceState(e,e,t):this._historyObj.pushState(e,e,t)}},{key:"_readHistory",value:function(){var t=document.location.href,e=decodeURI(t).split("?"),s=[];void 0!==e[1]?(e[1].split("&").forEach(function(t){s.push(t.split("="))}),console.log(s),i.updateStateFilterFromUrl(s),new l("test.json","get",!0).send()):(i.updateStateFilterFromUrl([]),new l("test.json","get",!0).send())}},{key:"init",value:function(){window.addEventListener("popstate",this._readHistory)}}]),t}(),l=function(){function i(t,e,s){_classCallCheck(this,i),this._url=t,this._type=e,this._productUpdate=s,this.ajax=new XMLHttpRequest}return _createClass(i,[{key:"_progress",value:function(){r.playPreloader()}},{key:"_complete",value:function(){var t=JSON.parse(this.response);!0===productUpdate?(r.updateTitle(t.title),r.updateListProducts(t.elements)):r.addProducts(t.elements),r.stopPreloader(),console.log(t)}},{key:"_completeUpdatePrpoducts",value:function(){var t=JSON.parse(this.response);r.updateTitle(t.title),r.updateListProducts(t.elements),r.stopPreloader(),console.log(t)}},{key:"_completeAddProducts",value:function(){var t=JSON.parse(this.response);r.addProducts(t.elements),r.stopPreloader(),console.log(t)}},{key:"send",value:function(t){var e=this._productUpdate,s=this;this.ajax.addEventListener("progress",this._progress,!1),this.ajax.addEventListener("load",!0===e?s._completeUpdatePrpoducts:s._completeAddProducts,!1),"get"===this._type.toLowerCase()?(this.ajax.open(this._type,this._url),this.ajax.send(),console.log("get")):"post"===this._type.toLowerCase()?console.log("post"):console.log("Error")}}]),i}(),r=new t(document.querySelectorAll(".catalog")[0],"catalog__title","catalog__product","preloader"),i=new e(document.querySelectorAll(".catalog-nav__controls")[0],document.querySelectorAll(".catalog-filter")[0],document.querySelectorAll(".catalog__more")[0]),c=new s;window.filter=i}(),$(".footer__col-title").on("click",function(t){t.preventDefault(),$(this).closest(".footer__col").find(".footer__col-list").slideToggle(300)}),window.addEventListener("load",function(){if($(".catalog-nav__controls").length){var t=function(){i=s.position().left,o=s.position().top,s.innerWidth(),s.innerHeight(),a.css({left:i,top:o,width:0,height:0})},e=$(".catalog-nav__controls-link"),s=($(".catalog-nav__controls-list"),$(".catalog-nav__controls-item"),$(".catalog-nav__controls-link.is-active")),a=$(".catalog-nav__hover"),i=s.position().left,o=s.position().top,n=(s.innerWidth(),s.innerHeight(),!1);e.hover(function(){var t=$(this).position().left,e=$(this).position().top,s=$(this).innerWidth(),i=$(this).innerHeight();a.css({left:t,top:e,width:s,height:i}),n=!1},function(){setTimeout(function(){n&&a.css({left:i,top:o,width:0,height:0})},1e3),n=!0}),$(window).resize(function(){t()}),t()}}),window.addEventListener("load",function(){$(".delivery__form-input").focusout(function(){""!==$(this).val()?$(this).parent().addClass("value"):$(this).parent().removeClass("value")})}),function(){var t=document.getElementById("scene");if(null!=t)new Parallax(t)}(),$(document).on("click",".slide-info__button",function(){$(this).closest(".slide-info").find(".slide-info__button").toggleClass("is-active"),$(this).closest(".slide-info").find(".slide-info__content").slideToggle(300)});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkZFRvQmFza2V0LmpzIiwiYmFza2V0VGFicy5qcyIsImJ1cmdlci5qcyIsImNhdGFsb2dVcGRhdGVDbGFzcy5qcyIsImZvb3Rlck1lbnUuanMiLCJob3ZlclJvbGxlci5qcyIsImxhYmVsRm9ybS5qcyIsInBhcmFsbGF4LmpzIiwic2hvd01vcmUuanMiXSwibmFtZXMiOlsiJCIsImRvY3VtZW50Iiwib24iLCJ0aGlzIiwiaGFzQ2xhc3MiLCJhZGRDbGFzcyIsInNldFRpbWVvdXQiLCJyZW1vdmVDbGFzcyIsImJpbmQiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwibGVuZ3RoIiwiY2xpY2siLCJ0aFN0ZXAiLCJjbG9zZXN0IiwiZmluZCIsImF0dHIiLCJzbGlkZXJTbGlkZXMiLCJlYWNoIiwicGFnaUluZGV4IiwibWVudUJ0biIsImdldEVsZW1lbnRCeUlkIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwib25yZXNpemUiLCJyZW1vdmUiLCJvbnNjcm9sbCIsIkNhdGFsb2ciLCJzZWxmIiwidGl0bGVDbGFzcyIsInByb2R1Y3RzQ29udGFpbmVyQ2xhc3MiLCJwcm9kdWN0c1ByZWxvYWRlckNsYXNzIiwiX2NsYXNzQ2FsbENoZWNrIiwidW5kZWZpbmVkIiwiX3NlbGYiLCJfdGl0bGUiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3Byb2R1Y3RzIiwicHJlbG9hZGVyIiwiX2NyZWF0ZUNsYXNzIiwia2V5IiwidmFsdWUiLCJpbm5lckhUTUwiLCJhZGQiLCJ0aXRsZSIsInNldEF0dHJpYnV0ZSIsInByb2R1Y3RzIiwiaW5zZXJ0QWRqYWNlbnRIVE1MIiwiRmlsdGVyIiwiY29udGFpbmVyQnJhbmRzIiwiY29udGFpbmVyRmlsdGVyIiwiY29udGFpbmVyTW9yZSIsIl9jb250YWluZXJCcmFuZHMiLCJfYnJhbmRJdGVtIiwiX2NvbnRhaW5lckZpbHRlciIsIl9maWx0ZXJJdGVtIiwic2VhcmNoSXRlbSIsIl9hY3RpdmVDbGFzcyIsIl9zb3J0VHlwZUFzYyIsImNsYXNzIiwiZGF0YVNvcnQiLCJfc29ydFR5cGVEZXNjIiwiX2NvbnRhaW5lck1vcmUiLCJ0aW1lT3V0QWpheCIsImluaXQiLCJmb3JFYWNoIiwiaXRlbSIsInBhcmVudCIsInJlbW92ZUF0dHJpYnV0ZSIsImNvbnNvbGUiLCJsb2ciLCJjb250YWlucyIsInByb2R1Y3RVcGRhdGUiLCJkZWxheSIsImNsZWFyVGltZW91dCIsImJyYW5kIiwiZ2V0UXVlcnkiLCJhcnJheVF1ZXJ5IiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJwdXNoIiwiZ2V0QXR0cmlidXRlIiwiam9pbiIsImVuY29kZVVSSSIsImhpc3RvcnlPYmoiLCJzZXRIaXN0b3J5IiwiYWpheENvbm5lY3QiLCJBamF4R2V0UHJvZHVjdHMiLCJzZW5kIiwiY2F0YWxvZFRlc3QiLCJwbGF5UHJlbG9hZGVyIiwiYXJyYXlSZXN1bHQiLCJfc2VsZWN0QnJhbmQiLCJfY2xlYW5DbGFzc0ZpbHRlckFsbCIsIl9hZGRDbGFzc0ZpbHRlciIsIl90b29nbGVTb3J0IiwiX3F1ZXJ5Rm9ybWF0aW9uIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsIkhpc3RvcnlDb25ydG9sIiwiX3VybCIsIl9oaXN0b3J5T2JqIiwiaGlzdG9yeSIsInN0YXRlIiwicmVwbGFjZVN0YXRlIiwicHVzaFN0YXRlIiwidXJsIiwibG9jYXRpb24iLCJocmVmIiwiYXJyYXlVcmwiLCJkZWNvZGVVUkkiLCJzcGxpdCIsImZpbHRlciIsInVwZGF0ZVN0YXRlRmlsdGVyRnJvbVVybCIsIl9yZWFkSGlzdG9yeSIsInR5cGUiLCJfdHlwZSIsIl9wcm9kdWN0VXBkYXRlIiwiYWpheCIsIlhNTEh0dHBSZXF1ZXN0IiwicmVzdWx0IiwiSlNPTiIsInBhcnNlIiwicmVzcG9uc2UiLCJ1cGRhdGVUaXRsZSIsInVwZGF0ZUxpc3RQcm9kdWN0cyIsImVsZW1lbnRzIiwiYWRkUHJvZHVjdHMiLCJzdG9wUHJlbG9hZGVyIiwiZGF0YSIsIl9wcm9ncmVzcyIsIl9jb21wbGV0ZVVwZGF0ZVBycG9kdWN0cyIsIl9jb21wbGV0ZUFkZFByb2R1Y3RzIiwidG9Mb3dlckNhc2UiLCJvcGVuIiwiZSIsInNsaWRlVG9nZ2xlIiwicmVzaXplUG9zIiwiYWN0aXZlTGlua1Bvc0xlZnQiLCJhY3RpdmVMaW5rIiwicG9zaXRpb24iLCJsZWZ0IiwiYWN0aXZlTGlua1Bvc1RvcCIsInRvcCIsImlubmVyV2lkdGgiLCJpbm5lckhlaWdodCIsImhvdmVyQm94IiwiY3NzIiwid2lkdGgiLCJoZWlnaHQiLCJtZW51TGluayIsImNoZWNrIiwiaG92ZXIiLCJuZXdMaW5rUG9zTGVmdCIsIm5ld0xpbmtQb3NUb3AiLCJuZXdMaW5rV2lkdGgiLCJuZXdMaW5rSGVpZ2h0IiwicmVzaXplIiwiZm9jdXNvdXQiLCJ2YWwiLCJzY2VuZSIsIlBhcmFsbGF4IiwidG9nZ2xlQ2xhc3MiXSwibWFwcGluZ3MiOiJtWkFDSUEsRUFBRUMsVUFBVUMsR0FBRyxRQUFTLGtCQUFtQixXQUNsQ0YsRUFBRUcsTUFBTUMsU0FBUyxhQUNsQkosRUFBRUcsTUFBTUUsU0FBUyxXQUNqQkwsRUFBRUcsTUFBTUUsU0FBUyxpQkFDakJDLFdBQVcsV0FDUE4sRUFBRUcsTUFBTUksWUFBWSxpQkFDcEJQLEVBQUVHLE1BQU1JLFlBQVksWUFDdEJDLEtBQUtMLE1BQU8sUUNOdEJNLE9BQU9DLGlCQUFpQixPQUFRLFdBRXhCVixFQUFFLFlBQVlXLFFBRWRYLEVBQUUsd0JBQXdCWSxNQUFNLFdBQzVCLElBQUlDLEVBQVNiLEVBQUVHLE1BQ2YsSUFBS1UsRUFBT1QsU0FBUyxhQUFjLENBQy9CUyxFQUFPQyxRQUFRLFlBQVlDLEtBQUssd0JBQXdCUixZQUFZLGFBQWFBLFlBQVksVUFDN0ZNLEVBQU9SLFNBQVMsYUFBYUEsU0FBUyxVQUN0QlEsRUFBT0csS0FBSyxjQUE1QixJQUVJQyxFQUFlSixFQUFPQyxRQUFRLFlBQVlDLEtBQUssb0JBQ25ERSxFQUFhVixZQUFZLGFBQ3pCVSxFQUFhQyxLQUFLLFNBQVNDLEVBQVdOLEdBQzlCYixFQUFFRyxNQUFNYSxLQUFLLGVBQWlCaEIsRUFB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LEtBQVNILEVBQW1CSyxJQUFRRCxFQUFrQk0sTUFBVSxFQUFHQyxPQUFXLEtBRTdGLEtBQ0hFLEdBQVEsSUFhWnRKLEVBQUVTLFFBQVFtSixPQUFPLFdBQ2JwQixNQUVKQSxPQy9DUi9ILE9BQU9DLGlCQUFpQixPQUFRLFdBRTVCVixFQUFFLHlCQUF5QjZKLFNBQVMsV0FDWixLQUFsQjdKLEVBQUVHLE1BQU0ySixNQUNWOUosRUFBRUcsTUFBTWdFLFNBQVM5RCxTQUFTLFNBRzFCTCxFQUFFRyxNQUFNZ0UsU0FBUzVELFlBQVksYUNUeEMsV0FFRyxJQUFJd0osRUFBUTlKLFNBQVNvQixlQUFlLFNBQ3BDLEdBQWFZLE1BQVQ4SCxFQUN1QixJQUFJQyxTQUFTRCxHQUozQyxHQ0NHL0osRUFBRUMsVUFBVUMsR0FBRyxRQUFTLHNCQUF1QixXQUMzQ0YsRUFBRUcsTUFBTVcsUUFBUSxlQUFlQyxLQUFLLHVCQUF1QmtKLFlBQVksYUFDdkVqSyxFQUFFRyxNQUFNVyxRQUFRLGVBQWVDLEtBQUssd0JBQXdCd0gsWUFBWSIsImZpbGUiOiJtYWluLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIjsoZnVuY3Rpb24oKSB7XHJcbiAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLmJ1dHRvbi0tYmFza2V0JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKCEkKHRoaXMpLmhhc0NsYXNzKCdhbmltYXRlJykpIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnYW5pbWF0ZScpO1xyXG4gICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKFwiYnV0dG9uLS1jaGVja1wiKTtcclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoXCJidXR0b24tLWNoZWNrXCIpO1xyXG4gICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnYW5pbWF0ZScpO1xyXG4gICAgICAgICAgICB9LmJpbmQodGhpcyksIDIwMDApO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59KSgpO1xyXG4iLCI7KGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgIGlmICgkKCcuaHItc2VjdCcpLmxlbmd0aCkge1xyXG5cclxuICAgICAgICAgICAgJChcIi5oci1wYWdpbmF0aW9uX19zdGVwXCIpLmNsaWNrKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRoU3RlcCA9ICQodGhpcyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoU3RlcC5oYXNDbGFzcyhcImlzLWFjdGl2ZVwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoU3RlcC5jbG9zZXN0KCcuaHItc2VjdCcpLmZpbmQoXCIuaHItcGFnaW5hdGlvbl9fc3RlcFwiKS5yZW1vdmVDbGFzcyhcImlzLWFjdGl2ZVwiKS5yZW1vdmVDbGFzcyhcImJ1dHRvblwiKTtcclxuICAgICAgICAgICAgICAgICAgICB0aFN0ZXAuYWRkQ2xhc3MoXCJpcy1hY3RpdmVcIikuYWRkQ2xhc3MoXCJidXR0b25cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhZ2lJbmRleCA9IHRoU3RlcC5hdHRyKFwiZGF0YS1pbmRleFwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNsaWRlclNsaWRlcyA9IHRoU3RlcC5jbG9zZXN0KFwiLmhyLXNlY3RcIikuZmluZChcIi5oci1zbGlkZXItc2xpZGVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgc2xpZGVyU2xpZGVzLnJlbW92ZUNsYXNzKFwiaXMtYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNsaWRlclNsaWRlcy5lYWNoKGZ1bmN0aW9uKHBhZ2lJbmRleCwgdGhTdGVwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkKHRoaXMpLmF0dHIoXCJkYXRhLWluZGV4XCIpID09ICQoXCIuaHItcGFnaW5hdGlvbl9fc3RlcC5pcy1hY3RpdmVcIikuYXR0cihcImRhdGEtaW5kZXhcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoXCJpcy1hY3RpdmVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9KTtcclxuXHJcbn0pKCk7XHJcbiIsIjsoZnVuY3Rpb24oKSB7XHJcbiAgICBsZXQgbWVudUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtZW51LWJ1dHRvbicpO1xyXG5cclxuICAgIG1lbnVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBtZW51QnRuLmNsYXNzTGlzdC50b2dnbGUoJ29wZW5lZCcpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgd2luZG93Lm9ucmVzaXplID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbWVudUJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdvcGVuZWQnKTtcclxuICAgIH1cclxuICAgIHdpbmRvdy5vbnNjcm9sbCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIG1lbnVCdG4uY2xhc3NMaXN0LnJlbW92ZSgnb3BlbmVkJyk7XHJcbiAgICB9XHJcbn0pKCk7XHJcbiIsIjsoZnVuY3Rpb24oKXtcclxuXHJcbiAgICBjbGFzcyBDYXRhbG9nIHtcclxuICAgICAgICBjb25zdHJ1Y3RvcihzZWxmLCB0aXRsZUNsYXNzLCBwcm9kdWN0c0NvbnRhaW5lckNsYXNzLCBwcm9kdWN0c1ByZWxvYWRlckNsYXNzKXtcclxuICAgICAgICAgICAgaWYgKHNlbGYgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuX3NlbGYgPSBzZWxmO1xyXG4gICAgICAgICAgICB0aGlzLl90aXRsZSA9IHRoaXMuX3NlbGYucXVlcnlTZWxlY3RvckFsbChcIi5cIiArIHRpdGxlQ2xhc3MpWzBdO1xyXG4gICAgICAgICAgICB0aGlzLl9wcm9kdWN0cyA9IHRoaXMuX3NlbGYucXVlcnlTZWxlY3RvckFsbChcIi5cIiArIHByb2R1Y3RzQ29udGFpbmVyQ2xhc3MpWzBdO1xyXG4gICAgICAgICAgICB0aGlzLnByZWxvYWRlciA9IHRoaXMuX3NlbGYucXVlcnlTZWxlY3RvckFsbChcIi5cIiArIHByb2R1Y3RzUHJlbG9hZGVyQ2xhc3MpWzBdO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIF9jbGVhblByb2R1Y3RzKCkge1xyXG4gICAgICAgICAgICB0aGlzLl9wcm9kdWN0cy5pbm5lckhUTUwgPSBcIlwiO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcGxheVByZWxvYWRlcigpIHtcclxuICAgICAgICAgICAgdGhpcy5wcmVsb2FkZXIuY2xhc3NMaXN0LmFkZChcInByZWxvYWRlci0tYWN0aXZlXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgc3RvcFByZWxvYWRlcigpIHtcclxuICAgICAgICAgICAgdGhpcy5wcmVsb2FkZXIuY2xhc3NMaXN0LnJlbW92ZShcInByZWxvYWRlci0tYWN0aXZlXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdXBkYXRlVGl0bGUodGl0bGUpIHtcclxuICAgICAgICAgICAgdGhpcy5fdGl0bGUuaW5uZXJIVE1MID0gdGl0bGU7XHJcbiAgICAgICAgICAgIHRoaXMuX3RpdGxlLnNldEF0dHJpYnV0ZShcImRhdGEtbmFtZVwiLCB0aXRsZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB1cGRhdGVMaXN0UHJvZHVjdHMocHJvZHVjdHMpIHtcclxuICAgICAgICAgICAgdGhpcy5fcHJvZHVjdHMuaW5uZXJIVE1MID0gcHJvZHVjdHM7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBhZGRQcm9kdWN0cyhwcm9kdWN0cykge1xyXG4gICAgICAgICAgICB0aGlzLl9wcm9kdWN0cy5pbnNlcnRBZGphY2VudEhUTUwoXCJiZWZvcmVlbmRcIiwgcHJvZHVjdHMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjbGFzcyBGaWx0ZXIge1xyXG4gICAgICAgIGNvbnN0cnVjdG9yKGNvbnRhaW5lckJyYW5kcywgY29udGFpbmVyRmlsdGVyLCBjb250YWluZXJNb3JlKSB7XHJcbiAgICAgICAgICAgIGlmIChjb250YWluZXJCcmFuZHMgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjb250YWluZXJGaWx0ZXIgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjb250YWluZXJNb3JlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5fY29udGFpbmVyQnJhbmRzID0gY29udGFpbmVyQnJhbmRzO1xyXG4gICAgICAgICAgICB0aGlzLl9icmFuZEl0ZW0gPSB0aGlzLl9jb250YWluZXJCcmFuZHMucXVlcnlTZWxlY3RvckFsbChcIi5jYXRhbG9nLW5hdl9fY29udHJvbHMtbGlua1wiKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX2NvbnRhaW5lckZpbHRlciA9IGNvbnRhaW5lckZpbHRlcjtcclxuICAgICAgICAgICAgdGhpcy5fZmlsdGVySXRlbSA9IHRoaXMuX2NvbnRhaW5lckZpbHRlci5xdWVyeVNlbGVjdG9yQWxsKFwiLmNhdGFsb2ctZmlsdGVyX19jb2wtYnRuXCIpO1xyXG4gICAgICAgICAgICB0aGlzLnNlYXJjaEl0ZW0gPSB0aGlzLl9jb250YWluZXJGaWx0ZXIucXVlcnlTZWxlY3RvckFsbChcIi5jYXRhbG9nLWZpbHRlcl9fZm9ybVwiKVswXTtcclxuICAgICAgICAgICAgdGhpcy5fYWN0aXZlQ2xhc3MgPSBcImlzLWFjdGl2ZVwiO1xyXG4gICAgICAgICAgICB0aGlzLl9zb3J0VHlwZUFzYyA9IHtcclxuICAgICAgICAgICAgICAgIGNsYXNzOiBcInNvcnQtZG93blwiLFxyXG4gICAgICAgICAgICAgICAgZGF0YVNvcnQ6IFwiYXNjXCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdGhpcy5fc29ydFR5cGVEZXNjID0ge1xyXG4gICAgICAgICAgICAgICAgY2xhc3M6IFwic29ydC11cFwiLFxyXG4gICAgICAgICAgICAgICAgZGF0YVNvcnQ6IFwiZGVzY1wiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuX2NvbnRhaW5lck1vcmUgPSBjb250YWluZXJNb3JlO1xyXG5cclxuICAgICAgICAgICAgdGhpcy50aW1lT3V0QWpheDtcclxuICAgICAgICAgICAgdGhpcy5pbml0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBfY2xlYW5DbGFzc0ZpbHRlckFsbCgpIHtcclxuICAgICAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5fZmlsdGVySXRlbS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pe1xyXG4gICAgICAgICAgICAgICAgbGV0IHBhcmVudCA9IGl0ZW0uY2xvc2VzdChcIi5jYXRhbG9nLWZpbHRlcl9fY29sXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoc2VsZi5fYWN0aXZlQ2xhc3MpO1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZShzZWxmLl9zb3J0VHlwZUFzYy5jbGFzcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50LnJlbW92ZUF0dHJpYnV0ZShcImRhdGEtc29ydFwiKTtcclxuXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgX2FkZENsYXNzRmlsdGVyKGl0ZW0pIHtcclxuICAgICAgICAgICAgbGV0IHBhcmVudCA9IGl0ZW0uY2xvc2VzdChcIi5jYXRhbG9nLWZpbHRlcl9fY29sXCIpO1xyXG5cclxuICAgICAgICAgICAgY29uc29sZS5sb2coaXRlbSk7XHJcblxyXG4gICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQodGhpcy5fYWN0aXZlQ2xhc3MpO1xyXG4gICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQodGhpcy5fc29ydFR5cGVBc2MuY2xhc3MpO1xyXG5cclxuICAgICAgICAgICAgcGFyZW50LnNldEF0dHJpYnV0ZShcImRhdGEtc29ydFwiLCB0aGlzLl9zb3J0VHlwZUFzYy5kYXRhU29ydCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBfdG9vZ2xlU29ydChpdGVtKSB7XHJcbiAgICAgICAgICAgIGxldCBwYXJlbnQgPSBpdGVtLmNsb3Nlc3QoXCIuY2F0YWxvZy1maWx0ZXJfX2NvbFwiKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChpdGVtLmNsYXNzTGlzdC5jb250YWlucyh0aGlzLl9zb3J0VHlwZUFzYy5jbGFzcykpIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zb3J0VHlwZUFzYy5jbGFzcyk7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQodGhpcy5fc29ydFR5cGVEZXNjLmNsYXNzKTtcclxuXHJcbiAgICAgICAgICAgICAgICBwYXJlbnQuc2V0QXR0cmlidXRlKFwiZGF0YS1zb3J0XCIsIHRoaXMuX3NvcnRUeXBlRGVzYy5kYXRhU29ydCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc29ydFR5cGVEZXNjLmNsYXNzKTtcclxuICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZCh0aGlzLl9zb3J0VHlwZUFzYy5jbGFzcyk7XHJcblxyXG4gICAgICAgICAgICAgICAgcGFyZW50LnNldEF0dHJpYnV0ZShcImRhdGEtc29ydFwiLCB0aGlzLl9zb3J0VHlwZUFzYy5kYXRhU29ydCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBfc2VsZWN0QnJhbmQoaXRlbSkge1xyXG4gICAgICAgICAgICBpZiAoIWl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKFwiaXMtYWN0aXZlXCIpKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2JyYW5kSXRlbS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoXCJpcy1hY3RpdmVcIik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZChcImlzLWFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgX3F1ZXJ5Rm9ybWF0aW9uKHByb2R1Y3RVcGRhdGUsIGRlbGF5KSB7XHJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVPdXRBamF4KTtcclxuICAgICAgICAgICAgLy/QnNC10YLQvtC0INGE0L7RgNC80LjRgNC+0LLQsNC90LjRjyBnZXQg0LfQsNC/0YDQvtGB0LBcclxuICAgICAgICAgICAgbGV0IGFycmF5UXVlcnkgPSBbXSxcclxuICAgICAgICAgICAgICAgIHNlYXJjaEl0ZW0gPSB0aGlzLnNlYXJjaEl0ZW0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJpbnB1dFwiKVswXSxcclxuICAgICAgICAgICAgICAgIGJyYW5kLFxyXG4gICAgICAgICAgICAgICAgZ2V0UXVlcnk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9icmFuZEl0ZW0uZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXRlbS5jbGFzc0xpc3QuY29udGFpbnMoXCJpcy1hY3RpdmVcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICBhcnJheVF1ZXJ5LnB1c2goXCJicmFuZD1cIiArIGl0ZW0uZ2V0QXR0cmlidXRlKFwiZGF0YS1icmFuZFwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJhbmQgPSBpdGVtLmdldEF0dHJpYnV0ZShcImRhdGEtYnJhbmRcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5fZmlsdGVySXRlbS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIGxldCBwYXJlbnQgPSBpdGVtLmNsb3Nlc3QoXCIuY2F0YWxvZy1maWx0ZXJfX2NvbFwiKTtcclxuICAgICAgICAgICAgICAgIGlmIChpdGVtLmNsYXNzTGlzdC5jb250YWlucyhcImlzLWFjdGl2ZVwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFycmF5UXVlcnkucHVzaChcInNvcnQ9XCIgKyBwYXJlbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS1zb3J0XCIpKTtcclxuICAgICAgICAgICAgICAgICAgICBhcnJheVF1ZXJ5LnB1c2goXCJzb3J0VHlwZT1cIiArIHBhcmVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLWZpbHRlclwiKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHNlYXJjaEl0ZW0udmFsdWUgIT09IFwiXCIpIHtcclxuICAgICAgICAgICAgICAgIGFycmF5UXVlcnkucHVzaChcInNlYXJjaD1cIiArIHNlYXJjaEl0ZW0udmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRRdWVyeSA9IFwiP1wiICsgYXJyYXlRdWVyeS5qb2luKFwiJlwiKTtcclxuXHJcbiAgICAgICAgICAgIGdldFF1ZXJ5ID0gZW5jb2RlVVJJKGdldFF1ZXJ5KTtcclxuXHJcbiAgICAgICAgICAgIGhpc3RvcnlPYmouc2V0SGlzdG9yeShnZXRRdWVyeSwgYnJhbmQpO1xyXG5cclxuICAgICAgICAgICAgLy9Ub2RvOiDQt9C00LXRgdGMINC90LDQtNC+INCx0YPQtNC10YIg0YHQtNC10LvQsNGC0Ywg0LDQutGC0YPQsNC70YzQvdGL0Lkg0YPRgNC7INC00LvRjyBhamF4INC30LDQv9GA0L7RgdC+0LJcclxuICAgICAgICAgICAgLy8g0J/RgNC40LzQtdGAOiBsZXQgYWpheENvbm5lY3QgPSBuZXcgQWpheEdldFByb2R1Y3RzKHdpbmRvdy5sb2NhdGlvbi5ocmVmICsgZ2V0UXVlcnksIFwiZ2V0XCIsIHRydWUpO1xyXG4gICAgICAgICAgICBsZXQgYWpheENvbm5lY3QgPSBuZXcgQWpheEdldFByb2R1Y3RzKFwidGVzdC5qc29uXCIsIFwiZ2V0XCIsIHByb2R1Y3RVcGRhdGUpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGRlbGF5ID09PSB1bmRlZmluZWQpe1xyXG4gICAgICAgICAgICAgICAgYWpheENvbm5lY3Quc2VuZCgpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY2F0YWxvZFRlc3QucGxheVByZWxvYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50aW1lT3V0QWpheCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICBhamF4Q29ubmVjdC5zZW5kKCk7XHJcbiAgICAgICAgICAgICAgICB9LCBkZWxheSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc29sZS5sb2coZ2V0UXVlcnkpO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHVwZGF0ZVN0YXRlRmlsdGVyRnJvbVVybChhcnJheVJlc3VsdCkge1xyXG4gICAgICAgICAgICAvLyB1cGRhdGVTdGF0ZUZpbHRlckZyb21VcmwoYXJyYXlSZXN1bHRbMF1bMV0sIGFycmF5UmVzdWx0WzJdWzFdLCBhcnJheVJlc3VsdFsxXVsxXSwgYXJyYXlSZXN1bHRbM11bMV0pXHJcbiAgICAgICAgICAgIGxldCBzZWxmID0gdGhpcztcclxuXHJcblxyXG4gICAgICAgICAgICBpZiAoYXJyYXlSZXN1bHRbMF0gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYnJhbmRJdGVtLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLmdldEF0dHJpYnV0ZShcImRhdGEtYnJhbmRcIikgPT09IGFycmF5UmVzdWx0WzBdWzFdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3NlbGVjdEJyYW5kKGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zZWxlY3RCcmFuZCh0aGlzLl9icmFuZEl0ZW1bMF0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoYXJyYXlSZXN1bHRbMl0gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZmlsdGVySXRlbS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS5jbG9zZXN0KFwiLmNhdGFsb2ctZmlsdGVyX19jb2xcIikuZ2V0QXR0cmlidXRlKFwiZGF0YS1maWx0ZXJcIikgPT09IGFycmF5UmVzdWx0WzJdWzFdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2NsZWFuQ2xhc3NGaWx0ZXJBbGwoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fYWRkQ2xhc3NGaWx0ZXIoaXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uY2xvc2VzdChcIi5jYXRhbG9nLWZpbHRlcl9fY29sXCIpLnNldEF0dHJpYnV0ZShcImRhdGEtc29ydFwiLCBhcnJheVJlc3VsdFsxXVsxXSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXJyYXlSZXN1bHRbMV1bMV0gPT09IFwiYXNjXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZChzZWxmLl9zb3J0VHlwZUFzYy5jbGFzcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoc2VsZi5fc29ydFR5cGVEZXNjLmNsYXNzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZShzZWxmLl9zb3J0VHlwZUFzYy5jbGFzcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoc2VsZi5fc29ydFR5cGVEZXNjLmNsYXNzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9maWx0ZXJJdGVtLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLmNsb3Nlc3QoXCIuY2F0YWxvZy1maWx0ZXJfX2NvbFwiKS5nZXRBdHRyaWJ1dGUoXCJkYXRhLWZpbHRlclwiKSA9PT0gXCJuYW1lXCIpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9jbGVhbkNsYXNzRmlsdGVyQWxsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2FkZENsYXNzRmlsdGVyKGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoYXJyYXlSZXN1bHRbM10gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYXJyYXlSZXN1bHRbM11bMV0pO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5zZWFyY2hJdGVtLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaW5wdXRcIilbMF0udmFsdWUgPSBhcnJheVJlc3VsdFszXVsxXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuc2VhcmNoSXRlbS5nZXRFbGVtZW50c0J5VGFnTmFtZShcImlucHV0XCIpWzBdLnZhbHVlID0gXCJcIjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgIGxldCBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgdGhpcy5fZmlsdGVySXRlbS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pe1xyXG4gICAgICAgICAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKHNlbGYuX2FjdGl2ZUNsYXNzKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl90b29nbGVTb3J0KHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL9CS0YvQt9C+0LIg0LzQtdGC0L7QtNCwINGE0L7RgNC80LjRgNC+0LLQsNC90LjRjyBHZXQg0LfQsNC/0YDQvtGB0LBcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fcXVlcnlGb3JtYXRpb24odHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fY2xlYW5DbGFzc0ZpbHRlckFsbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9hZGRDbGFzc0ZpbHRlcih0aGlzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy/QktGL0LfQvtCyINC80LXRgtC+0LTQsCDRhNC+0YDQvNC40YDQvtCy0LDQvdC40Y8gR2V0INC30LDQv9GA0L7RgdCwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3F1ZXJ5Rm9ybWF0aW9uKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX2JyYW5kSXRlbS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuY2xhc3NMaXN0LmNvbnRhaW5zKFwiaXMtYWN0aXZlXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3NlbGVjdEJyYW5kKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL9CS0YvQt9C+0LIg0LzQtdGC0L7QtNCwINGE0L7RgNC80LjRgNC+0LLQsNC90LjRjyBHZXQg0LfQsNC/0YDQvtGB0LBcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fcXVlcnlGb3JtYXRpb24odHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgIHRoaXMuc2VhcmNoSXRlbS5nZXRFbGVtZW50c0J5VGFnTmFtZShcImlucHV0XCIpWzBdLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIC8v0JLRi9C30L7QsiDQvNC10YLQvtC00LAg0YTQvtGA0LzQuNGA0L7QstCw0L3QuNGPIEdldCDQt9Cw0L/RgNC+0YHQsFxyXG4gICAgICAgICAgICAgICAgc2VsZi5fcXVlcnlGb3JtYXRpb24odHJ1ZSwgMTAwMCk7XHJcbiAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICB0aGlzLl9jb250YWluZXJNb3JlLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2F0YWxvZ19fbW9yZS1idXR0b25cIilbMF0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5fcXVlcnlGb3JtYXRpb24oZmFsc2UpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY2xhc3MgSGlzdG9yeUNvbnJ0b2wge1xyXG4gICAgICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgICAgICB0aGlzLl91cmw7XHJcbiAgICAgICAgICAgIHRoaXMuX2hpc3RvcnlPYmogPSB3aW5kb3cuaGlzdG9yeTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuaW5pdCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgc2V0SGlzdG9yeShnZXRRdWVyeSwgYnJhbmQpIHtcclxuICAgICAgICAgICAgaWYgKGJyYW5kID09PSB0aGlzLl9oaXN0b3J5T2JqLnN0YXRlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9oaXN0b3J5T2JqLnJlcGxhY2VTdGF0ZShicmFuZCwgYnJhbmQsIGdldFF1ZXJ5KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2hpc3RvcnlPYmoucHVzaFN0YXRlKGJyYW5kLCBicmFuZCwgZ2V0UXVlcnkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBfcmVhZEhpc3RvcnkoKSB7XHJcbiAgICAgICAgICAgIGxldCB1cmwgPSBkb2N1bWVudC5sb2NhdGlvbi5ocmVmLFxyXG4gICAgICAgICAgICAgICAgYXJyYXlVcmwgPSBkZWNvZGVVUkkodXJsKS5zcGxpdChcIj9cIiksXHJcbiAgICAgICAgICAgICAgICBhcnJheUdldCA9IFtdLFxyXG4gICAgICAgICAgICAgICAgYXJyYXlSZXN1bHQgPSBbXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoYXJyYXlVcmxbMV0gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFycmF5R2V0ID0gYXJyYXlVcmxbMV0uc3BsaXQoXCImXCIpO1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgYXJyYXlHZXQuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFycmF5UmVzdWx0LnB1c2goaXRlbS5zcGxpdChcIj1cIikpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGFycmF5UmVzdWx0KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyLnVwZGF0ZVN0YXRlRmlsdGVyRnJvbVVybChhcnJheVJlc3VsdCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vVG9kbzog0LfQtNC10YHRjCDQvdCw0LTQviDQsdGD0LTQtdGCINGB0LTQtdC70LDRgtGMINCw0LrRgtGD0LDQu9GM0L3Ri9C5INGD0YDQuyDQtNC70Y8gYWpheCDQt9Cw0L/RgNC+0YHQvtCyXHJcbiAgICAgICAgICAgICAgICAgICAgLy8g0J/RgNC40LzQtdGAOiBsZXQgYWpheENvbm5lY3QgPSBuZXcgQWpheEdldFByb2R1Y3RzKHVybCwgXCJnZXRcIiwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGFqYXhDb25uZWN0ID0gbmV3IEFqYXhHZXRQcm9kdWN0cyhcInRlc3QuanNvblwiLCBcImdldFwiLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICBhamF4Q29ubmVjdC5zZW5kKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyLnVwZGF0ZVN0YXRlRmlsdGVyRnJvbVVybChbXSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vVG9kbzog0LfQtNC10YHRjCDQvdCw0LTQviDQsdGD0LTQtdGCINGB0LTQtdC70LDRgtGMINCw0LrRgtGD0LDQu9GM0L3Ri9C5INGD0YDQuyDQtNC70Y8gYWpheCDQt9Cw0L/RgNC+0YHQvtCyXHJcbiAgICAgICAgICAgICAgICAgICAgLy8g0J/RgNC40LzQtdGAOiBsZXQgYWpheENvbm5lY3QgPSBuZXcgQWpheEdldFByb2R1Y3RzKHVybCwgXCJnZXRcIiwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGFqYXhDb25uZWN0ID0gbmV3IEFqYXhHZXRQcm9kdWN0cyhcInRlc3QuanNvblwiLCBcImdldFwiLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICBhamF4Q29ubmVjdC5zZW5kKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpbml0KCkge1xyXG4gICAgICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInBvcHN0YXRlXCIsIHNlbGYuX3JlYWRIaXN0b3J5KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGNsYXNzIEFqYXhHZXRQcm9kdWN0cyB7XHJcbiAgICAgICAgY29uc3RydWN0b3IodXJsLCB0eXBlLCBwcm9kdWN0VXBkYXRlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3VybCA9IHVybDtcclxuICAgICAgICAgICAgdGhpcy5fdHlwZSA9IHR5cGU7XHJcbiAgICAgICAgICAgIHRoaXMuX3Byb2R1Y3RVcGRhdGUgPSBwcm9kdWN0VXBkYXRlO1xyXG4gICAgICAgICAgICB0aGlzLmFqYXggPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIF9wcm9ncmVzcygpIHtcclxuICAgICAgICAgICAgY2F0YWxvZFRlc3QucGxheVByZWxvYWRlcigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgX2NvbXBsZXRlKCkge1xyXG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gSlNPTi5wYXJzZSh0aGlzLnJlc3BvbnNlKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChwcm9kdWN0VXBkYXRlID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXRhbG9kVGVzdC51cGRhdGVUaXRsZShyZXN1bHQudGl0bGUpO1xyXG4gICAgICAgICAgICAgICAgY2F0YWxvZFRlc3QudXBkYXRlTGlzdFByb2R1Y3RzKHJlc3VsdC5lbGVtZW50cyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjYXRhbG9kVGVzdC5hZGRQcm9kdWN0cyhyZXN1bHQuZWxlbWVudHMpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjYXRhbG9kVGVzdC5zdG9wUHJlbG9hZGVyKCk7XHJcblxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIF9jb21wbGV0ZVVwZGF0ZVBycG9kdWN0cygpIHtcclxuICAgICAgICAgICAgbGV0IHJlc3VsdCA9IEpTT04ucGFyc2UodGhpcy5yZXNwb25zZSk7XHJcblxyXG4gICAgICAgICAgICBjYXRhbG9kVGVzdC51cGRhdGVUaXRsZShyZXN1bHQudGl0bGUpO1xyXG4gICAgICAgICAgICBjYXRhbG9kVGVzdC51cGRhdGVMaXN0UHJvZHVjdHMocmVzdWx0LmVsZW1lbnRzKTtcclxuXHJcbiAgICAgICAgICAgIGNhdGFsb2RUZXN0LnN0b3BQcmVsb2FkZXIoKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBfY29tcGxldGVBZGRQcm9kdWN0cygpIHtcclxuICAgICAgICAgICAgbGV0IHJlc3VsdCA9IEpTT04ucGFyc2UodGhpcy5yZXNwb25zZSk7XHJcblxyXG4gICAgICAgICAgICBjYXRhbG9kVGVzdC5hZGRQcm9kdWN0cyhyZXN1bHQuZWxlbWVudHMpO1xyXG5cclxuICAgICAgICAgICAgY2F0YWxvZFRlc3Quc3RvcFByZWxvYWRlcigpO1xyXG5cclxuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBzZW5kKGRhdGEpIHtcclxuICAgICAgICAgICAgbGV0IHByb2R1Y3RVcGRhdGUgPSB0aGlzLl9wcm9kdWN0VXBkYXRlLFxyXG4gICAgICAgICAgICAgICAgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmFqYXguYWRkRXZlbnRMaXN0ZW5lcihcInByb2dyZXNzXCIsIHRoaXMuX3Byb2dyZXNzLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIHRoaXMuYWpheC5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCAoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocHJvZHVjdFVwZGF0ZSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLl9jb21wbGV0ZVVwZGF0ZVBycG9kdWN0cztcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2NvbXBsZXRlQWRkUHJvZHVjdHM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pKCksIGZhbHNlKTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLl90eXBlLnRvTG93ZXJDYXNlKCkgPT09IFwiZ2V0XCIpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLmFqYXgub3Blbih0aGlzLl90eXBlLCB0aGlzLl91cmwpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hamF4LnNlbmQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImdldFwiKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl90eXBlLnRvTG93ZXJDYXNlKCkgPT09IFwicG9zdFwiKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInBvc3RcIik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBsZXQgY2F0YWxvZFRlc3QgPSBuZXcgQ2F0YWxvZyhkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNhdGFsb2dcIilbMF0sIFwiY2F0YWxvZ19fdGl0bGVcIiwgXCJjYXRhbG9nX19wcm9kdWN0XCIsIFwicHJlbG9hZGVyXCIpO1xyXG5cclxuICAgIGxldCBmaWx0ZXIgPSBuZXcgRmlsdGVyKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2F0YWxvZy1uYXZfX2NvbnRyb2xzXCIpWzBdLCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNhdGFsb2ctZmlsdGVyXCIpWzBdLCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNhdGFsb2dfX21vcmVcIilbMF0pO1xyXG5cclxuICAgIGxldCBoaXN0b3J5T2JqID0gbmV3IEhpc3RvcnlDb25ydG9sKCk7XHJcblxyXG4gICAgLy/QotC10YHRglxyXG4gICAgLy8gd2luZG93LmRpdkFycmF5ID0gZGl2QXJyYXk7XHJcbiAgICB3aW5kb3cuZmlsdGVyID0gZmlsdGVyO1xyXG59KSgpO1xyXG4iLCI7KGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIGJ1dHRvbiA9ICQoJy5mb290ZXJfX2NvbC10aXRsZScpO1xyXG5cclxuICAgIGJ1dHRvbi5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICQodGhpcykuY2xvc2VzdCgnLmZvb3Rlcl9fY29sJykuZmluZCgnLmZvb3Rlcl9fY29sLWxpc3QnKS5zbGlkZVRvZ2dsZSgzMDApO1xyXG4gICAgfSk7XHJcbn0pKCk7XHJcbiIsIjsoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgaWYgKCQoJy5jYXRhbG9nLW5hdl9fY29udHJvbHMnKS5sZW5ndGgpIHtcclxuXHJcbiAgICAgICAgICAgIHZhciBtZW51TGluayA9ICQoJy5jYXRhbG9nLW5hdl9fY29udHJvbHMtbGluaycpLFxyXG4gICAgICAgICAgICAgICAgbWVudSA9ICQoJy5jYXRhbG9nLW5hdl9fY29udHJvbHMtbGlzdCcpO1xyXG5cclxuICAgICAgICAgICAgdmFyIG1lbnVJdGVtID0gJCgnLmNhdGFsb2ctbmF2X19jb250cm9scy1pdGVtJyksXHJcbiAgICAgICAgICAgICAgICBhY3RpdmVMaW5rID0gJCgnLmNhdGFsb2ctbmF2X19jb250cm9scy1saW5rLmlzLWFjdGl2ZScpLFxyXG4gICAgICAgICAgICAgICAgaG92ZXJCb3ggPSAkKCcuY2F0YWxvZy1uYXZfX2hvdmVyJyksXHJcbiAgICAgICAgICAgICAgICBhY3RpdmVMaW5rUG9zTGVmdCA9IGFjdGl2ZUxpbmsucG9zaXRpb24oKS5sZWZ0LFxyXG4gICAgICAgICAgICAgICAgYWN0aXZlTGlua1Bvc1RvcCA9IGFjdGl2ZUxpbmsucG9zaXRpb24oKS50b3AsXHJcbiAgICAgICAgICAgICAgICBhY3RpdmVMaW5rV2lkdGggPSBhY3RpdmVMaW5rLmlubmVyV2lkdGgoKSxcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUxpbmtIZWlnaHQgPSBhY3RpdmVMaW5rLmlubmVySGVpZ2h0KCk7XHJcblxyXG4gICAgICAgICAgICB2YXIgY2hlY2sgPSBmYWxzZTtcclxuICAgICAgICAgICAgbWVudUxpbmsuaG92ZXIoXHJcbiAgICAgICAgICAgICAgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbmV3TGlua1Bvc0xlZnQgPSAkKHRoaXMpLnBvc2l0aW9uKCkubGVmdCxcclxuICAgICAgICAgICAgICAgICAgICBuZXdMaW5rUG9zVG9wID0gJCh0aGlzKS5wb3NpdGlvbigpLnRvcCxcclxuICAgICAgICAgICAgICAgICAgICBuZXdMaW5rV2lkdGggPSAkKHRoaXMpLmlubmVyV2lkdGgoKSxcclxuICAgICAgICAgICAgICAgICAgICBuZXdMaW5rSGVpZ2h0ID0gJCh0aGlzKS5pbm5lckhlaWdodCgpO1xyXG4gICAgICAgICAgICAgICAgaG92ZXJCb3guY3NzKHsnbGVmdCcgOiBuZXdMaW5rUG9zTGVmdCwgJ3RvcCcgOiBuZXdMaW5rUG9zVG9wLCAnd2lkdGgnIDogbmV3TGlua1dpZHRoLCAnaGVpZ2h0JyA6IG5ld0xpbmtIZWlnaHR9KTtcclxuICAgICAgICAgICAgICAgIGNoZWNrID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgIGlmIChjaGVjaykge1xyXG4gICAgICAgICAgICAgICAgICAgIGhvdmVyQm94LmNzcyh7J2xlZnQnIDogYWN0aXZlTGlua1Bvc0xlZnQsICd0b3AnIDogYWN0aXZlTGlua1Bvc1RvcCwgJ3dpZHRoJyA6IDAsICdoZWlnaHQnIDogMH0pO1xyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgICAgICAgICAgIGNoZWNrID0gdHJ1ZTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiByZXNpemVQb3MoKSB7XHJcbiAgICAgICAgICAgICAgICBhY3RpdmVMaW5rUG9zTGVmdCA9IGFjdGl2ZUxpbmsucG9zaXRpb24oKS5sZWZ0LFxyXG4gICAgICAgICAgICAgICAgYWN0aXZlTGlua1Bvc1RvcCA9IGFjdGl2ZUxpbmsucG9zaXRpb24oKS50b3AsXHJcbiAgICAgICAgICAgICAgICBhY3RpdmVMaW5rV2lkdGggPSBhY3RpdmVMaW5rLmlubmVyV2lkdGgoKSxcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUxpbmtIZWlnaHQgPSBhY3RpdmVMaW5rLmlubmVySGVpZ2h0KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaG92ZXJCb3guY3NzKHsnbGVmdCcgOiBhY3RpdmVMaW5rUG9zTGVmdCwgJ3RvcCcgOiBhY3RpdmVMaW5rUG9zVG9wLCAnd2lkdGgnIDogMCwgJ2hlaWdodCcgOiAwfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICQod2luZG93KS5yZXNpemUoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICByZXNpemVQb3MoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJlc2l6ZVBvcygpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuXHJcbn0pKCk7XHJcbiIsIjsoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgJCgnLmRlbGl2ZXJ5X19mb3JtLWlucHV0JykuZm9jdXNvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgIGlmICgkKHRoaXMpLnZhbCgpICE9PSAnJykge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmFkZENsYXNzKCd2YWx1ZScpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkucmVtb3ZlQ2xhc3MoJ3ZhbHVlJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfSk7XHJcblxyXG59KSgpO1xyXG4iLCI7KGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIGxldCBzY2VuZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY2VuZScpO1xyXG4gICAgaWYgKHNjZW5lICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIGxldCBwYXJhbGxheEluc3RhbmNlID0gbmV3IFBhcmFsbGF4KHNjZW5lKTtcclxuICAgIH1cclxuXHJcbn0pKCk7XHJcbiIsIjsoZnVuY3Rpb24oKSB7XHJcbiAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLnNsaWRlLWluZm9fX2J1dHRvbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICQodGhpcykuY2xvc2VzdCgnLnNsaWRlLWluZm8nKS5maW5kKCcuc2xpZGUtaW5mb19fYnV0dG9uJykudG9nZ2xlQ2xhc3MoJ2lzLWFjdGl2ZScpO1xyXG4gICAgICAgICQodGhpcykuY2xvc2VzdCgnLnNsaWRlLWluZm8nKS5maW5kKCcuc2xpZGUtaW5mb19fY29udGVudCcpLnNsaWRlVG9nZ2xlKDMwMCk7XHJcbiAgICB9KTtcclxufSkoKTtcclxuIl19
