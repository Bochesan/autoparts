"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,s){return e&&_defineProperties(t.prototype,e),s&&_defineProperties(t,s),t}$(document).on("click",".product-row__button",function(){$(this).hasClass("animate")||($(this).addClass("animate"),$(this).addClass("button--check"),setTimeout(function(){$(this).removeClass("button--check"),$(this).removeClass("animate")}.bind(this),2e3))}),window.addEventListener("load",function(){$(".hr-sect").length&&$(".hr-pagination__step").click(function(){var t=$(this);if(!t.hasClass("is-active")){t.closest(".hr-sect").find(".hr-pagination__step").removeClass("is-active").removeClass("button"),t.addClass("is-active").addClass("button"),t.attr("data-index");var e=t.closest(".hr-sect").find(".hr-slider-slide");e.removeClass("is-active"),e.each(function(t,e){$(this).attr("data-index")==$(".hr-pagination__step.is-active").attr("data-index")&&$(this).addClass("is-active")})}})}),function(){var t=document.getElementById("menu-button");t.addEventListener("click",function(){t.classList.toggle("opened")}),window.onresize=function(){t.classList.remove("opened")},window.onscroll=function(){t.classList.remove("opened")}}(),function(){var t=function(){function a(t,e,s,i){if(_classCallCheck(this,a),void 0===t)return!1;this._self=t,this._title=this._self.querySelectorAll("."+e)[0],this._products=this._self.querySelectorAll("."+s)[0],this.preloader=this._self.querySelectorAll("."+i)[0]}return _createClass(a,[{key:"_cleanProducts",value:function(){this._products.innerHTML=""}},{key:"playPreloader",value:function(){this.preloader.classList.add("preloader--active")}},{key:"stopPreloader",value:function(){this.preloader.classList.remove("preloader--active")}},{key:"updateTitle",value:function(t){this._title.innerHTML=t}},{key:"updateListProducts",value:function(t){this._products.innerHTML=t}},{key:"addProducts",value:function(t){this._products.insertAdjacentHTML("beforeend",t)}}]),a}(),e=function(){function s(t,e){return _classCallCheck(this,s),void 0!==t&&(void 0!==e&&(this._containerBrands=t,this._brandItem=this._containerBrands.querySelectorAll(".catalog-nav__controls-link"),this._containerFilter=e,this._filterItem=this._containerFilter.querySelectorAll(".catalog-filter__col-btn"),this.searchItem=this._containerFilter.querySelectorAll(".catalog-filter__form")[0],this._activeClass="is-active",this._sortTypeAsc={class:"sort-down",dataSort:"asc"},this._sortTypeDesc={class:"sort-up",dataSort:"desc"},this.timeOutAjax,void this.init()))}return _createClass(s,[{key:"_cleanClassFilterAll",value:function(){var s=this;this._filterItem.forEach(function(t){var e=t.closest(".catalog-filter__col");t.classList.remove(s._activeClass),t.classList.remove(s._sortTypeAsc.class),e.removeAttribute("data-sort")})}},{key:"_addClassFilter",value:function(t){var e=t.closest(".catalog-filter__col");t.classList.add(this._activeClass),t.classList.add(this._sortTypeAsc.class),e.setAttribute("data-sort",this._sortTypeAsc.dataSort)}},{key:"_toogleSort",value:function(t){var e=t.closest(".catalog-filter__col");t.classList.contains(this._sortTypeAsc.class)?(t.classList.remove(this._sortTypeAsc.class),t.classList.add(this._sortTypeDesc.class),e.setAttribute("data-sort",this._sortTypeDesc.dataSort)):(t.classList.remove(this._sortTypeDesc.class),t.classList.add(this._sortTypeAsc.class),e.setAttribute("data-sort",this._sortTypeAsc.dataSort))}},{key:"_selectBrand",value:function(t){t.classList.contains("is-active")||(this._brandItem.forEach(function(t){t.classList.remove("is-active")}),t.classList.add("is-active"))}},{key:"_queryFormation",value:function(t){clearTimeout(this.timeOutAjax);var e,s,i=[],a=this.searchItem.getElementsByTagName("input")[0];this._brandItem.forEach(function(t){t.classList.contains("is-active")&&(i.push("brand="+t.getAttribute("data-brand")),e=t.getAttribute("data-brand"))}),this._filterItem.forEach(function(t){var e=t.closest(".catalog-filter__col");t.classList.contains("is-active")&&(i.push("sort="+e.getAttribute("data-sort")),i.push("sortType="+e.getAttribute("data-filter")))}),""!==a.value&&i.push("search="+a.value),s="?"+i.join("&"),new n(s).setHistory(e);var o=new l("test.json","get");void 0===t?o.send():(r.playPreloader(),this.timeOutAjax=setTimeout(function(){o.send()},t)),console.log(s)}},{key:"init",value:function(){var e=this;this._filterItem.forEach(function(t){t.addEventListener("click",function(){t.classList.contains(e._activeClass)?e._toogleSort(this):(e._cleanClassFilterAll(),e._addClassFilter(this)),e._queryFormation()})}),this._brandItem.forEach(function(t){t.addEventListener("click",function(t){t.preventDefault(),this.classList.contains("is-active")||(e._selectBrand(this),e._queryFormation())})}),this.searchItem.getElementsByTagName("input")[0].addEventListener("input",function(){e._queryFormation(1e3)})}}]),s}(),n=function(){function e(t){_classCallCheck(this,e),this._url=t,this._historyObj=window.history}return _createClass(e,[{key:"setHistory",value:function(t){t===this._historyObj.state?this._historyObj.replaceState(t,t,this._url):this._historyObj.pushState(t,t,this._url)}},{key:"readHistory",value:function(t){}}]),e}(),l=function(){function s(t,e){_classCallCheck(this,s),this._url=t,this._type=e,this.ajax=new XMLHttpRequest}return _createClass(s,[{key:"_progress",value:function(){r.playPreloader()}},{key:"_complete",value:function(){var t=JSON.parse(this.response);r.updateTitle(t.title),r.updateListProducts(t.elements),r.stopPreloader(),console.log(t)}},{key:"send",value:function(t){this.ajax.addEventListener("progress",this._progress,!1),this.ajax.addEventListener("load",this._complete,!1),"get"===this._type.toLowerCase()?(this.ajax.open(this._type,this._url),this.ajax.send(),console.log("get")):"post"===this._type.toLowerCase()?console.log("post"):console.log("Error")}}]),s}(),r=new t(document.querySelectorAll(".catalog")[0],"catalog__title","catalog__product","preloader"),s=new e(document.querySelectorAll(".catalog-nav__controls")[0],document.querySelectorAll(".catalog-filter")[0]);window.filter=s}(),$(".footer__col-title").on("click",function(t){t.preventDefault(),$(this).closest(".footer__col").find(".footer__col-list").slideToggle(300)}),window.addEventListener("load",function(){if($(".catalog-nav__controls").length){var t=function(){i=s.position().left,o=s.position().top,s.innerWidth(),s.innerHeight(),a.css({left:i,top:o,width:0,height:0})},e=$(".catalog-nav__controls-link"),s=($(".catalog-nav__controls-list"),$(".catalog-nav__controls-item"),$(".catalog-nav__controls-link.is-active")),a=$(".catalog-nav__hover"),i=s.position().left,o=s.position().top,n=(s.innerWidth(),s.innerHeight(),!1);e.hover(function(){var t=$(this).position().left,e=$(this).position().top,s=$(this).innerWidth(),i=$(this).innerHeight();a.css({left:t,top:e,width:s,height:i}),n=!1},function(){setTimeout(function(){n&&a.css({left:i,top:o,width:0,height:0})},1e3),n=!0}),$(window).resize(function(){t()}),t()}}),window.addEventListener("load",function(){$(".delivery__form-input").focusout(function(){""!==$(this).val()?$(this).parent().addClass("value"):$(this).parent().removeClass("value")})}),function(){var t=document.getElementById("scene");if(null!=t)new Parallax(t)}(),$(document).on("click",".slide-info__button",function(){$(this).closest(".slide-info").find(".slide-info__button").toggleClass("is-active"),$(this).closest(".slide-info").find(".slide-info__content").slideToggle(300)});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkZFRvQmFza2V0LmpzIiwiYmFza2V0VGFicy5qcyIsImJ1cmdlci5qcyIsImNhdGFsb2dVcGRhdGVDbGFzcy5qcyIsImZvb3Rlck1lbnUuanMiLCJob3ZlclJvbGxlci5qcyIsImxhYmVsRm9ybS5qcyIsInBhcmFsbGF4LmpzIiwic2hvd01vcmUuanMiXSwibmFtZXMiOlsiJCIsImRvY3VtZW50Iiwib24iLCJ0aGlzIiwiaGFzQ2xhc3MiLCJhZGRDbGFzcyIsInNldFRpbWVvdXQiLCJyZW1vdmVDbGFzcyIsImJpbmQiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwibGVuZ3RoIiwiY2xpY2siLCJ0aFN0ZXAiLCJjbG9zZXN0IiwiZmluZCIsImF0dHIiLCJzbGlkZXJTbGlkZXMiLCJlYWNoIiwicGFnaUluZGV4IiwibWVudUJ0biIsImdldEVsZW1lbnRCeUlkIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwib25yZXNpemUiLCJyZW1vdmUiLCJvbnNjcm9sbCIsIkNhdGFsb2ciLCJzZWxmIiwidGl0bGVDbGFzcyIsInByb2R1Y3RzQ29udGFpbmVyQ2xhc3MiLCJwcm9kdWN0c1ByZWxvYWRlckNsYXNzIiwiX2NsYXNzQ2FsbENoZWNrIiwidW5kZWZpbmVkIiwiX3NlbGYiLCJfdGl0bGUiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3Byb2R1Y3RzIiwicHJlbG9hZGVyIiwiX2NyZWF0ZUNsYXNzIiwia2V5IiwidmFsdWUiLCJpbm5lckhUTUwiLCJhZGQiLCJ0aXRsZSIsInByb2R1Y3RzIiwiaW5zZXJ0QWRqYWNlbnRIVE1MIiwiRmlsdGVyIiwiY29udGFpbmVyQnJhbmRzIiwiY29udGFpbmVyRmlsdGVyIiwiX2NvbnRhaW5lckJyYW5kcyIsIl9icmFuZEl0ZW0iLCJfY29udGFpbmVyRmlsdGVyIiwiX2ZpbHRlckl0ZW0iLCJzZWFyY2hJdGVtIiwiX2FjdGl2ZUNsYXNzIiwiX3NvcnRUeXBlQXNjIiwiY2xhc3MiLCJkYXRhU29ydCIsIl9zb3J0VHlwZURlc2MiLCJ0aW1lT3V0QWpheCIsImluaXQiLCJmb3JFYWNoIiwiaXRlbSIsInBhcmVudCIsInJlbW92ZUF0dHJpYnV0ZSIsInNldEF0dHJpYnV0ZSIsImNvbnRhaW5zIiwiZGVsYXkiLCJjbGVhclRpbWVvdXQiLCJicmFuZCIsImdldFF1ZXJ5IiwiYXJyYXlRdWVyeSIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwicHVzaCIsImdldEF0dHJpYnV0ZSIsImpvaW4iLCJIaXN0b3J5Q29ucnRvbCIsInNldEhpc3RvcnkiLCJhamF4Q29ubmVjdCIsIkFqYXhHZXRQcm9kdWN0cyIsInNlbmQiLCJjYXRhbG9kVGVzdCIsInBsYXlQcmVsb2FkZXIiLCJjb25zb2xlIiwibG9nIiwiX3Rvb2dsZVNvcnQiLCJfY2xlYW5DbGFzc0ZpbHRlckFsbCIsIl9hZGRDbGFzc0ZpbHRlciIsIl9xdWVyeUZvcm1hdGlvbiIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJfc2VsZWN0QnJhbmQiLCJ1cmwiLCJfdXJsIiwiX2hpc3RvcnlPYmoiLCJoaXN0b3J5Iiwic3RhdGUiLCJyZXBsYWNlU3RhdGUiLCJwdXNoU3RhdGUiLCJ0eXBlIiwiX3R5cGUiLCJhamF4IiwiWE1MSHR0cFJlcXVlc3QiLCJyZXN1bHQiLCJKU09OIiwicGFyc2UiLCJyZXNwb25zZSIsInVwZGF0ZVRpdGxlIiwidXBkYXRlTGlzdFByb2R1Y3RzIiwiZWxlbWVudHMiLCJzdG9wUHJlbG9hZGVyIiwiZGF0YSIsIl9wcm9ncmVzcyIsIl9jb21wbGV0ZSIsInRvTG93ZXJDYXNlIiwib3BlbiIsImZpbHRlciIsImUiLCJzbGlkZVRvZ2dsZSIsInJlc2l6ZVBvcyIsImFjdGl2ZUxpbmtQb3NMZWZ0IiwiYWN0aXZlTGluayIsInBvc2l0aW9uIiwibGVmdCIsImFjdGl2ZUxpbmtQb3NUb3AiLCJ0b3AiLCJpbm5lcldpZHRoIiwiaW5uZXJIZWlnaHQiLCJob3ZlckJveCIsImNzcyIsIndpZHRoIiwiaGVpZ2h0IiwibWVudUxpbmsiLCJjaGVjayIsImhvdmVyIiwibmV3TGlua1Bvc0xlZnQiLCJuZXdMaW5rUG9zVG9wIiwibmV3TGlua1dpZHRoIiwibmV3TGlua0hlaWdodCIsInJlc2l6ZSIsImZvY3Vzb3V0IiwidmFsIiwic2NlbmUiLCJQYXJhbGxheCIsInRvZ2dsZUNsYXNzIl0sIm1hcHBpbmdzIjoibVpBQ0lBLEVBQUVDLFVBQVVDLEdBQUcsUUFBUyx1QkFBd0IsV0FDdkNGLEVBQUVHLE1BQU1DLFNBQVMsYUFDbEJKLEVBQUVHLE1BQU1FLFNBQVMsV0FDakJMLEVBQUVHLE1BQU1FLFNBQVMsaUJBQ2pCQyxXQUFXLFdBQ1BOLEVBQUVHLE1BQU1JLFlBQVksaUJBQ3BCUCxFQUFFRyxNQUFNSSxZQUFZLFlBQ3RCQyxLQUFLTCxNQUFPLFFDTnRCTSxPQUFPQyxpQkFBaUIsT0FBUSxXQUV4QlYsRUFBRSxZQUFZVyxRQUVkWCxFQUFFLHdCQUF3QlksTUFBTSxXQUM1QixJQUFJQyxFQUFTYixFQUFFRyxNQUNmLElBQUtVLEVBQU9ULFNBQVMsYUFBYyxDQUMvQlMsRUFBT0MsUUFBUSxZQUFZQyxLQUFLLHdCQUF3QlIsWUFBWSxhQUFhQSxZQUFZLFVBQzdGTSxFQUFPUixTQUFTLGFBQWFBLFNBQVMsVUFDdEJRLEVBQU9HLEtBQUssY0FBNUIsSUFFSUMsRUFBZUosRUFBT0MsUUFBUSxZQUFZQyxLQUFLLG9CQUNuREUsRUFBYVYsWUFBWSxhQUN6QlUsRUFBYUMsS0FBSyxTQUFTQyxFQUFXTixHQUM5QmIsRUFBRUcsTUFBTWEsS0FBSyxlQUFpQmhCLEVBQUUsa0NBQWtDZ0IsS0FBSyxlQUN2RWhCLEVBQUVHLE1BQU1FLFNBQVMsb0JDakI1QyxXQUNHLElBQUllLEVBQVVuQixTQUFTb0IsZUFBZSxlQUV0Q0QsRUFBUVYsaUJBQWlCLFFBQVMsV0FDOUJVLEVBQVFFLFVBQVVDLE9BQU8sWUFHN0JkLE9BQU9lLFNBQVcsV0FDZEosRUFBUUUsVUFBVUcsT0FBTyxXQUU3QmhCLE9BQU9pQixTQUFXLFdBQ2ROLEVBQVFFLFVBQVVHLE9BQU8sV0FYaEMsR0NBQSxXQUFXLElBRUZFLEVBRkUsV0FHSixTQUFB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RixFQUFFRyxNQUFNVyxRQUFRLGVBQWVDLEtBQUssdUJBQXVCa0ksWUFBWSxhQUN2RWpKLEVBQUVHLE1BQU1XLFFBQVEsZUFBZUMsS0FBSyx3QkFBd0J3RyxZQUFZIiwiZmlsZSI6Im1haW4ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiOyhmdW5jdGlvbigpIHtcclxuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcucHJvZHVjdC1yb3dfX2J1dHRvbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICghJCh0aGlzKS5oYXNDbGFzcygnYW5pbWF0ZScpKSB7XHJcbiAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2FuaW1hdGUnKTtcclxuICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcyhcImJ1dHRvbi0tY2hlY2tcIik7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKFwiYnV0dG9uLS1jaGVja1wiKTtcclxuICAgICAgICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ2FuaW1hdGUnKTtcclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpLCAyMDAwKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufSkoKTtcclxuIiwiOyhmdW5jdGlvbigpIHtcclxuXHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICBpZiAoJCgnLmhyLXNlY3QnKS5sZW5ndGgpIHtcclxuXHJcbiAgICAgICAgICAgICQoXCIuaHItcGFnaW5hdGlvbl9fc3RlcFwiKS5jbGljayhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0aFN0ZXAgPSAkKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aFN0ZXAuaGFzQ2xhc3MoXCJpcy1hY3RpdmVcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aFN0ZXAuY2xvc2VzdCgnLmhyLXNlY3QnKS5maW5kKFwiLmhyLXBhZ2luYXRpb25fX3N0ZXBcIikucmVtb3ZlQ2xhc3MoXCJpcy1hY3RpdmVcIikucmVtb3ZlQ2xhc3MoXCJidXR0b25cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhTdGVwLmFkZENsYXNzKFwiaXMtYWN0aXZlXCIpLmFkZENsYXNzKFwiYnV0dG9uXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwYWdpSW5kZXggPSB0aFN0ZXAuYXR0cihcImRhdGEtaW5kZXhcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzbGlkZXJTbGlkZXMgPSB0aFN0ZXAuY2xvc2VzdChcIi5oci1zZWN0XCIpLmZpbmQoXCIuaHItc2xpZGVyLXNsaWRlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNsaWRlclNsaWRlcy5yZW1vdmVDbGFzcyhcImlzLWFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICBzbGlkZXJTbGlkZXMuZWFjaChmdW5jdGlvbihwYWdpSW5kZXgsIHRoU3RlcCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJCh0aGlzKS5hdHRyKFwiZGF0YS1pbmRleFwiKSA9PSAkKFwiLmhyLXBhZ2luYXRpb25fX3N0ZXAuaXMtYWN0aXZlXCIpLmF0dHIoXCJkYXRhLWluZGV4XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKFwiaXMtYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgfSk7XHJcblxyXG59KSgpO1xyXG4iLCI7KGZ1bmN0aW9uKCkge1xyXG4gICAgbGV0IG1lbnVCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWVudS1idXR0b24nKTtcclxuXHJcbiAgICBtZW51QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbWVudUJ0bi5jbGFzc0xpc3QudG9nZ2xlKCdvcGVuZWQnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHdpbmRvdy5vbnJlc2l6ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIG1lbnVCdG4uY2xhc3NMaXN0LnJlbW92ZSgnb3BlbmVkJyk7XHJcbiAgICB9XHJcbiAgICB3aW5kb3cub25zY3JvbGwgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBtZW51QnRuLmNsYXNzTGlzdC5yZW1vdmUoJ29wZW5lZCcpO1xyXG4gICAgfVxyXG59KSgpO1xyXG4iLCI7KGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgY2xhc3MgQ2F0YWxvZyB7XHJcbiAgICAgICAgY29uc3RydWN0b3Ioc2VsZiwgdGl0bGVDbGFzcywgcHJvZHVjdHNDb250YWluZXJDbGFzcywgcHJvZHVjdHNQcmVsb2FkZXJDbGFzcyl7XHJcbiAgICAgICAgICAgIGlmIChzZWxmID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLl9zZWxmID0gc2VsZjtcclxuICAgICAgICAgICAgdGhpcy5fdGl0bGUgPSB0aGlzLl9zZWxmLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuXCIgKyB0aXRsZUNsYXNzKVswXTtcclxuICAgICAgICAgICAgdGhpcy5fcHJvZHVjdHMgPSB0aGlzLl9zZWxmLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuXCIgKyBwcm9kdWN0c0NvbnRhaW5lckNsYXNzKVswXTtcclxuICAgICAgICAgICAgdGhpcy5wcmVsb2FkZXIgPSB0aGlzLl9zZWxmLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuXCIgKyBwcm9kdWN0c1ByZWxvYWRlckNsYXNzKVswXTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBfY2xlYW5Qcm9kdWN0cygpIHtcclxuICAgICAgICAgICAgdGhpcy5fcHJvZHVjdHMuaW5uZXJIVE1MID0gXCJcIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHBsYXlQcmVsb2FkZXIoKSB7XHJcbiAgICAgICAgICAgIHRoaXMucHJlbG9hZGVyLmNsYXNzTGlzdC5hZGQoXCJwcmVsb2FkZXItLWFjdGl2ZVwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHN0b3BQcmVsb2FkZXIoKSB7XHJcbiAgICAgICAgICAgIHRoaXMucHJlbG9hZGVyLmNsYXNzTGlzdC5yZW1vdmUoXCJwcmVsb2FkZXItLWFjdGl2ZVwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHVwZGF0ZVRpdGxlKHRpdGxlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3RpdGxlLmlubmVySFRNTCA9IHRpdGxlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdXBkYXRlTGlzdFByb2R1Y3RzKHByb2R1Y3RzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Byb2R1Y3RzLmlubmVySFRNTCA9IHByb2R1Y3RzO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYWRkUHJvZHVjdHMocHJvZHVjdHMpIHtcclxuICAgICAgICAgICAgdGhpcy5fcHJvZHVjdHMuaW5zZXJ0QWRqYWNlbnRIVE1MKFwiYmVmb3JlZW5kXCIsIHByb2R1Y3RzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY2xhc3MgRmlsdGVyIHtcclxuICAgICAgICBjb25zdHJ1Y3Rvcihjb250YWluZXJCcmFuZHMsIGNvbnRhaW5lckZpbHRlcikge1xyXG4gICAgICAgICAgICBpZiAoY29udGFpbmVyQnJhbmRzID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoY29udGFpbmVyRmlsdGVyID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5fY29udGFpbmVyQnJhbmRzID0gY29udGFpbmVyQnJhbmRzO1xyXG4gICAgICAgICAgICB0aGlzLl9icmFuZEl0ZW0gPSB0aGlzLl9jb250YWluZXJCcmFuZHMucXVlcnlTZWxlY3RvckFsbChcIi5jYXRhbG9nLW5hdl9fY29udHJvbHMtbGlua1wiKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX2NvbnRhaW5lckZpbHRlciA9IGNvbnRhaW5lckZpbHRlcjtcclxuICAgICAgICAgICAgdGhpcy5fZmlsdGVySXRlbSA9IHRoaXMuX2NvbnRhaW5lckZpbHRlci5xdWVyeVNlbGVjdG9yQWxsKFwiLmNhdGFsb2ctZmlsdGVyX19jb2wtYnRuXCIpO1xyXG4gICAgICAgICAgICB0aGlzLnNlYXJjaEl0ZW0gPSB0aGlzLl9jb250YWluZXJGaWx0ZXIucXVlcnlTZWxlY3RvckFsbChcIi5jYXRhbG9nLWZpbHRlcl9fZm9ybVwiKVswXTtcclxuICAgICAgICAgICAgdGhpcy5fYWN0aXZlQ2xhc3MgPSBcImlzLWFjdGl2ZVwiO1xyXG4gICAgICAgICAgICB0aGlzLl9zb3J0VHlwZUFzYyA9IHtcclxuICAgICAgICAgICAgICAgIGNsYXNzOiBcInNvcnQtZG93blwiLFxyXG4gICAgICAgICAgICAgICAgZGF0YVNvcnQ6IFwiYXNjXCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdGhpcy5fc29ydFR5cGVEZXNjID0ge1xyXG4gICAgICAgICAgICAgICAgY2xhc3M6IFwic29ydC11cFwiLFxyXG4gICAgICAgICAgICAgICAgZGF0YVNvcnQ6IFwiZGVzY1wiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMudGltZU91dEFqYXg7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgX2NsZWFuQ2xhc3NGaWx0ZXJBbGwoKSB7XHJcbiAgICAgICAgICAgIGxldCBzZWxmID0gdGhpcztcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX2ZpbHRlckl0ZW0uZm9yRWFjaChmdW5jdGlvbihpdGVtKXtcclxuICAgICAgICAgICAgICAgIGxldCBwYXJlbnQgPSBpdGVtLmNsb3Nlc3QoXCIuY2F0YWxvZy1maWx0ZXJfX2NvbFwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKHNlbGYuX2FjdGl2ZUNsYXNzKTtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoc2VsZi5fc29ydFR5cGVBc2MuY2xhc3MpO1xyXG4gICAgICAgICAgICAgICAgICAgIHBhcmVudC5yZW1vdmVBdHRyaWJ1dGUoXCJkYXRhLXNvcnRcIik7XHJcblxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIF9hZGRDbGFzc0ZpbHRlcihpdGVtKSB7XHJcbiAgICAgICAgICAgIGxldCBwYXJlbnQgPSBpdGVtLmNsb3Nlc3QoXCIuY2F0YWxvZy1maWx0ZXJfX2NvbFwiKTtcclxuXHJcbiAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZCh0aGlzLl9hY3RpdmVDbGFzcyk7XHJcbiAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZCh0aGlzLl9zb3J0VHlwZUFzYy5jbGFzcyk7XHJcblxyXG4gICAgICAgICAgICBwYXJlbnQuc2V0QXR0cmlidXRlKFwiZGF0YS1zb3J0XCIsIHRoaXMuX3NvcnRUeXBlQXNjLmRhdGFTb3J0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIF90b29nbGVTb3J0KGl0ZW0pIHtcclxuICAgICAgICAgICAgbGV0IHBhcmVudCA9IGl0ZW0uY2xvc2VzdChcIi5jYXRhbG9nLWZpbHRlcl9fY29sXCIpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKHRoaXMuX3NvcnRUeXBlQXNjLmNsYXNzKSkge1xyXG4gICAgICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NvcnRUeXBlQXNjLmNsYXNzKTtcclxuICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZCh0aGlzLl9zb3J0VHlwZURlc2MuY2xhc3MpO1xyXG5cclxuICAgICAgICAgICAgICAgIHBhcmVudC5zZXRBdHRyaWJ1dGUoXCJkYXRhLXNvcnRcIiwgdGhpcy5fc29ydFR5cGVEZXNjLmRhdGFTb3J0KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zb3J0VHlwZURlc2MuY2xhc3MpO1xyXG4gICAgICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKHRoaXMuX3NvcnRUeXBlQXNjLmNsYXNzKTtcclxuXHJcbiAgICAgICAgICAgICAgICBwYXJlbnQuc2V0QXR0cmlidXRlKFwiZGF0YS1zb3J0XCIsIHRoaXMuX3NvcnRUeXBlQXNjLmRhdGFTb3J0KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIF9zZWxlY3RCcmFuZChpdGVtKSB7XHJcbiAgICAgICAgICAgIGlmICghaXRlbS5jbGFzc0xpc3QuY29udGFpbnMoXCJpcy1hY3RpdmVcIikpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYnJhbmRJdGVtLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZShcImlzLWFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKFwiaXMtYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBfcXVlcnlGb3JtYXRpb24oZGVsYXkpIHtcclxuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZU91dEFqYXgpO1xyXG4gICAgICAgICAgICAvL9Cc0LXRgtC+0LQg0YTQvtGA0LzQuNGA0L7QstCw0L3QuNGPIGdldCDQt9Cw0L/RgNC+0YHQsFxyXG4gICAgICAgICAgICBsZXQgYXJyYXlRdWVyeSA9IFtdLFxyXG4gICAgICAgICAgICAgICAgc2VhcmNoSXRlbSA9IHRoaXMuc2VhcmNoSXRlbS5nZXRFbGVtZW50c0J5VGFnTmFtZShcImlucHV0XCIpWzBdLFxyXG4gICAgICAgICAgICAgICAgYnJhbmQsXHJcbiAgICAgICAgICAgICAgICBnZXRRdWVyeTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX2JyYW5kSXRlbS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIGlmIChpdGVtLmNsYXNzTGlzdC5jb250YWlucyhcImlzLWFjdGl2ZVwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFycmF5UXVlcnkucHVzaChcImJyYW5kPVwiICsgaXRlbS5nZXRBdHRyaWJ1dGUoXCJkYXRhLWJyYW5kXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICBicmFuZCA9IGl0ZW0uZ2V0QXR0cmlidXRlKFwiZGF0YS1icmFuZFwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9maWx0ZXJJdGVtLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHBhcmVudCA9IGl0ZW0uY2xvc2VzdChcIi5jYXRhbG9nLWZpbHRlcl9fY29sXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKFwiaXMtYWN0aXZlXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXJyYXlRdWVyeS5wdXNoKFwic29ydD1cIiArIHBhcmVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXNvcnRcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgIGFycmF5UXVlcnkucHVzaChcInNvcnRUeXBlPVwiICsgcGFyZW50LmdldEF0dHJpYnV0ZShcImRhdGEtZmlsdGVyXCIpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2VhcmNoSXRlbS52YWx1ZSAhPT0gXCJcIikge1xyXG4gICAgICAgICAgICAgICAgYXJyYXlRdWVyeS5wdXNoKFwic2VhcmNoPVwiICsgc2VhcmNoSXRlbS52YWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldFF1ZXJ5ID0gXCI/XCIgKyBhcnJheVF1ZXJ5LmpvaW4oXCImXCIpO1xyXG5cclxuICAgICAgICAgICAgLy9Ub2RvOiDQt9C00LXRgdGMINC00L7Qu9C20LXQvSDQstGL0LfRi9Cy0LDRgtGM0YHRjyBhamF4INC4INC/0YDQuNC90LjQvNCw0YLRjCBnZXQg0YHRgtGA0L7QutGDXHJcbiAgICAgICAgICAgIC8vVG9kbzog0LfQtNC10YHRjCDQtNC+0LvQttC10L0g0LLRi9C30YvQstCw0YLRjNGB0Y8gaGlzdG9yeUFQSSDQtNC70Y8g0YHQvtGF0YDQsNC90LXQvdC40Y8g0LjRgdGC0L7RgNC40Lgg0YEgZ2V0INC30LDQv9GA0L7RgdCw0LzQuFxyXG4gICAgICAgICAgICBsZXQgaGlzdG9yeU9iaiA9IG5ldyBIaXN0b3J5Q29ucnRvbChnZXRRdWVyeSk7XHJcbiAgICAgICAgICAgIGhpc3RvcnlPYmouc2V0SGlzdG9yeShicmFuZCk7XHJcblxyXG4gICAgICAgICAgICAvL9Ci0LXRgdGC0L7QstC+0LUgYWpheCDQndGD0LbQvdC+INCx0YPQtNC10YIg0YPQutCw0LfRi9Cy0LDRgtGMINC90L7QstGL0Lkg0LDQtNGA0LXRgVxyXG4gICAgICAgICAgICBsZXQgYWpheENvbm5lY3QgPSBuZXcgQWpheEdldFByb2R1Y3RzKFwidGVzdC5qc29uXCIsIFwiZ2V0XCIpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGRlbGF5ID09PSB1bmRlZmluZWQpe1xyXG4gICAgICAgICAgICAgICAgYWpheENvbm5lY3Quc2VuZCgpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY2F0YWxvZFRlc3QucGxheVByZWxvYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50aW1lT3V0QWpheCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICBhamF4Q29ubmVjdC5zZW5kKCk7XHJcbiAgICAgICAgICAgICAgICB9LCBkZWxheSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc29sZS5sb2coZ2V0UXVlcnkpO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgIGxldCBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgdGhpcy5fZmlsdGVySXRlbS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pe1xyXG4gICAgICAgICAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKHNlbGYuX2FjdGl2ZUNsYXNzKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl90b29nbGVTb3J0KHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL9CS0YvQt9C+0LIg0LzQtdGC0L7QtNCwINGE0L7RgNC80LjRgNC+0LLQsNC90LjRjyBHZXQg0LfQsNC/0YDQvtGB0LBcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fcXVlcnlGb3JtYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9jbGVhbkNsYXNzRmlsdGVyQWxsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2FkZENsYXNzRmlsdGVyKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL9CS0YvQt9C+0LIg0LzQtdGC0L7QtNCwINGE0L7RgNC80LjRgNC+0LLQsNC90LjRjyBHZXQg0LfQsNC/0YDQvtGB0LBcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fcXVlcnlGb3JtYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9icmFuZEl0ZW0uZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmNsYXNzTGlzdC5jb250YWlucyhcImlzLWFjdGl2ZVwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9zZWxlY3RCcmFuZCh0aGlzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy/QktGL0LfQvtCyINC80LXRgtC+0LTQsCDRhNC+0YDQvNC40YDQvtCy0LDQvdC40Y8gR2V0INC30LDQv9GA0L7RgdCwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3F1ZXJ5Rm9ybWF0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgIHRoaXMuc2VhcmNoSXRlbS5nZXRFbGVtZW50c0J5VGFnTmFtZShcImlucHV0XCIpWzBdLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIC8v0JLRi9C30L7QsiDQvNC10YLQvtC00LAg0YTQvtGA0LzQuNGA0L7QstCw0L3QuNGPIEdldCDQt9Cw0L/RgNC+0YHQsFxyXG4gICAgICAgICAgICAgICAgc2VsZi5fcXVlcnlGb3JtYXRpb24oMTAwMCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNsYXNzIEhpc3RvcnlDb25ydG9sIHtcclxuICAgICAgICBjb25zdHJ1Y3Rvcih1cmwpIHtcclxuICAgICAgICAgICAgdGhpcy5fdXJsID0gdXJsO1xyXG4gICAgICAgICAgICB0aGlzLl9oaXN0b3J5T2JqID0gd2luZG93Lmhpc3Rvcnk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBzZXRIaXN0b3J5KGJyYW5kKSB7XHJcbiAgICAgICAgICAgIGlmIChicmFuZCA9PT0gdGhpcy5faGlzdG9yeU9iai5zdGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5faGlzdG9yeU9iai5yZXBsYWNlU3RhdGUoYnJhbmQsIGJyYW5kLCB0aGlzLl91cmwpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5faGlzdG9yeU9iai5wdXNoU3RhdGUoYnJhbmQsIGJyYW5kLCB0aGlzLl91cmwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZWFkSGlzdG9yeShnZXRRdWVyeSkge1xyXG4gICAgICAgICAgICAvL1RvZG86INC30LTQtdGB0Ywg0L3Rg9C20L3QviDQv9Cw0YDRgdC40YLRjCBnZXQg0LfQsNC/0YDQvtGBINC4INC/0YDQtdCy0L7QtNC40YLRjCDRgdC+0YHRgtC+0Y/QvdC40LUg0YHRgtGA0LDQvdC40YbRiyDQuiDQsNC60YLRg9Cw0LvRjNC90L7QvNGDINCy0LjQtNGDXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNsYXNzIEFqYXhHZXRQcm9kdWN0cyB7XHJcbiAgICAgICAgY29uc3RydWN0b3IodXJsLCB0eXBlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3VybCA9IHVybDtcclxuICAgICAgICAgICAgdGhpcy5fdHlwZSA9IHR5cGU7XHJcbiAgICAgICAgICAgIHRoaXMuYWpheCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgX3Byb2dyZXNzKCkge1xyXG4gICAgICAgICAgICBjYXRhbG9kVGVzdC5wbGF5UHJlbG9hZGVyKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBfY29tcGxldGUoKSB7XHJcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSBKU09OLnBhcnNlKHRoaXMucmVzcG9uc2UpO1xyXG5cclxuICAgICAgICAgICAgY2F0YWxvZFRlc3QudXBkYXRlVGl0bGUocmVzdWx0LnRpdGxlKTtcclxuICAgICAgICAgICAgY2F0YWxvZFRlc3QudXBkYXRlTGlzdFByb2R1Y3RzKHJlc3VsdC5lbGVtZW50cyk7XHJcblxyXG4gICAgICAgICAgICBjYXRhbG9kVGVzdC5zdG9wUHJlbG9hZGVyKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHNlbmQoZGF0YSkge1xyXG4gICAgICAgICAgICB0aGlzLmFqYXguYWRkRXZlbnRMaXN0ZW5lcihcInByb2dyZXNzXCIsIHRoaXMuX3Byb2dyZXNzLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIHRoaXMuYWpheC5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCB0aGlzLl9jb21wbGV0ZSwgZmFsc2UpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuX3R5cGUudG9Mb3dlckNhc2UoKSA9PT0gXCJnZXRcIikge1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuYWpheC5vcGVuKHRoaXMuX3R5cGUsIHRoaXMuX3VybCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFqYXguc2VuZCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZ2V0XCIpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX3R5cGUudG9Mb3dlckNhc2UoKSA9PT0gXCJwb3N0XCIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicG9zdFwiKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3JcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGxldCBjYXRhbG9kVGVzdCA9IG5ldyBDYXRhbG9nKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2F0YWxvZ1wiKVswXSwgXCJjYXRhbG9nX190aXRsZVwiLCBcImNhdGFsb2dfX3Byb2R1Y3RcIiwgXCJwcmVsb2FkZXJcIik7XHJcblxyXG4gICAgbGV0IGZpbHRlciA9IG5ldyBGaWx0ZXIoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jYXRhbG9nLW5hdl9fY29udHJvbHNcIilbMF0sIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2F0YWxvZy1maWx0ZXJcIilbMF0pO1xyXG5cclxuXHJcbiAgICAvL9Ci0LXRgdGCXHJcbiAgICAvLyB3aW5kb3cuZGl2QXJyYXkgPSBkaXZBcnJheTtcclxuICAgIHdpbmRvdy5maWx0ZXIgPSBmaWx0ZXI7XHJcbn0pKCk7XHJcbiIsIjsoZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgYnV0dG9uID0gJCgnLmZvb3Rlcl9fY29sLXRpdGxlJyk7XHJcblxyXG4gICAgYnV0dG9uLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgJCh0aGlzKS5jbG9zZXN0KCcuZm9vdGVyX19jb2wnKS5maW5kKCcuZm9vdGVyX19jb2wtbGlzdCcpLnNsaWRlVG9nZ2xlKDMwMCk7XHJcbiAgICB9KTtcclxufSkoKTtcclxuIiwiOyhmdW5jdGlvbigpIHtcclxuXHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICBpZiAoJCgnLmNhdGFsb2ctbmF2X19jb250cm9scycpLmxlbmd0aCkge1xyXG5cclxuICAgICAgICAgICAgdmFyIG1lbnVMaW5rID0gJCgnLmNhdGFsb2ctbmF2X19jb250cm9scy1saW5rJyksXHJcbiAgICAgICAgICAgICAgICBtZW51ID0gJCgnLmNhdGFsb2ctbmF2X19jb250cm9scy1saXN0Jyk7XHJcblxyXG4gICAgICAgICAgICB2YXIgbWVudUl0ZW0gPSAkKCcuY2F0YWxvZy1uYXZfX2NvbnRyb2xzLWl0ZW0nKSxcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUxpbmsgPSAkKCcuY2F0YWxvZy1uYXZfX2NvbnRyb2xzLWxpbmsuaXMtYWN0aXZlJyksXHJcbiAgICAgICAgICAgICAgICBob3ZlckJveCA9ICQoJy5jYXRhbG9nLW5hdl9faG92ZXInKSxcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUxpbmtQb3NMZWZ0ID0gYWN0aXZlTGluay5wb3NpdGlvbigpLmxlZnQsXHJcbiAgICAgICAgICAgICAgICBhY3RpdmVMaW5rUG9zVG9wID0gYWN0aXZlTGluay5wb3NpdGlvbigpLnRvcCxcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUxpbmtXaWR0aCA9IGFjdGl2ZUxpbmsuaW5uZXJXaWR0aCgpLFxyXG4gICAgICAgICAgICAgICAgYWN0aXZlTGlua0hlaWdodCA9IGFjdGl2ZUxpbmsuaW5uZXJIZWlnaHQoKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBjaGVjayA9IGZhbHNlO1xyXG4gICAgICAgICAgICBtZW51TGluay5ob3ZlcihcclxuICAgICAgICAgICAgICBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHZhciBuZXdMaW5rUG9zTGVmdCA9ICQodGhpcykucG9zaXRpb24oKS5sZWZ0LFxyXG4gICAgICAgICAgICAgICAgICAgIG5ld0xpbmtQb3NUb3AgPSAkKHRoaXMpLnBvc2l0aW9uKCkudG9wLFxyXG4gICAgICAgICAgICAgICAgICAgIG5ld0xpbmtXaWR0aCA9ICQodGhpcykuaW5uZXJXaWR0aCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIG5ld0xpbmtIZWlnaHQgPSAkKHRoaXMpLmlubmVySGVpZ2h0KCk7XHJcbiAgICAgICAgICAgICAgICBob3ZlckJveC5jc3MoeydsZWZ0JyA6IG5ld0xpbmtQb3NMZWZ0LCAndG9wJyA6IG5ld0xpbmtQb3NUb3AsICd3aWR0aCcgOiBuZXdMaW5rV2lkdGgsICdoZWlnaHQnIDogbmV3TGlua0hlaWdodH0pO1xyXG4gICAgICAgICAgICAgICAgY2hlY2sgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgaWYgKGNoZWNrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaG92ZXJCb3guY3NzKHsnbGVmdCcgOiBhY3RpdmVMaW5rUG9zTGVmdCwgJ3RvcCcgOiBhY3RpdmVMaW5rUG9zVG9wLCAnd2lkdGgnIDogMCwgJ2hlaWdodCcgOiAwfSk7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sIDEwMDApO1xyXG4gICAgICAgICAgICAgICAgY2hlY2sgPSB0cnVlO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlc2l6ZVBvcygpIHtcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUxpbmtQb3NMZWZ0ID0gYWN0aXZlTGluay5wb3NpdGlvbigpLmxlZnQsXHJcbiAgICAgICAgICAgICAgICBhY3RpdmVMaW5rUG9zVG9wID0gYWN0aXZlTGluay5wb3NpdGlvbigpLnRvcCxcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUxpbmtXaWR0aCA9IGFjdGl2ZUxpbmsuaW5uZXJXaWR0aCgpLFxyXG4gICAgICAgICAgICAgICAgYWN0aXZlTGlua0hlaWdodCA9IGFjdGl2ZUxpbmsuaW5uZXJIZWlnaHQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBob3ZlckJveC5jc3MoeydsZWZ0JyA6IGFjdGl2ZUxpbmtQb3NMZWZ0LCAndG9wJyA6IGFjdGl2ZUxpbmtQb3NUb3AsICd3aWR0aCcgOiAwLCAnaGVpZ2h0JyA6IDB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgJCh3aW5kb3cpLnJlc2l6ZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHJlc2l6ZVBvcygpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmVzaXplUG9zKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG5cclxufSkoKTtcclxuIiwiOyhmdW5jdGlvbigpIHtcclxuXHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAkKCcuZGVsaXZlcnlfX2Zvcm0taW5wdXQnKS5mb2N1c291dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgaWYgKCQodGhpcykudmFsKCkgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuYWRkQ2xhc3MoJ3ZhbHVlJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5yZW1vdmVDbGFzcygndmFsdWUnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9KTtcclxuXHJcbn0pKCk7XHJcbiIsIjsoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgbGV0IHNjZW5lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjZW5lJyk7XHJcbiAgICBpZiAoc2NlbmUgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgbGV0IHBhcmFsbGF4SW5zdGFuY2UgPSBuZXcgUGFyYWxsYXgoc2NlbmUpO1xyXG4gICAgfVxyXG5cclxufSkoKTtcclxuIiwiOyhmdW5jdGlvbigpIHtcclxuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuc2xpZGUtaW5mb19fYnV0dG9uJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJCh0aGlzKS5jbG9zZXN0KCcuc2xpZGUtaW5mbycpLmZpbmQoJy5zbGlkZS1pbmZvX19idXR0b24nKS50b2dnbGVDbGFzcygnaXMtYWN0aXZlJyk7XHJcbiAgICAgICAgJCh0aGlzKS5jbG9zZXN0KCcuc2xpZGUtaW5mbycpLmZpbmQoJy5zbGlkZS1pbmZvX19jb250ZW50Jykuc2xpZGVUb2dnbGUoMzAwKTtcclxuICAgIH0pO1xyXG59KSgpO1xyXG4iXX0=
