"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,s){return e&&_defineProperties(t.prototype,e),s&&_defineProperties(t,s),t}$(document).on("click",".product-row__button",function(){$(this).hasClass("animate")||($(this).addClass("animate"),$(this).addClass("button--check"),setTimeout(function(){$(this).removeClass("button--check"),$(this).removeClass("animate")}.bind(this),2e3))}),window.addEventListener("load",function(){$(".hr-sect").length&&$(".hr-pagination__step").click(function(){var t=$(this);if(!t.hasClass("is-active")){t.closest(".hr-sect").find(".hr-pagination__step").removeClass("is-active").removeClass("button"),t.addClass("is-active").addClass("button"),t.attr("data-index");var e=t.closest(".hr-sect").find(".hr-slider-slide");e.removeClass("is-active"),e.each(function(t,e){$(this).attr("data-index")==$(".hr-pagination__step.is-active").attr("data-index")&&$(this).addClass("is-active")})}})}),function(){var t=document.getElementById("menu-button");t.addEventListener("click",function(){t.classList.toggle("opened")}),window.onresize=function(){t.classList.remove("opened")},window.onscroll=function(){t.classList.remove("opened")}}(),function(){var t=function(){function a(t,e,s,i){if(_classCallCheck(this,a),void 0===t)return!1;this._self=t,this._title=this._self.querySelectorAll("."+e)[0],this._products=this._self.querySelectorAll("."+s)[0],this.preloader=this._self.querySelectorAll("."+i)[0]}return _createClass(a,[{key:"_cleanProducts",value:function(){this._products.innerHTML=""}},{key:"playPreloader",value:function(){this.preloader.classList.add("preloader--active")}},{key:"stopPreloader",value:function(){this.preloader.classList.remove("preloader--active")}},{key:"updateTitle",value:function(t){this._title.innerHTML=t}},{key:"updateListProducts",value:function(t){this._products.innerHTML=t}},{key:"addProducts",value:function(t){this._products.insertAdjacentHTML("beforeend",t)}}]),a}(),e=function(){function s(t,e){return _classCallCheck(this,s),void 0!==t&&(void 0!==e&&(this._containerBrands=t,this._brandItem=this._containerBrands.querySelectorAll(".catalog-nav__controls-link"),this._containerFilter=e,this._filterItem=this._containerFilter.querySelectorAll(".catalog-filter__col-btn"),this.searchItem=this._containerFilter.querySelectorAll(".catalog-filter__form")[0],this._activeClass="is-active",this._sortTypeAsc={class:"sort-down",dataSort:"asc"},this._sortTypeDesc={class:"sort-up",dataSort:"desc"},this.timeOutAjax,void this.init()))}return _createClass(s,[{key:"_cleanClassFilterAll",value:function(){var s=this;this._filterItem.forEach(function(t){var e=t.closest(".catalog-filter__col");t.classList.remove(s._activeClass),t.classList.remove(s._sortTypeAsc.class),e.removeAttribute("data-sort")})}},{key:"_addClassFilter",value:function(t){var e=t.closest(".catalog-filter__col");t.classList.add(this._activeClass),t.classList.add(this._sortTypeAsc.class),e.setAttribute("data-sort",this._sortTypeAsc.dataSort)}},{key:"_toogleSort",value:function(t){var e=t.closest(".catalog-filter__col");t.classList.contains(this._sortTypeAsc.class)?(t.classList.remove(this._sortTypeAsc.class),t.classList.add(this._sortTypeDesc.class),e.setAttribute("data-sort",this._sortTypeDesc.dataSort)):(t.classList.remove(this._sortTypeDesc.class),t.classList.add(this._sortTypeAsc.class),e.setAttribute("data-sort",this._sortTypeAsc.dataSort))}},{key:"_selectBrand",value:function(t){t.classList.contains("is-active")||(this._brandItem.forEach(function(t){t.classList.remove("is-active")}),t.classList.add("is-active"))}},{key:"_queryFormation",value:function(t){clearTimeout(this.timeOutAjax);var e,s=[],i=this.searchItem.getElementsByTagName("input")[0];this._brandItem.forEach(function(t){t.classList.contains("is-active")&&s.push("brand="+t.getAttribute("data-brand"))}),this._filterItem.forEach(function(t){var e=t.closest(".catalog-filter__col");t.classList.contains("is-active")&&(s.push("sort="+e.getAttribute("data-sort")),s.push("sortType="+e.getAttribute("data-filter")))}),""!==i.value&&s.push("search="+i.value),e="?"+s.join("&");var a=new o("test.json","get");void 0===t?a.send():(n.playPreloader(),this.timeOutAjax=setTimeout(function(){a.send()},t)),console.log(e)}},{key:"init",value:function(){var e=this;this._filterItem.forEach(function(t){t.addEventListener("click",function(){t.classList.contains(e._activeClass)?e._toogleSort(this):(e._cleanClassFilterAll(),e._addClassFilter(this)),e._queryFormation()})}),this._brandItem.forEach(function(t){t.addEventListener("click",function(t){t.preventDefault(),this.classList.contains("is-active")||(e._selectBrand(this),e._queryFormation())})}),this.searchItem.getElementsByTagName("input")[0].addEventListener("input",function(){e._queryFormation(1e3)})}}]),s}(),o=function(){function s(t,e){_classCallCheck(this,s),this._url=t,this._type=e,this.ajax=new XMLHttpRequest}return _createClass(s,[{key:"_progress",value:function(){n.playPreloader()}},{key:"_complete",value:function(){var t=JSON.parse(this.response);n.updateTitle(t.title),n.updateListProducts(t.elements),n.stopPreloader(),console.log(t)}},{key:"send",value:function(t){this.ajax.addEventListener("progress",this._progress,!1),this.ajax.addEventListener("load",this._complete,!1),"get"===this._type.toLowerCase()?(this.ajax.open(this._type,this._url),this.ajax.send(),console.log("get")):"post"===this._type.toLowerCase()?console.log("post"):console.log("Error")}}]),s}(),n=new t(document.querySelectorAll(".catalog")[0],"catalog__title","catalog__product","preloader"),s=new e(document.querySelectorAll(".catalog-nav__controls")[0],document.querySelectorAll(".catalog-filter")[0]);window.filter=s}(),$(".footer__col-title").on("click",function(t){t.preventDefault(),$(this).closest(".footer__col").find(".footer__col-list").slideToggle(300)}),window.addEventListener("load",function(){if($(".catalog-nav__controls").length){var t=function(){i=s.position().left,o=s.position().top,s.innerWidth(),s.innerHeight(),a.css({left:i,top:o,width:0,height:0})},e=$(".catalog-nav__controls-link"),s=($(".catalog-nav__controls-list"),$(".catalog-nav__controls-item"),$(".catalog-nav__controls-link.is-active")),a=$(".catalog-nav__hover"),i=s.position().left,o=s.position().top,n=(s.innerWidth(),s.innerHeight(),!1);e.hover(function(){var t=$(this).position().left,e=$(this).position().top,s=$(this).innerWidth(),i=$(this).innerHeight();a.css({left:t,top:e,width:s,height:i}),n=!1},function(){setTimeout(function(){n&&a.css({left:i,top:o,width:0,height:0})},1e3),n=!0}),$(window).resize(function(){t()}),t()}}),window.addEventListener("load",function(){$(".delivery__form-input").focusout(function(){""!==$(this).val()?$(this).parent().addClass("value"):$(this).parent().removeClass("value")})}),function(){var t=document.getElementById("scene");if(null!=t)new Parallax(t)}(),$(document).on("click",".slide-info__button",function(){$(this).closest(".slide-info").find(".slide-info__button").toggleClass("is-active"),$(this).closest(".slide-info").find(".slide-info__content").slideToggle(300)});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkZFRvQmFza2V0LmpzIiwiYmFza2V0VGFicy5qcyIsImJ1cmdlci5qcyIsImNhdGFsb2dVcGRhdGVDbGFzcy5qcyIsImZvb3Rlck1lbnUuanMiLCJob3ZlclJvbGxlci5qcyIsImxhYmVsRm9ybS5qcyIsInBhcmFsbGF4LmpzIiwic2hvd01vcmUuanMiXSwibmFtZXMiOlsiJCIsImRvY3VtZW50Iiwib24iLCJ0aGlzIiwiaGFzQ2xhc3MiLCJhZGRDbGFzcyIsInNldFRpbWVvdXQiLCJyZW1vdmVDbGFzcyIsImJpbmQiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwibGVuZ3RoIiwiY2xpY2siLCJ0aFN0ZXAiLCJjbG9zZXN0IiwiZmluZCIsImF0dHIiLCJzbGlkZXJTbGlkZXMiLCJlYWNoIiwicGFnaUluZGV4IiwibWVudUJ0biIsImdldEVsZW1lbnRCeUlkIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwib25yZXNpemUiLCJyZW1vdmUiLCJvbnNjcm9sbCIsIkNhdGFsb2ciLCJzZWxmIiwidGl0bGVDbGFzcyIsInByb2R1Y3RzQ29udGFpbmVyQ2xhc3MiLCJwcm9kdWN0c1ByZWxvYWRlckNsYXNzIiwiX2NsYXNzQ2FsbENoZWNrIiwidW5kZWZpbmVkIiwiX3NlbGYiLCJfdGl0bGUiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3Byb2R1Y3RzIiwicHJlbG9hZGVyIiwiX2NyZWF0ZUNsYXNzIiwia2V5IiwidmFsdWUiLCJpbm5lckhUTUwiLCJhZGQiLCJ0aXRsZSIsInByb2R1Y3RzIiwiaW5zZXJ0QWRqYWNlbnRIVE1MIiwiRmlsdGVyIiwiY29udGFpbmVyQnJhbmRzIiwiY29udGFpbmVyRmlsdGVyIiwiX2NvbnRhaW5lckJyYW5kcyIsIl9icmFuZEl0ZW0iLCJfY29udGFpbmVyRmlsdGVyIiwiX2ZpbHRlckl0ZW0iLCJzZWFyY2hJdGVtIiwiX2FjdGl2ZUNsYXNzIiwiX3NvcnRUeXBlQXNjIiwiY2xhc3MiLCJkYXRhU29ydCIsIl9zb3J0VHlwZURlc2MiLCJ0aW1lT3V0QWpheCIsImluaXQiLCJmb3JFYWNoIiwiaXRlbSIsInBhcmVudCIsInJlbW92ZUF0dHJpYnV0ZSIsInNldEF0dHJpYnV0ZSIsImNvbnRhaW5zIiwiZGVsYXkiLCJjbGVhclRpbWVvdXQiLCJnZXRRdWVyeSIsImFycmF5UXVlcnkiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsInB1c2giLCJnZXRBdHRyaWJ1dGUiLCJqb2luIiwiYWpheENvbm5lY3QiLCJBamF4R2V0UHJvZHVjdHMiLCJzZW5kIiwiY2F0YWxvZFRlc3QiLCJwbGF5UHJlbG9hZGVyIiwiY29uc29sZSIsImxvZyIsIl90b29nbGVTb3J0IiwiX2NsZWFuQ2xhc3NGaWx0ZXJBbGwiLCJfYWRkQ2xhc3NGaWx0ZXIiLCJfcXVlcnlGb3JtYXRpb24iLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwiX3NlbGVjdEJyYW5kIiwidXJsIiwidHlwZSIsIl91cmwiLCJfdHlwZSIsImFqYXgiLCJYTUxIdHRwUmVxdWVzdCIsInJlc3VsdCIsIkpTT04iLCJwYXJzZSIsInJlc3BvbnNlIiwidXBkYXRlVGl0bGUiLCJ1cGRhdGVMaXN0UHJvZHVjdHMiLCJlbGVtZW50cyIsInN0b3BQcmVsb2FkZXIiLCJkYXRhIiwiX3Byb2dyZXNzIiwiX2NvbXBsZXRlIiwidG9Mb3dlckNhc2UiLCJvcGVuIiwiZmlsdGVyIiwiZSIsInNsaWRlVG9nZ2xlIiwicmVzaXplUG9zIiwiYWN0aXZlTGlua1Bvc0xlZnQiLCJhY3RpdmVMaW5rIiwicG9zaXRpb24iLCJsZWZ0IiwiYWN0aXZlTGlua1Bvc1RvcCIsInRvcCIsImlubmVyV2lkdGgiLCJpbm5lckhlaWdodCIsImhvdmVyQm94IiwiY3NzIiwid2lkdGgiLCJoZWlnaHQiLCJtZW51TGluayIsImNoZWNrIiwiaG92ZXIiLCJuZXdMaW5rUG9zTGVmdCIsIm5ld0xpbmtQb3NUb3AiLCJuZXdMaW5rV2lkdGgiLCJuZXdMaW5rSGVpZ2h0IiwicmVzaXplIiwiZm9jdXNvdXQiLCJ2YWwiLCJzY2VuZSIsIlBhcmFsbGF4Iiwi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RVYsV0FDRXhILFdBQVcsV0FDTHdILEdBQ0ZMLEVBQVNDLElBQUksQ0FBQ04sS0FBU0gsRUFBbUJLLElBQVFELEVBQWtCTSxNQUFVLEVBQUdDLE9BQVcsS0FFN0YsS0FDSEUsR0FBUSxJQWFaOUgsRUFBRVMsUUFBUTJILE9BQU8sV0FDYnBCLE1BRUpBLE9DL0NSdkcsT0FBT0MsaUJBQWlCLE9BQVEsV0FFNUJWLEVBQUUseUJBQXlCcUksU0FBUyxXQUNaLEtBQWxCckksRUFBRUcsTUFBTW1JLE1BQ1Z0SSxFQUFFRyxNQUFNNkQsU0FBUzNELFNBQVMsU0FHMUJMLEVBQUVHLE1BQU02RCxTQUFTekQsWUFBWSxhQ1R4QyxXQUVHLElBQUlnSSxFQUFRdEksU0FBU29CLGVBQWUsU0FDcEMsR0FBYVksTUFBVHNHLEVBQ3VCLElBQUlDLFNBQVNELEdBSjNDLEdDQ0d2SSxFQUFFQyxVQUFVQyxHQUFHLFFBQVMsc0JBQXVCLFdBQzNDRixFQUFFRyxNQUFNVyxRQUFRLGVBQWVDLEtBQUssdUJBQXVCMEgsWUFBWSxhQUN2RXpJLEVBQUVHLE1BQU1XLFFBQVEsZUFBZUMsS0FBSyx3QkFBd0JnRyxZQUFZIiwiZmlsZSI6Im1haW4ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiOyhmdW5jdGlvbigpIHtcclxuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcucHJvZHVjdC1yb3dfX2J1dHRvbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICghJCh0aGlzKS5oYXNDbGFzcygnYW5pbWF0ZScpKSB7XHJcbiAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2FuaW1hdGUnKTtcclxuICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcyhcImJ1dHRvbi0tY2hlY2tcIik7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKFwiYnV0dG9uLS1jaGVja1wiKTtcclxuICAgICAgICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ2FuaW1hdGUnKTtcclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpLCAyMDAwKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufSkoKTtcclxuIiwiOyhmdW5jdGlvbigpIHtcclxuXHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICBpZiAoJCgnLmhyLXNlY3QnKS5sZW5ndGgpIHtcclxuXHJcbiAgICAgICAgICAgICQoXCIuaHItcGFnaW5hdGlvbl9fc3RlcFwiKS5jbGljayhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0aFN0ZXAgPSAkKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aFN0ZXAuaGFzQ2xhc3MoXCJpcy1hY3RpdmVcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aFN0ZXAuY2xvc2VzdCgnLmhyLXNlY3QnKS5maW5kKFwiLmhyLXBhZ2luYXRpb25fX3N0ZXBcIikucmVtb3ZlQ2xhc3MoXCJpcy1hY3RpdmVcIikucmVtb3ZlQ2xhc3MoXCJidXR0b25cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhTdGVwLmFkZENsYXNzKFwiaXMtYWN0aXZlXCIpLmFkZENsYXNzKFwiYnV0dG9uXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwYWdpSW5kZXggPSB0aFN0ZXAuYXR0cihcImRhdGEtaW5kZXhcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzbGlkZXJTbGlkZXMgPSB0aFN0ZXAuY2xvc2VzdChcIi5oci1zZWN0XCIpLmZpbmQoXCIuaHItc2xpZGVyLXNsaWRlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNsaWRlclNsaWRlcy5yZW1vdmVDbGFzcyhcImlzLWFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICBzbGlkZXJTbGlkZXMuZWFjaChmdW5jdGlvbihwYWdpSW5kZXgsIHRoU3RlcCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJCh0aGlzKS5hdHRyKFwiZGF0YS1pbmRleFwiKSA9PSAkKFwiLmhyLXBhZ2luYXRpb25fX3N0ZXAuaXMtYWN0aXZlXCIpLmF0dHIoXCJkYXRhLWluZGV4XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKFwiaXMtYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgfSk7XHJcblxyXG59KSgpO1xyXG4iLCI7KGZ1bmN0aW9uKCkge1xyXG4gICAgbGV0IG1lbnVCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWVudS1idXR0b24nKTtcclxuXHJcbiAgICBtZW51QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbWVudUJ0bi5jbGFzc0xpc3QudG9nZ2xlKCdvcGVuZWQnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHdpbmRvdy5vbnJlc2l6ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIG1lbnVCdG4uY2xhc3NMaXN0LnJlbW92ZSgnb3BlbmVkJyk7XHJcbiAgICB9XHJcbiAgICB3aW5kb3cub25zY3JvbGwgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBtZW51QnRuLmNsYXNzTGlzdC5yZW1vdmUoJ29wZW5lZCcpO1xyXG4gICAgfVxyXG59KSgpO1xyXG4iLCI7KGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgY2xhc3MgQ2F0YWxvZyB7XHJcbiAgICAgICAgY29uc3RydWN0b3Ioc2VsZiwgdGl0bGVDbGFzcywgcHJvZHVjdHNDb250YWluZXJDbGFzcywgcHJvZHVjdHNQcmVsb2FkZXJDbGFzcyl7XHJcbiAgICAgICAgICAgIGlmIChzZWxmID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLl9zZWxmID0gc2VsZjtcclxuICAgICAgICAgICAgdGhpcy5fdGl0bGUgPSB0aGlzLl9zZWxmLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuXCIgKyB0aXRsZUNsYXNzKVswXTtcclxuICAgICAgICAgICAgdGhpcy5fcHJvZHVjdHMgPSB0aGlzLl9zZWxmLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuXCIgKyBwcm9kdWN0c0NvbnRhaW5lckNsYXNzKVswXTtcclxuICAgICAgICAgICAgdGhpcy5wcmVsb2FkZXIgPSB0aGlzLl9zZWxmLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuXCIgKyBwcm9kdWN0c1ByZWxvYWRlckNsYXNzKVswXTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBfY2xlYW5Qcm9kdWN0cygpIHtcclxuICAgICAgICAgICAgdGhpcy5fcHJvZHVjdHMuaW5uZXJIVE1MID0gXCJcIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHBsYXlQcmVsb2FkZXIoKSB7XHJcbiAgICAgICAgICAgIC8vINCh0LTQtdC70LDRgtGMINC30LDQv9GD0YHQuiDQv9GA0LXQu9C+0YPQtNC10YDQsFxyXG4gICAgICAgICAgICB0aGlzLnByZWxvYWRlci5jbGFzc0xpc3QuYWRkKFwicHJlbG9hZGVyLS1hY3RpdmVcIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBzdG9wUHJlbG9hZGVyKCkge1xyXG4gICAgICAgICAgICB0aGlzLnByZWxvYWRlci5jbGFzc0xpc3QucmVtb3ZlKFwicHJlbG9hZGVyLS1hY3RpdmVcIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB1cGRhdGVUaXRsZSh0aXRsZSkge1xyXG4gICAgICAgICAgICB0aGlzLl90aXRsZS5pbm5lckhUTUwgPSB0aXRsZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHVwZGF0ZUxpc3RQcm9kdWN0cyhwcm9kdWN0cykge1xyXG4gICAgICAgICAgICB0aGlzLl9wcm9kdWN0cy5pbm5lckhUTUwgPSBwcm9kdWN0cztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGFkZFByb2R1Y3RzKHByb2R1Y3RzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Byb2R1Y3RzLmluc2VydEFkamFjZW50SFRNTChcImJlZm9yZWVuZFwiLCBwcm9kdWN0cyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNsYXNzIEZpbHRlciB7XHJcbiAgICAgICAgY29uc3RydWN0b3IoY29udGFpbmVyQnJhbmRzLCBjb250YWluZXJGaWx0ZXIpIHtcclxuICAgICAgICAgICAgaWYgKGNvbnRhaW5lckJyYW5kcyA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGNvbnRhaW5lckZpbHRlciA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuX2NvbnRhaW5lckJyYW5kcyA9IGNvbnRhaW5lckJyYW5kcztcclxuICAgICAgICAgICAgdGhpcy5fYnJhbmRJdGVtID0gdGhpcy5fY29udGFpbmVyQnJhbmRzLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2F0YWxvZy1uYXZfX2NvbnRyb2xzLWxpbmtcIik7XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9jb250YWluZXJGaWx0ZXIgPSBjb250YWluZXJGaWx0ZXI7XHJcbiAgICAgICAgICAgIHRoaXMuX2ZpbHRlckl0ZW0gPSB0aGlzLl9jb250YWluZXJGaWx0ZXIucXVlcnlTZWxlY3RvckFsbChcIi5jYXRhbG9nLWZpbHRlcl9fY29sLWJ0blwiKTtcclxuICAgICAgICAgICAgdGhpcy5zZWFyY2hJdGVtID0gdGhpcy5fY29udGFpbmVyRmlsdGVyLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2F0YWxvZy1maWx0ZXJfX2Zvcm1cIilbMF07XHJcbiAgICAgICAgICAgIHRoaXMuX2FjdGl2ZUNsYXNzID0gXCJpcy1hY3RpdmVcIjtcclxuICAgICAgICAgICAgdGhpcy5fc29ydFR5cGVBc2MgPSB7XHJcbiAgICAgICAgICAgICAgICBjbGFzczogXCJzb3J0LWRvd25cIixcclxuICAgICAgICAgICAgICAgIGRhdGFTb3J0OiBcImFzY1wiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHRoaXMuX3NvcnRUeXBlRGVzYyA9IHtcclxuICAgICAgICAgICAgICAgIGNsYXNzOiBcInNvcnQtdXBcIixcclxuICAgICAgICAgICAgICAgIGRhdGFTb3J0OiBcImRlc2NcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLnRpbWVPdXRBamF4O1xyXG4gICAgICAgICAgICB0aGlzLmluaXQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIF9jbGVhbkNsYXNzRmlsdGVyQWxsKCkge1xyXG4gICAgICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9maWx0ZXJJdGVtLmZvckVhY2goZnVuY3Rpb24oaXRlbSl7XHJcbiAgICAgICAgICAgICAgICBsZXQgcGFyZW50ID0gaXRlbS5jbG9zZXN0KFwiLmNhdGFsb2ctZmlsdGVyX19jb2xcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZShzZWxmLl9hY3RpdmVDbGFzcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKHNlbGYuX3NvcnRUeXBlQXNjLmNsYXNzKTtcclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnQucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1zb3J0XCIpO1xyXG5cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBfYWRkQ2xhc3NGaWx0ZXIoaXRlbSkge1xyXG4gICAgICAgICAgICBsZXQgcGFyZW50ID0gaXRlbS5jbG9zZXN0KFwiLmNhdGFsb2ctZmlsdGVyX19jb2xcIik7XHJcblxyXG4gICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQodGhpcy5fYWN0aXZlQ2xhc3MpO1xyXG4gICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQodGhpcy5fc29ydFR5cGVBc2MuY2xhc3MpO1xyXG5cclxuICAgICAgICAgICAgcGFyZW50LnNldEF0dHJpYnV0ZShcImRhdGEtc29ydFwiLCB0aGlzLl9zb3J0VHlwZUFzYy5kYXRhU29ydCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBfdG9vZ2xlU29ydChpdGVtKSB7XHJcbiAgICAgICAgICAgIGxldCBwYXJlbnQgPSBpdGVtLmNsb3Nlc3QoXCIuY2F0YWxvZy1maWx0ZXJfX2NvbFwiKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChpdGVtLmNsYXNzTGlzdC5jb250YWlucyh0aGlzLl9zb3J0VHlwZUFzYy5jbGFzcykpIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zb3J0VHlwZUFzYy5jbGFzcyk7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQodGhpcy5fc29ydFR5cGVEZXNjLmNsYXNzKTtcclxuXHJcbiAgICAgICAgICAgICAgICBwYXJlbnQuc2V0QXR0cmlidXRlKFwiZGF0YS1zb3J0XCIsIHRoaXMuX3NvcnRUeXBlRGVzYy5kYXRhU29ydCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc29ydFR5cGVEZXNjLmNsYXNzKTtcclxuICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZCh0aGlzLl9zb3J0VHlwZUFzYy5jbGFzcyk7XHJcblxyXG4gICAgICAgICAgICAgICAgcGFyZW50LnNldEF0dHJpYnV0ZShcImRhdGEtc29ydFwiLCB0aGlzLl9zb3J0VHlwZUFzYy5kYXRhU29ydCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBfc2VsZWN0QnJhbmQoaXRlbSkge1xyXG4gICAgICAgICAgICBpZiAoIWl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKFwiaXMtYWN0aXZlXCIpKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2JyYW5kSXRlbS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoXCJpcy1hY3RpdmVcIik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZChcImlzLWFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgX3F1ZXJ5Rm9ybWF0aW9uKGRlbGF5KSB7XHJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVPdXRBamF4KTtcclxuICAgICAgICAgICAgLy/QnNC10YLQvtC0INGE0L7RgNC80LjRgNC+0LLQsNC90LjRjyBnZXQg0LfQsNC/0YDQvtGB0LBcclxuICAgICAgICAgICAgbGV0IGFycmF5UXVlcnkgPSBbXSxcclxuICAgICAgICAgICAgICAgIHNlYXJjaEl0ZW0gPSB0aGlzLnNlYXJjaEl0ZW0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJpbnB1dFwiKVswXSxcclxuICAgICAgICAgICAgICAgIGdldFF1ZXJ5O1xyXG5cclxuICAgICAgICAgICAgdGhpcy5fYnJhbmRJdGVtLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKFwiaXMtYWN0aXZlXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXJyYXlRdWVyeS5wdXNoKFwiYnJhbmQ9XCIgKyBpdGVtLmdldEF0dHJpYnV0ZShcImRhdGEtYnJhbmRcIikpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX2ZpbHRlckl0ZW0uZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgcGFyZW50ID0gaXRlbS5jbG9zZXN0KFwiLmNhdGFsb2ctZmlsdGVyX19jb2xcIik7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXRlbS5jbGFzc0xpc3QuY29udGFpbnMoXCJpcy1hY3RpdmVcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICBhcnJheVF1ZXJ5LnB1c2goXCJzb3J0PVwiICsgcGFyZW50LmdldEF0dHJpYnV0ZShcImRhdGEtc29ydFwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYXJyYXlRdWVyeS5wdXNoKFwic29ydFR5cGU9XCIgKyBwYXJlbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS1maWx0ZXJcIikpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChzZWFyY2hJdGVtLnZhbHVlICE9PSBcIlwiKSB7XHJcbiAgICAgICAgICAgICAgICBhcnJheVF1ZXJ5LnB1c2goXCJzZWFyY2g9XCIgKyBzZWFyY2hJdGVtLnZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0UXVlcnkgPSBcIj9cIiArIGFycmF5UXVlcnkuam9pbihcIiZcIik7XHJcblxyXG4gICAgICAgICAgICAvL1RvZG86INC30LTQtdGB0Ywg0LTQvtC70LbQtdC9INCy0YvQt9GL0LLQsNGC0YzRgdGPIGFqYXgg0Lgg0L/RgNC40L3QuNC80LDRgtGMIGdldCDRgdGC0YDQvtC60YNcclxuICAgICAgICAgICAgLy9Ub2RvOiDQt9C00LXRgdGMINC00L7Qu9C20LXQvSDQstGL0LfRi9Cy0LDRgtGM0YHRjyBoaXN0b3J5QVBJINC00LvRjyDRgdC+0YXRgNCw0L3QtdC90LjRjyDQuNGB0YLQvtGA0LjQuCDRgSBnZXQg0LfQsNC/0YDQvtGB0LDQvNC4XHJcblxyXG4gICAgICAgICAgICAvL9Ci0LXRgdGC0L7QstC+0LUgYWpheCDQodC+0LXQtNC40L3QtdC90LjQtVxyXG4gICAgICAgICAgICBsZXQgYWpheENvbm5lY3QgPSBuZXcgQWpheEdldFByb2R1Y3RzKFwidGVzdC5qc29uXCIsIFwiZ2V0XCIpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGRlbGF5ID09PSB1bmRlZmluZWQpe1xyXG4gICAgICAgICAgICAgICAgYWpheENvbm5lY3Quc2VuZCgpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY2F0YWxvZFRlc3QucGxheVByZWxvYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50aW1lT3V0QWpheCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICBhamF4Q29ubmVjdC5zZW5kKCk7XHJcbiAgICAgICAgICAgICAgICB9LCBkZWxheSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc29sZS5sb2coZ2V0UXVlcnkpO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgIGxldCBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgdGhpcy5fZmlsdGVySXRlbS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pe1xyXG4gICAgICAgICAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKHNlbGYuX2FjdGl2ZUNsYXNzKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl90b29nbGVTb3J0KHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL9CS0YvQt9C+0LIg0LzQtdGC0L7QtNCwINGE0L7RgNC80LjRgNC+0LLQsNC90LjRjyBHZXQg0LfQsNC/0YDQvtGB0LBcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fcXVlcnlGb3JtYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9jbGVhbkNsYXNzRmlsdGVyQWxsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2FkZENsYXNzRmlsdGVyKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL9CS0YvQt9C+0LIg0LzQtdGC0L7QtNCwINGE0L7RgNC80LjRgNC+0LLQsNC90LjRjyBHZXQg0LfQsNC/0YDQvtGB0LBcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fcXVlcnlGb3JtYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9icmFuZEl0ZW0uZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmNsYXNzTGlzdC5jb250YWlucyhcImlzLWFjdGl2ZVwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9zZWxlY3RCcmFuZCh0aGlzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy/QktGL0LfQvtCyINC80LXRgtC+0LTQsCDRhNC+0YDQvNC40YDQvtCy0LDQvdC40Y8gR2V0INC30LDQv9GA0L7RgdCwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3F1ZXJ5Rm9ybWF0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgIHRoaXMuc2VhcmNoSXRlbS5nZXRFbGVtZW50c0J5VGFnTmFtZShcImlucHV0XCIpWzBdLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIC8v0JLRi9C30L7QsiDQvNC10YLQvtC00LAg0YTQvtGA0LzQuNGA0L7QstCw0L3QuNGPIEdldCDQt9Cw0L/RgNC+0YHQsFxyXG4gICAgICAgICAgICAgICAgc2VsZi5fcXVlcnlGb3JtYXRpb24oMTAwMCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBjbGFzcyBBamF4R2V0UHJvZHVjdHMge1xyXG4gICAgICAgIGNvbnN0cnVjdG9yKHVybCwgdHlwZSkge1xyXG4gICAgICAgICAgICB0aGlzLl91cmwgPSB1cmw7XHJcbiAgICAgICAgICAgIHRoaXMuX3R5cGUgPSB0eXBlO1xyXG4gICAgICAgICAgICB0aGlzLmFqYXggPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIF9wcm9ncmVzcygpIHtcclxuICAgICAgICAgICAgLy8g0KHQtNC10LvQsNGC0Ywg0LTQtdC50YHRgtCy0LjQtSDQstC+INCy0YDQtdC80Y8g0L/RgNC+0YbQtdGB0YHQsCDQt9Cw0LPRgNGD0LfQutC4XHJcbiAgICAgICAgICAgIGNhdGFsb2RUZXN0LnBsYXlQcmVsb2FkZXIoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIF9jb21wbGV0ZSgpIHtcclxuICAgICAgICAgICAgLy8gaWYgKHRoaXMuc3RhdHVzICE9IDIwMCkge1xyXG4gICAgICAgICAgICAvLyAgIC8vINC+0LHRgNCw0LHQvtGC0LDRgtGMINC+0YjQuNCx0LrRg1xyXG4gICAgICAgICAgICAvLyAgIGNvbnNvbGUubG9nKCB0aGlzLnN0YXR1cyArICc6ICcgKyB0aGlzLnN0YXR1c1RleHQgKTsgLy8g0L/RgNC40LzQtdGAINCy0YvQstC+0LTQsDogNDA0OiBOb3QgRm91bmRcclxuICAgICAgICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gICAvLyDQstGL0LLQtdGB0YLQuCDRgNC10LfRg9C70YzRgtCw0YJcclxuICAgICAgICAgICAgLy8gICBsZXQgb2JqID0gSlNPTi5wYXJzZSh0aGlzLnJlc3BvbnNlKVxyXG4gICAgICAgICAgICAvLyAgIGNvbnNvbGUubG9nKCBvYmogKTsgLy8gcmVzcG9uc2VUZXh0IC0tINGC0LXQutGB0YIg0L7RgtCy0LXRgtCwLlxyXG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gSlNPTi5wYXJzZSh0aGlzLnJlc3BvbnNlKTtcclxuXHJcbiAgICAgICAgICAgIGNhdGFsb2RUZXN0LnVwZGF0ZVRpdGxlKHJlc3VsdC50aXRsZSk7XHJcbiAgICAgICAgICAgIGNhdGFsb2RUZXN0LnVwZGF0ZUxpc3RQcm9kdWN0cyhyZXN1bHQuZWxlbWVudHMpO1xyXG5cclxuICAgICAgICAgICAgY2F0YWxvZFRlc3Quc3RvcFByZWxvYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBzZW5kKGRhdGEpIHtcclxuICAgICAgICAgICAgdGhpcy5hamF4LmFkZEV2ZW50TGlzdGVuZXIoXCJwcm9ncmVzc1wiLCB0aGlzLl9wcm9ncmVzcywgZmFsc2UpO1xyXG4gICAgICAgICAgICB0aGlzLmFqYXguYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgdGhpcy5fY29tcGxldGUsIGZhbHNlKTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLl90eXBlLnRvTG93ZXJDYXNlKCkgPT09IFwiZ2V0XCIpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLmFqYXgub3Blbih0aGlzLl90eXBlLCB0aGlzLl91cmwpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hamF4LnNlbmQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImdldFwiKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl90eXBlLnRvTG93ZXJDYXNlKCkgPT09IFwicG9zdFwiKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInBvc3RcIik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBsZXQgY2F0YWxvZFRlc3QgPSBuZXcgQ2F0YWxvZyhkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNhdGFsb2dcIilbMF0sIFwiY2F0YWxvZ19fdGl0bGVcIiwgXCJjYXRhbG9nX19wcm9kdWN0XCIsIFwicHJlbG9hZGVyXCIpO1xyXG5cclxuICAgIGxldCBmaWx0ZXIgPSBuZXcgRmlsdGVyKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2F0YWxvZy1uYXZfX2NvbnRyb2xzXCIpWzBdLCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNhdGFsb2ctZmlsdGVyXCIpWzBdKTtcclxuXHJcblxyXG4gICAgLy/QotC10YHRglxyXG4gICAgLy8gd2luZG93LmRpdkFycmF5ID0gZGl2QXJyYXk7XHJcbiAgICB3aW5kb3cuZmlsdGVyID0gZmlsdGVyO1xyXG59KSgpO1xyXG4iLCI7KGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIGJ1dHRvbiA9ICQoJy5mb290ZXJfX2NvbC10aXRsZScpO1xyXG5cclxuICAgIGJ1dHRvbi5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICQodGhpcykuY2xvc2VzdCgnLmZvb3Rlcl9fY29sJykuZmluZCgnLmZvb3Rlcl9fY29sLWxpc3QnKS5zbGlkZVRvZ2dsZSgzMDApO1xyXG4gICAgfSk7XHJcbn0pKCk7XHJcbiIsIjsoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgaWYgKCQoJy5jYXRhbG9nLW5hdl9fY29udHJvbHMnKS5sZW5ndGgpIHtcclxuXHJcbiAgICAgICAgICAgIHZhciBtZW51TGluayA9ICQoJy5jYXRhbG9nLW5hdl9fY29udHJvbHMtbGluaycpLFxyXG4gICAgICAgICAgICAgICAgbWVudSA9ICQoJy5jYXRhbG9nLW5hdl9fY29udHJvbHMtbGlzdCcpO1xyXG5cclxuICAgICAgICAgICAgdmFyIG1lbnVJdGVtID0gJCgnLmNhdGFsb2ctbmF2X19jb250cm9scy1pdGVtJyksXHJcbiAgICAgICAgICAgICAgICBhY3RpdmVMaW5rID0gJCgnLmNhdGFsb2ctbmF2X19jb250cm9scy1saW5rLmlzLWFjdGl2ZScpLFxyXG4gICAgICAgICAgICAgICAgaG92ZXJCb3ggPSAkKCcuY2F0YWxvZy1uYXZfX2hvdmVyJyksXHJcbiAgICAgICAgICAgICAgICBhY3RpdmVMaW5rUG9zTGVmdCA9IGFjdGl2ZUxpbmsucG9zaXRpb24oKS5sZWZ0LFxyXG4gICAgICAgICAgICAgICAgYWN0aXZlTGlua1Bvc1RvcCA9IGFjdGl2ZUxpbmsucG9zaXRpb24oKS50b3AsXHJcbiAgICAgICAgICAgICAgICBhY3RpdmVMaW5rV2lkdGggPSBhY3RpdmVMaW5rLmlubmVyV2lkdGgoKSxcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUxpbmtIZWlnaHQgPSBhY3RpdmVMaW5rLmlubmVySGVpZ2h0KCk7XHJcblxyXG4gICAgICAgICAgICB2YXIgY2hlY2sgPSBmYWxzZTtcclxuICAgICAgICAgICAgbWVudUxpbmsuaG92ZXIoXHJcbiAgICAgICAgICAgICAgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbmV3TGlua1Bvc0xlZnQgPSAkKHRoaXMpLnBvc2l0aW9uKCkubGVmdCxcclxuICAgICAgICAgICAgICAgICAgICBuZXdMaW5rUG9zVG9wID0gJCh0aGlzKS5wb3NpdGlvbigpLnRvcCxcclxuICAgICAgICAgICAgICAgICAgICBuZXdMaW5rV2lkdGggPSAkKHRoaXMpLmlubmVyV2lkdGgoKSxcclxuICAgICAgICAgICAgICAgICAgICBuZXdMaW5rSGVpZ2h0ID0gJCh0aGlzKS5pbm5lckhlaWdodCgpO1xyXG4gICAgICAgICAgICAgICAgaG92ZXJCb3guY3NzKHsnbGVmdCcgOiBuZXdMaW5rUG9zTGVmdCwgJ3RvcCcgOiBuZXdMaW5rUG9zVG9wLCAnd2lkdGgnIDogbmV3TGlua1dpZHRoLCAnaGVpZ2h0JyA6IG5ld0xpbmtIZWlnaHR9KTtcclxuICAgICAgICAgICAgICAgIGNoZWNrID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgIGlmIChjaGVjaykge1xyXG4gICAgICAgICAgICAgICAgICAgIGhvdmVyQm94LmNzcyh7J2xlZnQnIDogYWN0aXZlTGlua1Bvc0xlZnQsICd0b3AnIDogYWN0aXZlTGlua1Bvc1RvcCwgJ3dpZHRoJyA6IDAsICdoZWlnaHQnIDogMH0pO1xyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgICAgICAgICAgIGNoZWNrID0gdHJ1ZTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiByZXNpemVQb3MoKSB7XHJcbiAgICAgICAgICAgICAgICBhY3RpdmVMaW5rUG9zTGVmdCA9IGFjdGl2ZUxpbmsucG9zaXRpb24oKS5sZWZ0LFxyXG4gICAgICAgICAgICAgICAgYWN0aXZlTGlua1Bvc1RvcCA9IGFjdGl2ZUxpbmsucG9zaXRpb24oKS50b3AsXHJcbiAgICAgICAgICAgICAgICBhY3RpdmVMaW5rV2lkdGggPSBhY3RpdmVMaW5rLmlubmVyV2lkdGgoKSxcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUxpbmtIZWlnaHQgPSBhY3RpdmVMaW5rLmlubmVySGVpZ2h0KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaG92ZXJCb3guY3NzKHsnbGVmdCcgOiBhY3RpdmVMaW5rUG9zTGVmdCwgJ3RvcCcgOiBhY3RpdmVMaW5rUG9zVG9wLCAnd2lkdGgnIDogMCwgJ2hlaWdodCcgOiAwfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICQod2luZG93KS5yZXNpemUoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICByZXNpemVQb3MoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJlc2l6ZVBvcygpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuXHJcbn0pKCk7XHJcbiIsIjsoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgJCgnLmRlbGl2ZXJ5X19mb3JtLWlucHV0JykuZm9jdXNvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgIGlmICgkKHRoaXMpLnZhbCgpICE9PSAnJykge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmFkZENsYXNzKCd2YWx1ZScpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkucmVtb3ZlQ2xhc3MoJ3ZhbHVlJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfSk7XHJcblxyXG59KSgpO1xyXG4iLCI7KGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIGxldCBzY2VuZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY2VuZScpO1xyXG4gICAgaWYgKHNjZW5lICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIGxldCBwYXJhbGxheEluc3RhbmNlID0gbmV3IFBhcmFsbGF4KHNjZW5lKTtcclxuICAgIH1cclxuXHJcbn0pKCk7XHJcbiIsIjsoZnVuY3Rpb24oKSB7XHJcbiAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLnNsaWRlLWluZm9fX2J1dHRvbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICQodGhpcykuY2xvc2VzdCgnLnNsaWRlLWluZm8nKS5maW5kKCcuc2xpZGUtaW5mb19fYnV0dG9uJykudG9nZ2xlQ2xhc3MoJ2lzLWFjdGl2ZScpO1xyXG4gICAgICAgICQodGhpcykuY2xvc2VzdCgnLnNsaWRlLWluZm8nKS5maW5kKCcuc2xpZGUtaW5mb19fY29udGVudCcpLnNsaWRlVG9nZ2xlKDMwMCk7XHJcbiAgICB9KTtcclxufSkoKTtcclxuIl19
