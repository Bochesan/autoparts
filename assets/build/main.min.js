"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,s){return e&&_defineProperties(t.prototype,e),s&&_defineProperties(t,s),t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,s){return e&&_defineProperties(t.prototype,e),s&&_defineProperties(t,s),t}$(document).on("click",".button--basket",function(){$(this).hasClass("animate")||($(this).addClass("animate"),$(this).addClass("button--check"),setTimeout(function(){$(this).removeClass("button--check"),$(this).removeClass("animate")}.bind(this),2e3))}),window.addEventListener("load",function(){$(".hr-sect").length&&$(".hr-pagination__step").click(function(){var t=$(this);if(!t.hasClass("is-active")){t.closest(".hr-sect").find(".hr-pagination__step").removeClass("is-active").removeClass("button"),t.addClass("is-active").addClass("button"),t.attr("data-index");var e=t.closest(".hr-sect").find(".hr-slider-slide");e.removeClass("is-active"),e.each(function(t,e){$(this).attr("data-index")==$(".hr-pagination__step.is-active").attr("data-index")&&$(this).addClass("is-active")})}})}),function(){var t=document.getElementById("menu-button");t.addEventListener("click",function(){t.classList.toggle("opened")}),window.onresize=function(){t.classList.remove("opened")},window.onscroll=function(){t.classList.remove("opened")}}(),function(){var t=function(){function o(t,e,s,i){if(_classCallCheck(this,o),void 0===t)return!1;this._self=t,this._title=this._self.querySelectorAll("."+e)[0],this._products=this._self.querySelectorAll("."+s)[0],this.preloader=this._self.querySelectorAll("."+i)[0]}return _createClass(o,[{key:"_cleanProducts",value:function(){this._products.innerHTML=""}},{key:"playPreloader",value:function(){this.preloader.classList.add("preloader--active")}},{key:"stopPreloader",value:function(){this.preloader.classList.remove("preloader--active")}},{key:"updateTitle",value:function(t){this._title.innerHTML=t,this._title.setAttribute("data-name",t)}},{key:"updateListProducts",value:function(t){this._products.innerHTML=t}},{key:"addProducts",value:function(t){this._products.insertAdjacentHTML("beforeend",t)}}]),o}(),e=function(){function i(t,e,s){return _classCallCheck(this,i),void 0!==t&&(void 0!==e&&(void 0!==s&&(this._containerBrands=t,this._brandItem=this._containerBrands.querySelectorAll(".catalog-nav__controls-link"),this._containerFilter=e,this._filterItem=this._containerFilter.querySelectorAll(".catalog-filter__col-btn"),this.searchItem=this._containerFilter.querySelectorAll(".catalog-filter__form")[0],this._activeClass="is-active",this._sortTypeAsc={class:"sort-down",dataSort:"asc"},this._sortTypeDesc={class:"sort-up",dataSort:"desc"},this._containerMore=s,this.timeOutAjax,void this.init())))}return _createClass(i,[{key:"_cleanClassFilterAll",value:function(){var s=this;this._filterItem.forEach(function(t){var e=t.closest(".catalog-filter__col");t.classList.remove(s._activeClass),t.classList.remove(s._sortTypeAsc.class),e.removeAttribute("data-sort")})}},{key:"_addClassFilter",value:function(t){var e=t.closest(".catalog-filter__col");console.log(t),t.classList.add(this._activeClass),t.classList.add(this._sortTypeAsc.class),e.setAttribute("data-sort",this._sortTypeAsc.dataSort)}},{key:"_toogleSort",value:function(t){var e=t.closest(".catalog-filter__col");t.classList.contains(this._sortTypeAsc.class)?(t.classList.remove(this._sortTypeAsc.class),t.classList.add(this._sortTypeDesc.class),e.setAttribute("data-sort",this._sortTypeDesc.dataSort)):(t.classList.remove(this._sortTypeDesc.class),t.classList.add(this._sortTypeAsc.class),e.setAttribute("data-sort",this._sortTypeAsc.dataSort))}},{key:"_selectBrand",value:function(t){t.classList.contains("is-active")||(this._brandItem.forEach(function(t){t.classList.remove("is-active")}),t.classList.add("is-active"))}},{key:"_queryFormation",value:function(t,e){clearTimeout(this.timeOutAjax);var s,i,o=[],a=this.searchItem.getElementsByTagName("input")[0];this._brandItem.forEach(function(t){t.classList.contains("is-active")&&(o.push("brand="+t.getAttribute("data-brand")),s=t.getAttribute("data-brand"))}),this._filterItem.forEach(function(t){var e=t.closest(".catalog-filter__col");t.classList.contains("is-active")&&(o.push("sort="+e.getAttribute("data-sort")),o.push("sortType="+e.getAttribute("data-filter")))}),""!==a.value&&o.push("search="+a.value),i="?"+o.join("&"),c.setHistory(i,s);var n=new l("test.json","get",t);void 0===e?n.send():(r.playPreloader(),this.timeOutAjax=setTimeout(function(){n.send()},e)),console.log(i)}},{key:"updateStateFilterFromUrl",value:function(e){var s=this;void 0!==e[0]?this._brandItem.forEach(function(t){t.getAttribute("data-brand")===e[0][1]&&s._selectBrand(t)}):this._selectBrand(this._brandItem[0]),void 0!==e[2]?this._filterItem.forEach(function(t){t.closest(".catalog-filter__col").getAttribute("data-filter")===e[2][1]&&(s._cleanClassFilterAll(),s._addClassFilter(t),t.closest(".catalog-filter__col").setAttribute("data-sort",e[1][1]),"asc"===e[1][1]?(t.classList.add(s._sortTypeAsc.class),t.classList.remove(s._sortTypeDesc.class)):(t.classList.remove(s._sortTypeAsc.class),t.classList.add(s._sortTypeDesc.class)))}):this._filterItem.forEach(function(t){"name"===t.closest(".catalog-filter__col").getAttribute("data-filter")&&(s._cleanClassFilterAll(),s._addClassFilter(t))}),void 0!==e[3]?(console.log(e[3][1]),s.searchItem.getElementsByTagName("input")[0].value=e[3][1]):s.searchItem.getElementsByTagName("input")[0].value=""}},{key:"init",value:function(){var e=this;this._filterItem.forEach(function(t){t.addEventListener("click",function(){t.classList.contains(e._activeClass)?e._toogleSort(this):(e._cleanClassFilterAll(),e._addClassFilter(this)),e._queryFormation(!0)})}),this._brandItem.forEach(function(t){t.addEventListener("click",function(t){t.preventDefault(),this.classList.contains("is-active")||(e._selectBrand(this),e._queryFormation(!0))})}),this.searchItem.getElementsByTagName("input")[0].addEventListener("input",function(){e._queryFormation(!0,1e3)}),this._containerMore.querySelectorAll(".catalog__more-button")[0].addEventListener("click",function(t){t.preventDefault(),e._queryFormation(!1)})}}]),i}(),s=function(){function t(){_classCallCheck(this,t),this._url,this._historyObj=window.history,this.init()}return _createClass(t,[{key:"setHistory",value:function(t,e){e===this._historyObj.state?this._historyObj.replaceState(e,e,t):this._historyObj.pushState(e,e,t)}},{key:"_readHistory",value:function(){var t=document.location.href.split("?"),e=[];void 0!==t[1]?(t[1].split("&").forEach(function(t){e.push(t.split("="))}),console.log(e),i.updateStateFilterFromUrl(e),new l("test.json","get",!0).send()):(i.updateStateFilterFromUrl([]),new l("test.json","get",!0).send())}},{key:"init",value:function(){window.addEventListener("popstate",this._readHistory)}}]),t}(),l=function(){function i(t,e,s){_classCallCheck(this,i),this._url=t,this._type=e,this._productUpdate=s,this.ajax=new XMLHttpRequest}return _createClass(i,[{key:"_progress",value:function(){r.playPreloader()}},{key:"_complete",value:function(){var t=JSON.parse(this.response);!0===productUpdate?(r.updateTitle(t.title),r.updateListProducts(t.elements)):r.addProducts(t.elements),r.stopPreloader(),console.log(t)}},{key:"_completeUpdatePrpoducts",value:function(){var t=JSON.parse(this.response);r.updateTitle(t.title),r.updateListProducts(t.elements),r.stopPreloader(),console.log(t)}},{key:"_completeAddProducts",value:function(){var t=JSON.parse(this.response);r.addProducts(t.elements),r.stopPreloader(),console.log(t)}},{key:"send",value:function(t){var e=this._productUpdate,s=this;this.ajax.addEventListener("progress",this._progress,!1),this.ajax.addEventListener("load",!0===e?s._completeUpdatePrpoducts:s._completeAddProducts,!1),"get"===this._type.toLowerCase()?(this.ajax.open(this._type,this._url),this.ajax.send(),console.log("get")):"post"===this._type.toLowerCase()?console.log("post"):console.log("Error")}}]),i}(),r=new t(document.querySelectorAll(".catalog")[0],"catalog__title","catalog__product","preloader"),i=new e(document.querySelectorAll(".catalog-nav__controls")[0],document.querySelectorAll(".catalog-filter")[0],document.querySelectorAll(".catalog__more")[0]),c=new s;window.filter=i}(),function(){var t=$("header"),e=$(".main-content"),s=t.height();$(window).on("load scroll",function(){$(this).scrollTop()>s?(t.addClass("fixed"),e.css({"padding-top":s})):(t.removeClass("fixed"),e.css({"padding-top":0}))})}(),$(".footer__col-title").on("click",function(t){t.preventDefault(),$(this).closest(".footer__col").find(".footer__col-list").slideToggle(300)}),window.addEventListener("load",function(){if($(".catalog-nav__controls").length){var t=function(){i=s.position().left,a=s.position().top,s.innerWidth(),s.innerHeight(),o.css({left:i,top:a,width:0,height:0})},e=$(".catalog-nav__controls-link"),s=($(".catalog-nav__controls-list"),$(".catalog-nav__controls-item"),$(".catalog-nav__controls-link.is-active")),o=$(".catalog-nav__hover"),i=s.position().left,a=s.position().top,n=(s.innerWidth(),s.innerHeight(),!1);e.hover(function(){var t=$(this).position().left,e=$(this).position().top,s=$(this).innerWidth(),i=$(this).innerHeight();o.css({left:t,top:e,width:s,height:i}),n=!1},function(){setTimeout(function(){n&&o.css({left:i,top:a,width:0,height:0})},1e3),n=!0}),$(window).resize(function(){t()}),t()}}),window.addEventListener("load",function(){$(".delivery__form-input").focusout(function(){""!==$(this).val()?$(this).parent().addClass("value"):$(this).parent().removeClass("value")})}),function(){var t=document.getElementById("scene");if(null!=t)new Parallax(t)}(),function(){var s=function(){function a(t,e,s,i,o){if(_classCallCheck(this,a),void 0===t)return!1;this._self=t,this._price=this._self.querySelectorAll("."+e)[0],this._numPlus=this._self.querySelectorAll("."+s)[0],this._numMinus=this._self.querySelectorAll("."+i)[0],this._del=this._self.querySelectorAll("."+o)[0]}return _createClass(a,[{key:"_delete",value:function(){var t=this;this._del.addEventListener("click",function(){console.log("del"),t._self.remove()})}},{key:"init",value:function(){this._delete()}}]),a}(),i=[];document.querySelectorAll(".basket-products__product").forEach(function(t){var e=new s(t,"basket-products__product-size-num","basket-products__product-num-change--minus","basket-products__product-num-change--plus","basket-products__product-remove");i.push(t),e.init()}),window.productsArr=i}(),$(document).on("click",".slide-info__button",function(){$(this).closest(".slide-info").find(".slide-info__button").toggleClass("is-active"),$(this).closest(".slide-info").find(".slide-info__content").slideToggle(300)});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkZFRvQmFza2V0LmpzIiwiYmFza2V0VGFicy5qcyIsImJ1cmdlci5qcyIsImNhdGFsb2dVcGRhdGVDbGFzcy5qcyIsImZpeGVkSGVhZGVyLmpzIiwiZm9vdGVyTWVudS5qcyIsImhvdmVyUm9sbGVyLmpzIiwibGFiZWxGb3JtLmpzIiwicGFyYWxsYXguanMiLCJwcm90b0Jhc2tldC5qcyIsInNob3dNb3JlLmpzIl0sIm5hbWVzIjpbIiQiLCJkb2N1bWVudCIsIm9uIiwidGhpcyIsImhhc0NsYXNzIiwiYWRkQ2xhc3MiLCJzZXRUaW1lb3V0IiwicmVtb3ZlQ2xhc3MiLCJiaW5kIiwid2luZG93IiwiYWRkRXZlbnRMaXN0ZW5lciIsImxlbmd0aCIsImNsaWNrIiwidGhTdGVwIiwiY2xvc2VzdCIsImZpbmQiLCJhdHRyIiwic2xpZGVyU2xpZGVzIiwiZWFjaCIsInBhZ2lJbmRleCIsIm1lbnVCdG4iLCJnZXRFbGVtZW50QnlJZCIsImNsYXNzTGlzdCIsInRvZ2dsZSIsIm9ucmVzaXplIiwicmVtb3ZlIiwib25zY3JvbGwiLCJDYXRhbG9nIiwic2VsZiIsInRpdGxlQ2xhc3MiLCJwcm9kdWN0c0NvbnRhaW5lckNsYXNzIiwicHJvZHVjdHNQcmVsb2FkZXJDbGFzcyIsIl9jbGFzc0NhbGxDaGVjayIsInVuZGVmaW5lZCIsIl9zZWxmIiwiX3RpdGxlIiwicXVlcnlTZWxlY3RvckFsbCIsIl9wcm9kdWN0cyIsInByZWxvYWRlciIsIl9jcmVhdGVDbGFzcyIsImtleSIsInZhbHVlIiwiaW5uZXJIVE1MIiwiYWRkIiwidGl0bGUiLCJzZXRBdHRyaWJ1dGUiLCJwcm9kdWN0cyIsImluc2VydEFkamFjZW50SFRNTCIsIkZpbHRlciIsImNvbnRhaW5lckJyYW5kcyIsImNvbnRhaW5lckZpbHRlciIsImNvbnRhaW5lck1vcmUiLCJfY29udGFpbmVyQnJhbmRzIiwiX2JyYW5kSXRlbSIsIl9jb250YWluZXJGaWx0ZXIiLCJfZmlsdGVySXRlbSIsInNlYXJjaEl0ZW0iLCJfYWN0aXZlQ2xhc3MiLCJfc29ydFR5cGVBc2MiLCJjbGFzcyIsImRhdGFTb3J0IiwiX3NvcnRUeXBlRGVzYyIsIl9jb250YWluZXJNb3JlIiwidGltZU91dEFqYXgiLCJpbml0IiwiZm9yRWFjaCIsIml0ZW0iLCJwYXJlbnQiLCJyZW1vdmVBdHRyaWJ1dGUiLCJjb25zb2xlIiwibG9nIiwiY29udGFpbnMiLCJwcm9kdWN0VXBkYXRlIiwiZGVsYXkiLCJjbGVhclRpbWVvdXQiLCJicmFuZCIsImdldFF1ZXJ5IiwiYXJyYXlRdWVyeSIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwicHVzaCIsImdldEF0dHJpYnV0ZSIsImpvaW4iLCJoaXN0b3J5T2JqIiwic2V0SGlzdG9yeSIsImFqYXhDb25uZWN0IiwiQWpheEdldFByb2R1Y3RzIiwic2VuZCIsImNhdGFsb2RUZXN0IiwicGxheVByZWxvYWRlciIsImFycmF5UmVzdWx0IiwiX3NlbGVjdEJyYW5kIiwiX2NsZWFuQ2xhc3NGaWx0ZXJBbGwiLCJfYWRkQ2xhc3NGaWx0ZXIiLCJfdG9vZ2xlU29ydCIsIl9xdWVyeUZvcm1hdGlvbiIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJIaXN0b3J5Q29ucnRvbCIsIl91cmwiLCJfaGlzdG9yeU9iaiIsImhpc3RvcnkiLCJzdGF0ZSIsInJlcGxhY2VTdGF0ZSIsInB1c2hTdGF0ZSIsImFycmF5VXJsIiwibG9jYXRpb24iLCJocmVmIiwic3BsaXQiLCJmaWx0ZXIiLCJ1cGRhdGVTdGF0ZUZpbHRlckZyb21VcmwiLCJfcmVhZEhpc3RvcnkiLCJ1cmwiLCJ0eXBlIiwiX3R5cGUiLCJfcHJvZHVjdFVwZGF0ZSIsImFqYXgiLCJYTUxIdHRwUmVxdWVzdCIsInJlc3VsdCIsIkpTT04iLCJwYXJzZSIsInJlc3BvbnNlIiwidXBkYXRlVGl0bGUiLCJ1cGRhdGVMaXN0UHJvZHVjdHMiLCJlbGVtZW50cyIsImFkZFByb2R1Y3RzIiwic3RvcFByZWxvYWRlciIsImRhdGEiLCJfcHJvZ3Jlc3MiLCJfY29tcGxldGVVcGRhdGVQcnBvZHVjdHMiLCJfY29tcGxldGVBZGRQcm9kdWN0cyIsInRvTG93ZXJDYXNlIiwib3BlbiIsImhlYWRlciIsImNvbnRlbnQiLCJoZWFkZXJIZWlnaHQiLCJoZWlnaHQiLCJzY3JvbGxUb3AiLCJjc3MiLCJwYWRkaW5nLXRvcCIsImUiLCJzbGlkZVRvZ2dsZSIsInJlc2l6ZVBvcyIsImFjdGl2ZUxpbmtQb3NMZWZ0IiwiYWN0aXZlTGluayIsInBvc2l0aW9uIiwibGVmdCIsImFjdGl2ZUxpbmtQb3NUb3AiLCJ0b3AiLCJpbm5lcldpZHRoIiwiaW5uZXJIZWlnaHQiLCJob3ZlckJveCIsIndpZHRoIiwibWVudUxpbmsiLCJjaGVjayIsImhvdmVyIiwibmV3TGlua1Bvc0xlZnQiLCJuZXdMaW5rUG9zVG9wIiwibmV3TGlua1dpZHRoIiwibmV3TGlua0hlaWdodCIsInJlc2l6ZSIsImZvY3Vzb3V0IiwidmFsIiwic2NlbmUiLCJQYXJhbGxheCIsImJhc2tldFByb2R1Y3QiLCJwcmljZUJsb2NrIiwibnVtUGx1cyIsIm51bU1pbnVzIiwiZGVsIiwiX3ByaWNlIiwiX251bVBsdXMiLCJfbnVtTWludXMiLCJfZGVsIiwiX2RlbGV0ZSIsInByb2R1Y3RzQXJyIiwicHJvZHVjdCIsInRvZ2dsZUNsYXNzIl0sIm1hcHBpbmdzIjoieXhCQUNJQSxFQUFFQyxVQUFVQyxHQUFHLFFBQVMsa0JBQW1CLFdBQ2xDRixFQUFFRyxNQUFNQyxTQUFTLGFBQ2xCSixFQUFFRyxNQUFNRSxTQUFTLFdBQ2pCTCxFQUFFRyxNQUFNRSxTQUFTLGlCQUNqQkMsV0FBVyxXQUNQTixFQUFFRyxNQUFNSSxZQUFZLGlCQUNwQlAsRUFBRUcsTUFBTUksWUFBWSxZQUN0QkMsS0FBS0wsTUFBTyxRQ050Qk0sT0FBT0MsaUJBQWlCLE9BQVEsV0FFeEJWLEVBQUUsWUFBWVcsUUFFZFgsRUFBRSx3QkFBd0JZLE1BQU0sV0FDNUIsSUFBSUMsRUFBU2IsRUFBRUcsTUFDZixJQUFLVSxFQUFPVCxTQUFTLGFBQWMsQ0FDL0JTLEVBQU9DLFFBQVEsWUFBWUMs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SSxHQUFZLEdBQzVEbEssS0FBS3VLLFNBQVd2SyxLQUFLK0IsTUFBTUUsaUJBQWlCLElBQU1rSSxHQUFTLEdBQzNEbkssS0FBS3dLLFVBQVl4SyxLQUFLK0IsTUFBTUUsaUJBQWlCLElBQU1tSSxHQUFVLEdBQzdEcEssS0FBS3lLLEtBQU96SyxLQUFLK0IsTUFBTUUsaUJBQWlCLElBQU1vSSxHQUFLLEdBWGxELE9BQUFqSSxhQUFBNkgsRUFBQSxDQUFBLENBQUE1SCxJQUFBLFVBQUFDLE1BQUEsV0FlRCxJQUFJYixFQUFPekIsS0FDWEEsS0FBS3lLLEtBQUtsSyxpQkFBaUIsUUFBUyxXQUNoQzJELFFBQVFDLElBQUksT0FDWjFDLEVBQUtNLE1BQU1ULGFBbEJkLENBQUFlLElBQUEsT0FBQUMsTUFBQSxXQXVCRHRDLEtBQUswSyxjQXZCSlQsRUFBQSxHQTRCTFUsRUFBYyxHQUNIN0ssU0FBU21DLGlCQUFpQiw2QkFFaEM2QixRQUFRLFNBQVNDLEdBQ3RCLElBQUk2RyxFQUFVLElBQUlYLEVBQWNsRyxFQUFNLG9DQUFxQyw2Q0FBOEMsNENBQTZDLG1DQUN0SzRHLEVBQVkvRixLQUFLYixHQUNqQjZHLEVBQVEvRyxTQUVadkQsT0FBT3FLLFlBQWNBLEVBcEN4QixHQ0NHOUssRUFBRUMsVUFBVUMsR0FBRyxRQUFTLHNCQUF1QixXQUMzQ0YsRUFBRUcsTUFBTVcsUUFBUSxlQUFlQyxLQUFLLHVCQUF1QmlLLFlBQVksYUFDdkVoTCxFQUFFRyxNQUFNVyxRQUFRLGVBQWVDLEtBQUssd0JBQXdCNkgsWUFBWSIsImZpbGUiOiJtYWluLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIjsoZnVuY3Rpb24oKSB7XHJcbiAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLmJ1dHRvbi0tYmFza2V0JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKCEkKHRoaXMpLmhhc0NsYXNzKCdhbmltYXRlJykpIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnYW5pbWF0ZScpO1xyXG4gICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKFwiYnV0dG9uLS1jaGVja1wiKTtcclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoXCJidXR0b24tLWNoZWNrXCIpO1xyXG4gICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnYW5pbWF0ZScpO1xyXG4gICAgICAgICAgICB9LmJpbmQodGhpcyksIDIwMDApO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59KSgpO1xyXG4iLCI7KGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgIGlmICgkKCcuaHItc2VjdCcpLmxlbmd0aCkge1xyXG5cclxuICAgICAgICAgICAgJChcIi5oci1wYWdpbmF0aW9uX19zdGVwXCIpLmNsaWNrKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRoU3RlcCA9ICQodGhpcyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoU3RlcC5oYXNDbGFzcyhcImlzLWFjdGl2ZVwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoU3RlcC5jbG9zZXN0KCcuaHItc2VjdCcpLmZpbmQoXCIuaHItcGFnaW5hdGlvbl9fc3RlcFwiKS5yZW1vdmVDbGFzcyhcImlzLWFjdGl2ZVwiKS5yZW1vdmVDbGFzcyhcImJ1dHRvblwiKTtcclxuICAgICAgICAgICAgICAgICAgICB0aFN0ZXAuYWRkQ2xhc3MoXCJpcy1hY3RpdmVcIikuYWRkQ2xhc3MoXCJidXR0b25cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhZ2lJbmRleCA9IHRoU3RlcC5hdHRyKFwiZGF0YS1pbmRleFwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNsaWRlclNsaWRlcyA9IHRoU3RlcC5jbG9zZXN0KFwiLmhyLXNlY3RcIikuZmluZChcIi5oci1zbGlkZXItc2xpZGVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgc2xpZGVyU2xpZGVzLnJlbW92ZUNsYXNzKFwiaXMtYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNsaWRlclNsaWRlcy5lYWNoKGZ1bmN0aW9uKHBhZ2lJbmRleCwgdGhTdGVwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkKHRoaXMpLmF0dHIoXCJkYXRhLWluZGV4XCIpID09ICQoXCIuaHItcGFnaW5hdGlvbl9fc3RlcC5pcy1hY3RpdmVcIikuYXR0cihcImRhdGEtaW5kZXhcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoXCJpcy1hY3RpdmVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9KTtcclxuXHJcbn0pKCk7XHJcbiIsIjsoZnVuY3Rpb24oKSB7XHJcbiAgICBsZXQgbWVudUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtZW51LWJ1dHRvbicpO1xyXG5cclxuICAgIG1lbnVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBtZW51QnRuLmNsYXNzTGlzdC50b2dnbGUoJ29wZW5lZCcpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgd2luZG93Lm9ucmVzaXplID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbWVudUJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdvcGVuZWQnKTtcclxuICAgIH1cclxuICAgIHdpbmRvdy5vbnNjcm9sbCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIG1lbnVCdG4uY2xhc3NMaXN0LnJlbW92ZSgnb3BlbmVkJyk7XHJcbiAgICB9XHJcbn0pKCk7XHJcbiIsIjsoZnVuY3Rpb24oKXtcblxuICAgIGNsYXNzIENhdGFsb2cge1xuICAgICAgICBjb25zdHJ1Y3RvcihzZWxmLCB0aXRsZUNsYXNzLCBwcm9kdWN0c0NvbnRhaW5lckNsYXNzLCBwcm9kdWN0c1ByZWxvYWRlckNsYXNzKXtcbiAgICAgICAgICAgIGlmIChzZWxmID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9zZWxmID0gc2VsZjtcbiAgICAgICAgICAgIHRoaXMuX3RpdGxlID0gdGhpcy5fc2VsZi5xdWVyeVNlbGVjdG9yQWxsKFwiLlwiICsgdGl0bGVDbGFzcylbMF07XG4gICAgICAgICAgICB0aGlzLl9wcm9kdWN0cyA9IHRoaXMuX3NlbGYucXVlcnlTZWxlY3RvckFsbChcIi5cIiArIHByb2R1Y3RzQ29udGFpbmVyQ2xhc3MpWzBdO1xuICAgICAgICAgICAgdGhpcy5wcmVsb2FkZXIgPSB0aGlzLl9zZWxmLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuXCIgKyBwcm9kdWN0c1ByZWxvYWRlckNsYXNzKVswXTtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgX2NsZWFuUHJvZHVjdHMoKSB7XG4gICAgICAgICAgICB0aGlzLl9wcm9kdWN0cy5pbm5lckhUTUwgPSBcIlwiO1xuICAgICAgICB9XG5cbiAgICAgICAgcGxheVByZWxvYWRlcigpIHtcbiAgICAgICAgICAgIHRoaXMucHJlbG9hZGVyLmNsYXNzTGlzdC5hZGQoXCJwcmVsb2FkZXItLWFjdGl2ZVwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHN0b3BQcmVsb2FkZXIoKSB7XG4gICAgICAgICAgICB0aGlzLnByZWxvYWRlci5jbGFzc0xpc3QucmVtb3ZlKFwicHJlbG9hZGVyLS1hY3RpdmVcIik7XG4gICAgICAgIH1cblxuICAgICAgICB1cGRhdGVUaXRsZSh0aXRsZSkge1xuICAgICAgICAgICAgdGhpcy5fdGl0bGUuaW5uZXJIVE1MID0gdGl0bGU7XG4gICAgICAgICAgICB0aGlzLl90aXRsZS5zZXRBdHRyaWJ1dGUoXCJkYXRhLW5hbWVcIiwgdGl0bGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgdXBkYXRlTGlzdFByb2R1Y3RzKHByb2R1Y3RzKSB7XG4gICAgICAgICAgICB0aGlzLl9wcm9kdWN0cy5pbm5lckhUTUwgPSBwcm9kdWN0cztcbiAgICAgICAgfVxuXG4gICAgICAgIGFkZFByb2R1Y3RzKHByb2R1Y3RzKSB7XG4gICAgICAgICAgICB0aGlzLl9wcm9kdWN0cy5pbnNlcnRBZGphY2VudEhUTUwoXCJiZWZvcmVlbmRcIiwgcHJvZHVjdHMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2xhc3MgRmlsdGVyIHtcbiAgICAgICAgY29uc3RydWN0b3IoY29udGFpbmVyQnJhbmRzLCBjb250YWluZXJGaWx0ZXIsIGNvbnRhaW5lck1vcmUpIHtcbiAgICAgICAgICAgIGlmIChjb250YWluZXJCcmFuZHMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjb250YWluZXJGaWx0ZXIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjb250YWluZXJNb3JlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX2NvbnRhaW5lckJyYW5kcyA9IGNvbnRhaW5lckJyYW5kcztcbiAgICAgICAgICAgIHRoaXMuX2JyYW5kSXRlbSA9IHRoaXMuX2NvbnRhaW5lckJyYW5kcy5xdWVyeVNlbGVjdG9yQWxsKFwiLmNhdGFsb2ctbmF2X19jb250cm9scy1saW5rXCIpO1xuXG4gICAgICAgICAgICB0aGlzLl9jb250YWluZXJGaWx0ZXIgPSBjb250YWluZXJGaWx0ZXI7XG4gICAgICAgICAgICB0aGlzLl9maWx0ZXJJdGVtID0gdGhpcy5fY29udGFpbmVyRmlsdGVyLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2F0YWxvZy1maWx0ZXJfX2NvbC1idG5cIik7XG4gICAgICAgICAgICB0aGlzLnNlYXJjaEl0ZW0gPSB0aGlzLl9jb250YWluZXJGaWx0ZXIucXVlcnlTZWxlY3RvckFsbChcIi5jYXRhbG9nLWZpbHRlcl9fZm9ybVwiKVswXTtcbiAgICAgICAgICAgIHRoaXMuX2FjdGl2ZUNsYXNzID0gXCJpcy1hY3RpdmVcIjtcbiAgICAgICAgICAgIHRoaXMuX3NvcnRUeXBlQXNjID0ge1xuICAgICAgICAgICAgICAgIGNsYXNzOiBcInNvcnQtZG93blwiLFxuICAgICAgICAgICAgICAgIGRhdGFTb3J0OiBcImFzY1wiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGhpcy5fc29ydFR5cGVEZXNjID0ge1xuICAgICAgICAgICAgICAgIGNsYXNzOiBcInNvcnQtdXBcIixcbiAgICAgICAgICAgICAgICBkYXRhU29ydDogXCJkZXNjXCJcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fY29udGFpbmVyTW9yZSA9IGNvbnRhaW5lck1vcmU7XG5cbiAgICAgICAgICAgIHRoaXMudGltZU91dEFqYXg7XG4gICAgICAgICAgICB0aGlzLmluaXQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIF9jbGVhbkNsYXNzRmlsdGVyQWxsKCkge1xuICAgICAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICB0aGlzLl9maWx0ZXJJdGVtLmZvckVhY2goZnVuY3Rpb24oaXRlbSl7XG4gICAgICAgICAgICAgICAgbGV0IHBhcmVudCA9IGl0ZW0uY2xvc2VzdChcIi5jYXRhbG9nLWZpbHRlcl9fY29sXCIpO1xuXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZShzZWxmLl9hY3RpdmVDbGFzcyk7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZShzZWxmLl9zb3J0VHlwZUFzYy5jbGFzcyk7XG4gICAgICAgICAgICAgICAgICAgIHBhcmVudC5yZW1vdmVBdHRyaWJ1dGUoXCJkYXRhLXNvcnRcIik7XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgX2FkZENsYXNzRmlsdGVyKGl0ZW0pIHtcbiAgICAgICAgICAgIGxldCBwYXJlbnQgPSBpdGVtLmNsb3Nlc3QoXCIuY2F0YWxvZy1maWx0ZXJfX2NvbFwiKTtcblxuICAgICAgICAgICAgY29uc29sZS5sb2coaXRlbSk7XG5cbiAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZCh0aGlzLl9hY3RpdmVDbGFzcyk7XG4gICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQodGhpcy5fc29ydFR5cGVBc2MuY2xhc3MpO1xuXG4gICAgICAgICAgICBwYXJlbnQuc2V0QXR0cmlidXRlKFwiZGF0YS1zb3J0XCIsIHRoaXMuX3NvcnRUeXBlQXNjLmRhdGFTb3J0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIF90b29nbGVTb3J0KGl0ZW0pIHtcbiAgICAgICAgICAgIGxldCBwYXJlbnQgPSBpdGVtLmNsb3Nlc3QoXCIuY2F0YWxvZy1maWx0ZXJfX2NvbFwiKTtcblxuICAgICAgICAgICAgaWYgKGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKHRoaXMuX3NvcnRUeXBlQXNjLmNsYXNzKSkge1xuICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zb3J0VHlwZUFzYy5jbGFzcyk7XG4gICAgICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKHRoaXMuX3NvcnRUeXBlRGVzYy5jbGFzcyk7XG5cbiAgICAgICAgICAgICAgICBwYXJlbnQuc2V0QXR0cmlidXRlKFwiZGF0YS1zb3J0XCIsIHRoaXMuX3NvcnRUeXBlRGVzYy5kYXRhU29ydCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zb3J0VHlwZURlc2MuY2xhc3MpO1xuICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZCh0aGlzLl9zb3J0VHlwZUFzYy5jbGFzcyk7XG5cbiAgICAgICAgICAgICAgICBwYXJlbnQuc2V0QXR0cmlidXRlKFwiZGF0YS1zb3J0XCIsIHRoaXMuX3NvcnRUeXBlQXNjLmRhdGFTb3J0KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cbiAgICAgICAgX3NlbGVjdEJyYW5kKGl0ZW0pIHtcbiAgICAgICAgICAgIGlmICghaXRlbS5jbGFzc0xpc3QuY29udGFpbnMoXCJpcy1hY3RpdmVcIikpe1xuICAgICAgICAgICAgICAgIHRoaXMuX2JyYW5kSXRlbS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKFwiaXMtYWN0aXZlXCIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZChcImlzLWFjdGl2ZVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIF9xdWVyeUZvcm1hdGlvbihwcm9kdWN0VXBkYXRlLCBkZWxheSkge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZU91dEFqYXgpO1xuICAgICAgICAgICAgLy/QnNC10YLQvtC0INGE0L7RgNC80LjRgNC+0LLQsNC90LjRjyBnZXQg0LfQsNC/0YDQvtGB0LBcbiAgICAgICAgICAgIGxldCBhcnJheVF1ZXJ5ID0gW10sXG4gICAgICAgICAgICAgICAgc2VhcmNoSXRlbSA9IHRoaXMuc2VhcmNoSXRlbS5nZXRFbGVtZW50c0J5VGFnTmFtZShcImlucHV0XCIpWzBdLFxuICAgICAgICAgICAgICAgIGJyYW5kLFxuICAgICAgICAgICAgICAgIGdldFF1ZXJ5O1xuXG4gICAgICAgICAgICB0aGlzLl9icmFuZEl0ZW0uZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKFwiaXMtYWN0aXZlXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIGFycmF5UXVlcnkucHVzaChcImJyYW5kPVwiICsgaXRlbS5nZXRBdHRyaWJ1dGUoXCJkYXRhLWJyYW5kXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgYnJhbmQgPSBpdGVtLmdldEF0dHJpYnV0ZShcImRhdGEtYnJhbmRcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMuX2ZpbHRlckl0ZW0uZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICAgICAgbGV0IHBhcmVudCA9IGl0ZW0uY2xvc2VzdChcIi5jYXRhbG9nLWZpbHRlcl9fY29sXCIpO1xuICAgICAgICAgICAgICAgIGlmIChpdGVtLmNsYXNzTGlzdC5jb250YWlucyhcImlzLWFjdGl2ZVwiKSkge1xuICAgICAgICAgICAgICAgICAgICBhcnJheVF1ZXJ5LnB1c2goXCJzb3J0PVwiICsgcGFyZW50LmdldEF0dHJpYnV0ZShcImRhdGEtc29ydFwiKSk7XG4gICAgICAgICAgICAgICAgICAgIGFycmF5UXVlcnkucHVzaChcInNvcnRUeXBlPVwiICsgcGFyZW50LmdldEF0dHJpYnV0ZShcImRhdGEtZmlsdGVyXCIpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKHNlYXJjaEl0ZW0udmFsdWUgIT09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICBhcnJheVF1ZXJ5LnB1c2goXCJzZWFyY2g9XCIgKyBzZWFyY2hJdGVtLnZhbHVlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZ2V0UXVlcnkgPSBcIj9cIiArIGFycmF5UXVlcnkuam9pbihcIiZcIik7XG5cbiAgICAgICAgICAgIGhpc3RvcnlPYmouc2V0SGlzdG9yeShnZXRRdWVyeSwgYnJhbmQpO1xuXG4gICAgICAgICAgICAvL1RvZG86INC30LTQtdGB0Ywg0L3QsNC00L4g0LHRg9C00LXRgiDRgdC00LXQu9Cw0YLRjCDQsNC60YLRg9Cw0LvRjNC90YvQuSDRg9GA0Lsg0LTQu9GPIGFqYXgg0LfQsNC/0YDQvtGB0L7QslxuICAgICAgICAgICAgLy8g0J/RgNC40LzQtdGAOiBsZXQgYWpheENvbm5lY3QgPSBuZXcgQWpheEdldFByb2R1Y3RzKHdpbmRvdy5sb2NhdGlvbi5ocmVmICsgZ2V0UXVlcnksIFwiZ2V0XCIsIHRydWUpO1xuICAgICAgICAgICAgbGV0IGFqYXhDb25uZWN0ID0gbmV3IEFqYXhHZXRQcm9kdWN0cyhcInRlc3QuanNvblwiLCBcImdldFwiLCBwcm9kdWN0VXBkYXRlKTtcblxuICAgICAgICAgICAgaWYgKGRlbGF5ID09PSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgIGFqYXhDb25uZWN0LnNlbmQoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY2F0YWxvZFRlc3QucGxheVByZWxvYWRlcigpO1xuICAgICAgICAgICAgICAgIHRoaXMudGltZU91dEFqYXggPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgIGFqYXhDb25uZWN0LnNlbmQoKTtcbiAgICAgICAgICAgICAgICB9LCBkZWxheSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc29sZS5sb2coZ2V0UXVlcnkpO1xuXG4gICAgICAgIH1cblxuICAgICAgICB1cGRhdGVTdGF0ZUZpbHRlckZyb21VcmwoYXJyYXlSZXN1bHQpIHtcbiAgICAgICAgICAgIC8vIHVwZGF0ZVN0YXRlRmlsdGVyRnJvbVVybChhcnJheVJlc3VsdFswXVsxXSwgYXJyYXlSZXN1bHRbMl1bMV0sIGFycmF5UmVzdWx0WzFdWzFdLCBhcnJheVJlc3VsdFszXVsxXSlcbiAgICAgICAgICAgIGxldCBzZWxmID0gdGhpcztcblxuXG4gICAgICAgICAgICBpZiAoYXJyYXlSZXN1bHRbMF0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2JyYW5kSXRlbS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uZ2V0QXR0cmlidXRlKFwiZGF0YS1icmFuZFwiKSA9PT0gYXJyYXlSZXN1bHRbMF1bMV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3NlbGVjdEJyYW5kKGl0ZW0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc2VsZWN0QnJhbmQodGhpcy5fYnJhbmRJdGVtWzBdKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGFycmF5UmVzdWx0WzJdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9maWx0ZXJJdGVtLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS5jbG9zZXN0KFwiLmNhdGFsb2ctZmlsdGVyX19jb2xcIikuZ2V0QXR0cmlidXRlKFwiZGF0YS1maWx0ZXJcIikgPT09IGFycmF5UmVzdWx0WzJdWzFdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9jbGVhbkNsYXNzRmlsdGVyQWxsKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9hZGRDbGFzc0ZpbHRlcihpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uY2xvc2VzdChcIi5jYXRhbG9nLWZpbHRlcl9fY29sXCIpLnNldEF0dHJpYnV0ZShcImRhdGEtc29ydFwiLCBhcnJheVJlc3VsdFsxXVsxXSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhcnJheVJlc3VsdFsxXVsxXSA9PT0gXCJhc2NcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZChzZWxmLl9zb3J0VHlwZUFzYy5jbGFzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKHNlbGYuX3NvcnRUeXBlRGVzYy5jbGFzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZShzZWxmLl9zb3J0VHlwZUFzYy5jbGFzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKHNlbGYuX3NvcnRUeXBlRGVzYy5jbGFzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9maWx0ZXJJdGVtLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS5jbG9zZXN0KFwiLmNhdGFsb2ctZmlsdGVyX19jb2xcIikuZ2V0QXR0cmlidXRlKFwiZGF0YS1maWx0ZXJcIikgPT09IFwibmFtZVwiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2NsZWFuQ2xhc3NGaWx0ZXJBbGwoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2FkZENsYXNzRmlsdGVyKGl0ZW0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChhcnJheVJlc3VsdFszXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYXJyYXlSZXN1bHRbM11bMV0pO1xuICAgICAgICAgICAgICAgIHNlbGYuc2VhcmNoSXRlbS5nZXRFbGVtZW50c0J5VGFnTmFtZShcImlucHV0XCIpWzBdLnZhbHVlID0gYXJyYXlSZXN1bHRbM11bMV07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHNlbGYuc2VhcmNoSXRlbS5nZXRFbGVtZW50c0J5VGFnTmFtZShcImlucHV0XCIpWzBdLnZhbHVlID0gXCJcIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cbiAgICAgICAgaW5pdCgpIHtcbiAgICAgICAgICAgIGxldCBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMuX2ZpbHRlckl0ZW0uZm9yRWFjaChmdW5jdGlvbihpdGVtKXtcbiAgICAgICAgICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKHNlbGYuX2FjdGl2ZUNsYXNzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fdG9vZ2xlU29ydCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v0JLRi9C30L7QsiDQvNC10YLQvtC00LAg0YTQvtGA0LzQuNGA0L7QstCw0L3QuNGPIEdldCDQt9Cw0L/RgNC+0YHQsFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fcXVlcnlGb3JtYXRpb24odHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9jbGVhbkNsYXNzRmlsdGVyQWxsKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9hZGRDbGFzc0ZpbHRlcih0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v0JLRi9C30L7QsiDQvNC10YLQvtC00LAg0YTQvtGA0LzQuNGA0L7QstCw0L3QuNGPIEdldCDQt9Cw0L/RgNC+0YHQsFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fcXVlcnlGb3JtYXRpb24odHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLl9icmFuZEl0ZW0uZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmNsYXNzTGlzdC5jb250YWlucyhcImlzLWFjdGl2ZVwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fc2VsZWN0QnJhbmQodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL9CS0YvQt9C+0LIg0LzQtdGC0L7QtNCwINGE0L7RgNC80LjRgNC+0LLQsNC90LjRjyBHZXQg0LfQsNC/0YDQvtGB0LBcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3F1ZXJ5Rm9ybWF0aW9uKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIHRoaXMuc2VhcmNoSXRlbS5nZXRFbGVtZW50c0J5VGFnTmFtZShcImlucHV0XCIpWzBdLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAvL9CS0YvQt9C+0LIg0LzQtdGC0L7QtNCwINGE0L7RgNC80LjRgNC+0LLQsNC90LjRjyBHZXQg0LfQsNC/0YDQvtGB0LBcbiAgICAgICAgICAgICAgICBzZWxmLl9xdWVyeUZvcm1hdGlvbih0cnVlLCAxMDAwKTtcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIHRoaXMuX2NvbnRhaW5lck1vcmUucXVlcnlTZWxlY3RvckFsbChcIi5jYXRhbG9nX19tb3JlLWJ1dHRvblwiKVswXS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHNlbGYuX3F1ZXJ5Rm9ybWF0aW9uKGZhbHNlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2xhc3MgSGlzdG9yeUNvbnJ0b2wge1xuICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgIHRoaXMuX3VybDtcbiAgICAgICAgICAgIHRoaXMuX2hpc3RvcnlPYmogPSB3aW5kb3cuaGlzdG9yeTtcblxuICAgICAgICAgICAgdGhpcy5pbml0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBzZXRIaXN0b3J5KGdldFF1ZXJ5LCBicmFuZCkge1xuICAgICAgICAgICAgaWYgKGJyYW5kID09PSB0aGlzLl9oaXN0b3J5T2JqLnN0YXRlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faGlzdG9yeU9iai5yZXBsYWNlU3RhdGUoYnJhbmQsIGJyYW5kLCBnZXRRdWVyeSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX2hpc3RvcnlPYmoucHVzaFN0YXRlKGJyYW5kLCBicmFuZCwgZ2V0UXVlcnkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgX3JlYWRIaXN0b3J5KCkge1xuICAgICAgICAgICAgbGV0IHVybCA9IGRvY3VtZW50LmxvY2F0aW9uLmhyZWYsXG4gICAgICAgICAgICAgICAgYXJyYXlVcmwgPSB1cmwuc3BsaXQoXCI/XCIpLFxuICAgICAgICAgICAgICAgIGFycmF5R2V0ID0gW10sXG4gICAgICAgICAgICAgICAgYXJyYXlSZXN1bHQgPSBbXTtcblxuICAgICAgICAgICAgICAgIGlmIChhcnJheVVybFsxXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGFycmF5R2V0ID0gYXJyYXlVcmxbMV0uc3BsaXQoXCImXCIpO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgYXJyYXlHZXQuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcnJheVJlc3VsdC5wdXNoKGl0ZW0uc3BsaXQoXCI9XCIpKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhhcnJheVJlc3VsdCk7XG5cbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyLnVwZGF0ZVN0YXRlRmlsdGVyRnJvbVVybChhcnJheVJlc3VsdCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9Ub2RvOiDQt9C00LXRgdGMINC90LDQtNC+INCx0YPQtNC10YIg0YHQtNC10LvQsNGC0Ywg0LDQutGC0YPQsNC70YzQvdGL0Lkg0YPRgNC7INC00LvRjyBhamF4INC30LDQv9GA0L7RgdC+0LJcbiAgICAgICAgICAgICAgICAgICAgLy8g0J/RgNC40LzQtdGAOiBsZXQgYWpheENvbm5lY3QgPSBuZXcgQWpheEdldFByb2R1Y3RzKHVybCwgXCJnZXRcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBhamF4Q29ubmVjdCA9IG5ldyBBamF4R2V0UHJvZHVjdHMoXCJ0ZXN0Lmpzb25cIiwgXCJnZXRcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGFqYXhDb25uZWN0LnNlbmQoKTtcblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyLnVwZGF0ZVN0YXRlRmlsdGVyRnJvbVVybChbXSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9Ub2RvOiDQt9C00LXRgdGMINC90LDQtNC+INCx0YPQtNC10YIg0YHQtNC10LvQsNGC0Ywg0LDQutGC0YPQsNC70YzQvdGL0Lkg0YPRgNC7INC00LvRjyBhamF4INC30LDQv9GA0L7RgdC+0LJcbiAgICAgICAgICAgICAgICAgICAgLy8g0J/RgNC40LzQtdGAOiBsZXQgYWpheENvbm5lY3QgPSBuZXcgQWpheEdldFByb2R1Y3RzKHVybCwgXCJnZXRcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBhamF4Q29ubmVjdCA9IG5ldyBBamF4R2V0UHJvZHVjdHMoXCJ0ZXN0Lmpzb25cIiwgXCJnZXRcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGFqYXhDb25uZWN0LnNlbmQoKTtcblxuICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgIH1cblxuICAgICAgICBpbml0KCkge1xuICAgICAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInBvcHN0YXRlXCIsIHNlbGYuX3JlYWRIaXN0b3J5KTtcbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgY2xhc3MgQWpheEdldFByb2R1Y3RzIHtcbiAgICAgICAgY29uc3RydWN0b3IodXJsLCB0eXBlLCBwcm9kdWN0VXBkYXRlKSB7XG4gICAgICAgICAgICB0aGlzLl91cmwgPSB1cmw7XG4gICAgICAgICAgICB0aGlzLl90eXBlID0gdHlwZTtcbiAgICAgICAgICAgIHRoaXMuX3Byb2R1Y3RVcGRhdGUgPSBwcm9kdWN0VXBkYXRlO1xuICAgICAgICAgICAgdGhpcy5hamF4ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBfcHJvZ3Jlc3MoKSB7XG4gICAgICAgICAgICBjYXRhbG9kVGVzdC5wbGF5UHJlbG9hZGVyKCk7XG4gICAgICAgIH1cblxuICAgICAgICBfY29tcGxldGUoKSB7XG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gSlNPTi5wYXJzZSh0aGlzLnJlc3BvbnNlKTtcblxuICAgICAgICAgICAgaWYgKHByb2R1Y3RVcGRhdGUgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICBjYXRhbG9kVGVzdC51cGRhdGVUaXRsZShyZXN1bHQudGl0bGUpO1xuICAgICAgICAgICAgICAgIGNhdGFsb2RUZXN0LnVwZGF0ZUxpc3RQcm9kdWN0cyhyZXN1bHQuZWxlbWVudHMpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjYXRhbG9kVGVzdC5hZGRQcm9kdWN0cyhyZXN1bHQuZWxlbWVudHMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXRhbG9kVGVzdC5zdG9wUHJlbG9hZGVyKCk7XG5cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIF9jb21wbGV0ZVVwZGF0ZVBycG9kdWN0cygpIHtcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSBKU09OLnBhcnNlKHRoaXMucmVzcG9uc2UpO1xuXG4gICAgICAgICAgICBjYXRhbG9kVGVzdC51cGRhdGVUaXRsZShyZXN1bHQudGl0bGUpO1xuICAgICAgICAgICAgY2F0YWxvZFRlc3QudXBkYXRlTGlzdFByb2R1Y3RzKHJlc3VsdC5lbGVtZW50cyk7XG5cbiAgICAgICAgICAgIGNhdGFsb2RUZXN0LnN0b3BQcmVsb2FkZXIoKTtcblxuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIF9jb21wbGV0ZUFkZFByb2R1Y3RzKCkge1xuICAgICAgICAgICAgbGV0IHJlc3VsdCA9IEpTT04ucGFyc2UodGhpcy5yZXNwb25zZSk7XG5cbiAgICAgICAgICAgIGNhdGFsb2RUZXN0LmFkZFByb2R1Y3RzKHJlc3VsdC5lbGVtZW50cyk7XG5cbiAgICAgICAgICAgIGNhdGFsb2RUZXN0LnN0b3BQcmVsb2FkZXIoKTtcblxuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgc2VuZChkYXRhKSB7XG4gICAgICAgICAgICBsZXQgcHJvZHVjdFVwZGF0ZSA9IHRoaXMuX3Byb2R1Y3RVcGRhdGUsXG4gICAgICAgICAgICAgICAgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHRoaXMuYWpheC5hZGRFdmVudExpc3RlbmVyKFwicHJvZ3Jlc3NcIiwgdGhpcy5fcHJvZ3Jlc3MsIGZhbHNlKTtcbiAgICAgICAgICAgIHRoaXMuYWpheC5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCAoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgaWYgKHByb2R1Y3RVcGRhdGUgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2NvbXBsZXRlVXBkYXRlUHJwb2R1Y3RzO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLl9jb21wbGV0ZUFkZFByb2R1Y3RzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKCksIGZhbHNlKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX3R5cGUudG9Mb3dlckNhc2UoKSA9PT0gXCJnZXRcIikge1xuXG4gICAgICAgICAgICAgICAgdGhpcy5hamF4Lm9wZW4odGhpcy5fdHlwZSwgdGhpcy5fdXJsKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFqYXguc2VuZCgpO1xuXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJnZXRcIik7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX3R5cGUudG9Mb3dlckNhc2UoKSA9PT0gXCJwb3N0XCIpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInBvc3RcIik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3JcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cblxuICAgIGxldCBjYXRhbG9kVGVzdCA9IG5ldyBDYXRhbG9nKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2F0YWxvZ1wiKVswXSwgXCJjYXRhbG9nX190aXRsZVwiLCBcImNhdGFsb2dfX3Byb2R1Y3RcIiwgXCJwcmVsb2FkZXJcIik7XG5cbiAgICBsZXQgZmlsdGVyID0gbmV3IEZpbHRlcihkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNhdGFsb2ctbmF2X19jb250cm9sc1wiKVswXSwgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jYXRhbG9nLWZpbHRlclwiKVswXSwgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jYXRhbG9nX19tb3JlXCIpWzBdKTtcblxuICAgIGxldCBoaXN0b3J5T2JqID0gbmV3IEhpc3RvcnlDb25ydG9sKCk7XG5cbiAgICAvL9Ci0LXRgdGCXG4gICAgLy8gd2luZG93LmRpdkFycmF5ID0gZGl2QXJyYXk7XG4gICAgd2luZG93LmZpbHRlciA9IGZpbHRlcjtcbn0pKCk7XG4iLCI7KGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIGhlYWRlciA9ICQoJ2hlYWRlcicpO1xyXG4gICAgdmFyIGNvbnRlbnQgPSAkKCcubWFpbi1jb250ZW50Jyk7XHJcbiAgICB2YXIgaGVhZGVySGVpZ2h0ID0gaGVhZGVyLmhlaWdodCgpO1xyXG5cclxuICAgICQod2luZG93KS5vbignbG9hZCBzY3JvbGwnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoJCh0aGlzKS5zY3JvbGxUb3AoKSA+IGhlYWRlckhlaWdodCkge1xyXG4gICAgICAgICAgICBoZWFkZXIuYWRkQ2xhc3MoJ2ZpeGVkJyk7XHJcbiAgICAgICAgICAgIGNvbnRlbnQuY3NzKHsncGFkZGluZy10b3AnIDogaGVhZGVySGVpZ2h0fSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBoZWFkZXIucmVtb3ZlQ2xhc3MoJ2ZpeGVkJyk7XHJcbiAgICAgICAgICAgIGNvbnRlbnQuY3NzKHsncGFkZGluZy10b3AnIDogMH0pXHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn0pKCk7XHJcbiIsIjsoZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgYnV0dG9uID0gJCgnLmZvb3Rlcl9fY29sLXRpdGxlJyk7XHJcblxyXG4gICAgYnV0dG9uLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgJCh0aGlzKS5jbG9zZXN0KCcuZm9vdGVyX19jb2wnKS5maW5kKCcuZm9vdGVyX19jb2wtbGlzdCcpLnNsaWRlVG9nZ2xlKDMwMCk7XHJcbiAgICB9KTtcclxufSkoKTtcclxuIiwiOyhmdW5jdGlvbigpIHtcclxuXHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICBpZiAoJCgnLmNhdGFsb2ctbmF2X19jb250cm9scycpLmxlbmd0aCkge1xyXG5cclxuICAgICAgICAgICAgdmFyIG1lbnVMaW5rID0gJCgnLmNhdGFsb2ctbmF2X19jb250cm9scy1saW5rJyksXHJcbiAgICAgICAgICAgICAgICBtZW51ID0gJCgnLmNhdGFsb2ctbmF2X19jb250cm9scy1saXN0Jyk7XHJcblxyXG4gICAgICAgICAgICB2YXIgbWVudUl0ZW0gPSAkKCcuY2F0YWxvZy1uYXZfX2NvbnRyb2xzLWl0ZW0nKSxcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUxpbmsgPSAkKCcuY2F0YWxvZy1uYXZfX2NvbnRyb2xzLWxpbmsuaXMtYWN0aXZlJyksXHJcbiAgICAgICAgICAgICAgICBob3ZlckJveCA9ICQoJy5jYXRhbG9nLW5hdl9faG92ZXInKSxcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUxpbmtQb3NMZWZ0ID0gYWN0aXZlTGluay5wb3NpdGlvbigpLmxlZnQsXHJcbiAgICAgICAgICAgICAgICBhY3RpdmVMaW5rUG9zVG9wID0gYWN0aXZlTGluay5wb3NpdGlvbigpLnRvcCxcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUxpbmtXaWR0aCA9IGFjdGl2ZUxpbmsuaW5uZXJXaWR0aCgpLFxyXG4gICAgICAgICAgICAgICAgYWN0aXZlTGlua0hlaWdodCA9IGFjdGl2ZUxpbmsuaW5uZXJIZWlnaHQoKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBjaGVjayA9IGZhbHNlO1xyXG4gICAgICAgICAgICBtZW51TGluay5ob3ZlcihcclxuICAgICAgICAgICAgICBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHZhciBuZXdMaW5rUG9zTGVmdCA9ICQodGhpcykucG9zaXRpb24oKS5sZWZ0LFxyXG4gICAgICAgICAgICAgICAgICAgIG5ld0xpbmtQb3NUb3AgPSAkKHRoaXMpLnBvc2l0aW9uKCkudG9wLFxyXG4gICAgICAgICAgICAgICAgICAgIG5ld0xpbmtXaWR0aCA9ICQodGhpcykuaW5uZXJXaWR0aCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIG5ld0xpbmtIZWlnaHQgPSAkKHRoaXMpLmlubmVySGVpZ2h0KCk7XHJcbiAgICAgICAgICAgICAgICBob3ZlckJveC5jc3MoeydsZWZ0JyA6IG5ld0xpbmtQb3NMZWZ0LCAndG9wJyA6IG5ld0xpbmtQb3NUb3AsICd3aWR0aCcgOiBuZXdMaW5rV2lkdGgsICdoZWlnaHQnIDogbmV3TGlua0hlaWdodH0pO1xyXG4gICAgICAgICAgICAgICAgY2hlY2sgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgaWYgKGNoZWNrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaG92ZXJCb3guY3NzKHsnbGVmdCcgOiBhY3RpdmVMaW5rUG9zTGVmdCwgJ3RvcCcgOiBhY3RpdmVMaW5rUG9zVG9wLCAnd2lkdGgnIDogMCwgJ2hlaWdodCcgOiAwfSk7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sIDEwMDApO1xyXG4gICAgICAgICAgICAgICAgY2hlY2sgPSB0cnVlO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlc2l6ZVBvcygpIHtcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUxpbmtQb3NMZWZ0ID0gYWN0aXZlTGluay5wb3NpdGlvbigpLmxlZnQsXHJcbiAgICAgICAgICAgICAgICBhY3RpdmVMaW5rUG9zVG9wID0gYWN0aXZlTGluay5wb3NpdGlvbigpLnRvcCxcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUxpbmtXaWR0aCA9IGFjdGl2ZUxpbmsuaW5uZXJXaWR0aCgpLFxyXG4gICAgICAgICAgICAgICAgYWN0aXZlTGlua0hlaWdodCA9IGFjdGl2ZUxpbmsuaW5uZXJIZWlnaHQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBob3ZlckJveC5jc3MoeydsZWZ0JyA6IGFjdGl2ZUxpbmtQb3NMZWZ0LCAndG9wJyA6IGFjdGl2ZUxpbmtQb3NUb3AsICd3aWR0aCcgOiAwLCAnaGVpZ2h0JyA6IDB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgJCh3aW5kb3cpLnJlc2l6ZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHJlc2l6ZVBvcygpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmVzaXplUG9zKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG5cclxufSkoKTtcclxuIiwiOyhmdW5jdGlvbigpIHtcclxuXHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAkKCcuZGVsaXZlcnlfX2Zvcm0taW5wdXQnKS5mb2N1c291dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgaWYgKCQodGhpcykudmFsKCkgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuYWRkQ2xhc3MoJ3ZhbHVlJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5yZW1vdmVDbGFzcygndmFsdWUnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9KTtcclxuXHJcbn0pKCk7XHJcbiIsIjsoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgbGV0IHNjZW5lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjZW5lJyk7XHJcbiAgICBpZiAoc2NlbmUgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgbGV0IHBhcmFsbGF4SW5zdGFuY2UgPSBuZXcgUGFyYWxsYXgoc2NlbmUpO1xyXG4gICAgfVxyXG5cclxufSkoKTtcclxuIiwiOyhmdW5jdGlvbigpIHtcclxuXHJcbiAgICBjbGFzcyBiYXNrZXRQcm9kdWN0IHtcclxuICAgICAgICBjb25zdHJ1Y3RvcihzZWxmLCBwcmljZUJsb2NrLCBudW1QbHVzLCBudW1NaW51cywgZGVsKSB7XHJcbiAgICAgICAgICAgIGlmIChzZWxmID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLl9zZWxmID0gc2VsZjtcclxuICAgICAgICAgICAgdGhpcy5fcHJpY2UgPSB0aGlzLl9zZWxmLnF1ZXJ5U2VsZWN0b3JBbGwoJy4nICsgcHJpY2VCbG9jaylbMF07XHJcbiAgICAgICAgICAgIHRoaXMuX251bVBsdXMgPSB0aGlzLl9zZWxmLnF1ZXJ5U2VsZWN0b3JBbGwoJy4nICsgbnVtUGx1cylbMF07XHJcbiAgICAgICAgICAgIHRoaXMuX251bU1pbnVzID0gdGhpcy5fc2VsZi5xdWVyeVNlbGVjdG9yQWxsKCcuJyArIG51bU1pbnVzKVswXTtcclxuICAgICAgICAgICAgdGhpcy5fZGVsID0gdGhpcy5fc2VsZi5xdWVyeVNlbGVjdG9yQWxsKCcuJyArIGRlbClbMF07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBfZGVsZXRlKCkge1xyXG4gICAgICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIHRoaXMuX2RlbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2RlbCcpO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5fc2VsZi5yZW1vdmUoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpbml0KCkge1xyXG4gICAgICAgICAgICB0aGlzLl9kZWxldGUoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGxldCBwcm9kdWN0c0FyciA9IFtdO1xyXG4gICAgbGV0IHByb2R1Y3RzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJhc2tldC1wcm9kdWN0c19fcHJvZHVjdCcpO1xyXG5cclxuICAgIHByb2R1Y3RzLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xyXG4gICAgICAgIGxldCBwcm9kdWN0ID0gbmV3IGJhc2tldFByb2R1Y3QoaXRlbSwgJ2Jhc2tldC1wcm9kdWN0c19fcHJvZHVjdC1zaXplLW51bScsICdiYXNrZXQtcHJvZHVjdHNfX3Byb2R1Y3QtbnVtLWNoYW5nZS0tbWludXMnLCAnYmFza2V0LXByb2R1Y3RzX19wcm9kdWN0LW51bS1jaGFuZ2UtLXBsdXMnLCAnYmFza2V0LXByb2R1Y3RzX19wcm9kdWN0LXJlbW92ZScpO1xyXG4gICAgICAgIHByb2R1Y3RzQXJyLnB1c2goaXRlbSk7XHJcbiAgICAgICAgcHJvZHVjdC5pbml0KCk7XHJcbiAgICB9KVxyXG4gICAgd2luZG93LnByb2R1Y3RzQXJyID0gcHJvZHVjdHNBcnI7XHJcbiAgICAvL2xldCBwcm9kdWN0ID0gbmV3IGJhc2tldFByb2R1Y3QoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJhc2tldC1wcm9kdWN0c19fcHJvZHVjdCcpWzBdLCAnYmFza2V0LXByb2R1Y3RzX19wcm9kdWN0LXNpemUtbnVtJywgJ2Jhc2tldC1wcm9kdWN0c19fcHJvZHVjdC1udW0tY2hhbmdlLS1taW51cycsICdiYXNrZXQtcHJvZHVjdHNfX3Byb2R1Y3QtbnVtLWNoYW5nZS0tcGx1cycsICdiYXNrZXQtcHJvZHVjdHNfX3Byb2R1Y3QtcmVtb3ZlJyk7XHJcblxyXG59KSgpO1xyXG4iLCI7KGZ1bmN0aW9uKCkge1xyXG4gICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5zbGlkZS1pbmZvX19idXR0b24nLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAkKHRoaXMpLmNsb3Nlc3QoJy5zbGlkZS1pbmZvJykuZmluZCgnLnNsaWRlLWluZm9fX2J1dHRvbicpLnRvZ2dsZUNsYXNzKCdpcy1hY3RpdmUnKTtcclxuICAgICAgICAkKHRoaXMpLmNsb3Nlc3QoJy5zbGlkZS1pbmZvJykuZmluZCgnLnNsaWRlLWluZm9fX2NvbnRlbnQnKS5zbGlkZVRvZ2dsZSgzMDApO1xyXG4gICAgfSk7XHJcbn0pKCk7XHJcbiJdfQ==
